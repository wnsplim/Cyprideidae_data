library(scales)
library(ggplot2)
library(ggnewscale)

#Global
time_Global=c(-96.56873419499999, -97.28877058499998,-98.008806975,-98.72884336499999,-99.44887975500001,-100.168916145,-100.88895253499999,-101.608988925,-102.329025315,-103.04906170499999,-103.769098095,-104.489134485,-105.20917087499998,-105.929207265,-106.64924365499999,-107.36928004499998,-108.089316435,-108.80935282499999,-109.52938921499998,-110.249425605,-110.96946199499999,-111.68949838500001,-112.409534775,-113.12957116499999,-113.849607555,-114.569643945,-115.28968033499999,-116.009716725,-116.729753115,-117.44978950499998,-118.169825895,-118.88986228499999,-119.60989867499998,-120.329935065,-121.04997145499999,-121.77000784499998,-122.490044235,-123.21008062499999,-123.93011701500001,-124.650153405,-125.37018979499999,-126.090226185,-126.810262575,-127.53029896499999,-128.250335355,-128.970371745,-129.69040813499998,-130.410444525,-131.130480915,-131.85051730499998,-132.570553695,-133.290590085,-134.01062647499998,-134.730662865,-135.450699255,-136.17073564499998,-136.890772035,-137.610808425,-138.33084481499998,-139.050881205,-139.770917595,-140.49095398499998,-141.210990375,-141.93102676499998,-142.65106315499997,-143.371099545,-144.09113593499998,-144.811172325,-145.531208715,-146.251245105,-146.971281495,-147.691317885,-148.411354275,-149.131390665,-149.851427055,-150.571463445,-151.291499835,-152.011536225,-152.731572615,-153.451609005,-154.17164539499998,-154.891681785,-155.611718175,-156.33175456499998,-157.051790955,-157.771827345,-158.49186373499998,-159.211900125,-159.931936515,-160.65197290499998,-161.372009295,-162.092045685,-162.81208207499998,-163.532118465,-164.25215485500001,-164.97219124499998,-165.692227635,-166.412264025,-167.13230041499997,-167.852336805)
rate_Global=c(-0.36018766968191335, -0.3652190704193314,-0.3690540277871497,-0.3646074919592101,-0.34633244865116025,-0.3090009198921117,-0.2596220040654399,-0.19319910658863776,-0.1475813792954156,-0.11737871068203251,-0.10115932144832566,-0.09054603199418249,-0.08426234407077218,-0.08007052157617267,-0.07804790738741818,-0.07705451873033704,-0.07631419968108949,-0.07499689245791252,-0.0720511364807336,-0.06676939624015514,-0.06223371289745849,-0.060030188561501864,-0.05913154732327297,-0.0601657415072758,-0.05907535373692721,-0.05477271525044474,-0.04944723637758376,-0.05627437090389182,-0.0838161666646242,-0.10786700561450989,-0.11327318046591325,-0.10712043218264662,-0.10130376088646101,-0.10141201181721972,-0.11836403098377322,-0.11974781852190294,-0.06922331024299382,-0.026342983897313862,0.009725177089277757,0.018607204492842436,0.020567011817821605,0.021741402388166162,0.024785192627542054,0.025704734296548085,0.026348630253582517,0.027105732329386942,0.027488524689758046,0.026416236098725118,0.022927174969202456,0.014455060145860054,-0.006561411302468753,-0.028486609895095886,-0.03967643550353974,-0.04530232938514572,-0.044205671511717885,-0.0441444060044242,-0.045213674476458535,-0.04738457677826979,-0.05004166136848898,-0.05210605631661249,-0.05341226242118702,-0.05370926394456086,-0.04542256232594195,0.24605559323915516,0.43670284032210105,0.4381869881911607,0.44193462374179976,0.4427183514056066,0.441577500696898,0.43230386355367156,0.42720332624710017,0.413601614821823,0.36177485667233067,0.30847219055020014,0.26156206040155733,0.2280235240110198,0.20640585992139734,0.19320222540372758,0.18635595847834704,0.1827301335078733,0.1816364584596568,0.18164048832706364,0.18190554604590317,0.18273709559576357,0.18423169156421831,0.1864488271818321,0.19072796655221588,0.19842038955062177,0.2102131869036255,0.22530028592956203,0.23690462054354913,0.24573237327000638,0.24544739219699163,0.24404983005110448,0.24016862649262724,0.23578001163777682,0.22979129934371623,0.22297740996927404,0.21725169273144904,0.2117200447716268)
minHPD_Global=c(-1.529761036945971, -1.467907276590817,-1.4192907906401,-1.3578035640435109,-1.261978023184612,-1.1217296188833825,-0.9603266407900052,-0.7175659944607082,-0.5232761862196453,-0.37549889367126466,-0.27472030116784096,-0.24177937765884244,-0.2304104788651059,-0.22290659604510674,-0.21967924241781367,-0.21907654766065643,-0.21971278248012266,-0.22045204408805277,-0.22671223170891924,-0.24533964126892838,-0.2464574749156537,-0.24287649794808086,-0.245322064603587,-0.24793731449214462,-0.24967134512829273,-0.25288816660189567,-0.262495603695964,-0.27889231976973616,-0.3410675547845655,-0.38119856445550454,-0.39671266844489267,-0.3935020792531402,-0.3935020792531402,-0.39704821087020614,-0.43903494589869135,-0.44973486304871324,-0.33934404942206203,-0.2445877123702642,-0.11629529915987308,-0.09287563228160714,-0.09221212010348201,-0.08913967495249153,-0.08746857427935589,-0.08722388429054284,-0.0872562625491872,-0.08866968864576136,-0.08896928476017504,-0.08913967495249153,-0.0948690307284413,-0.1034826556075808,-0.13492807771530824,-0.15033206622951917,-0.15710633128587914,-0.15656540519159062,-0.15797110761488864,-0.15727117969446364,-0.1572644566919451,-0.15727117969446364,-0.16238587271932037,-0.16238587271932037,-0.1662466094161226,-0.1673588404845095,-0.18846637207306385,-0.1536672164058091,0.17598268844309317,0.181887867015524,0.18167599719071825,0.1806090170436545,0.1818182183869465,0.15798895189415363,0.12473551921353232,-0.004695668501222605,-0.18513850751687794,-0.22843348968018554,-0.2443256283579811,-0.25756742671908917,-0.2572940185474591,-0.2617278359892203,-0.2577613758694157,-0.26130939693794397,-0.2592110360605733,-0.26147330267402985,-0.2577613758694157,-0.26061182090024304,-0.2617278359892203,-0.26667305811653363,-0.26381886315352976,-0.2776644843532587,-0.2869557169361387,-0.31968129032764747,-0.357274254852166,-0.38862009119907454,-0.5015480551708971,-0.8007283807742842,-1.022189710420686,-1.0681471662375372,-1.2663239619911857,-1.4542106706193332,-1.6084293292462186,-1.7395112719853834)
maxHPD_Global=c(0.047314831853863204, 0.04286443959720512,0.03497004538725429,0.02789698451405928,0.02901651786357906,0.04303721518270126,0.045685111391718256,0.05176805956354093,0.05184876043271027,0.05061011598627487,0.05061011598627487,0.03953646668705307,0.03612225877661591,0.03603965241308959,0.03611033987736506,0.03592938724983623,0.036298752166827465,0.03951312553852483,0.04565467333512214,0.06186930976056563,0.11748440591660735,0.141933668495187,0.15437735731454727,0.16855353108924895,0.18479650922343716,0.1989940042604443,0.2076317811091009,0.22098050311762407,0.21979042393643908,0.19971834943429698,0.1524810216218306,0.1326877219583642,0.12488621394060018,0.12077697648860605,0.10535459895707261,0.10530989916908814,0.12933287144514738,0.153278590690493,0.16633268963213754,0.16229376402650958,0.15847745542962297,0.15994425088624079,0.1609112183452614,0.16176451601690223,0.1629602992308125,0.1638609088179308,0.16633641637343025,0.16786543987304364,0.16548247591712473,0.1663431222827287,0.14551997891216287,0.11258789012283363,0.07981810399458958,0.06343098098200511,0.05887657818368469,0.059383079834430585,0.05758771101601365,0.05538567201535516,0.04828209098106517,0.0467169871457323,0.04399339006904987,0.04607914983124484,0.056169937005957876,0.6197226592424296,0.7192616469365085,0.718941976280862,0.7171748913306466,0.7190464648692805,0.7309150875817777,0.7572953287281535,0.7671301016743015,0.7799860100382547,0.7104283814193075,0.6750574132524351,0.6440729364818638,0.6113478063866454,0.5958777042039447,0.5825958937261797,0.582507763196892,0.5777581592260883,0.5797584585367248,0.5777888153996651,0.5824876706218739,0.5824089110007631,0.5848351369938137,0.5854209368669199,0.6003880612390741,0.6096304523632798,0.6464570506265499,0.7114117379561644,0.9831278139661028,1.4186907293652822,1.7307172592742845,1.7782265096230783,1.8245949265876167,2.0129191074127757,2.0238385410951265,2.013598430312669,2.023583666102895,2.050843284470106)
#NAfEu
time_NAfEu=c(-111.67796214, -112.24618642000002,-112.8144107,-113.38263498,-113.95085926000002,-114.51908354,-115.08730782,-115.65553210000002,-116.22375638,-116.79198066000001,-117.36020493999999,-117.92842922,-118.49665350000001,-119.06487777999999,-119.63310206,-120.20132634000001,-120.76955061999999,-121.3377749,-121.90599918000001,-122.47422345999999,-123.04244774,-123.61067202000001,-124.17889629999999,-124.74712058,-125.31534486000001,-125.88356913999999,-126.45179342,-127.02001770000001,-127.58824197999999,-128.15646626,-128.72469054,-129.29291482000002,-129.8611391,-130.42936338,-130.99758766000002,-131.56581194,-132.13403622,-132.70226050000002,-133.27048478,-133.83870906,-134.40693334,-134.97515762,-135.5433819,-136.11160618,-136.67983046,-137.24805474000001,-137.81627902,-138.3845033,-138.95272758000002,-139.52095186,-140.08917614,-140.65740042000002,-141.2256247,-141.79384898,-142.36207326000002,-142.93029754,-143.49852182,-144.0667461,-144.63497038,-145.20319466,-145.77141894,-146.33964322,-146.9078675,-147.47609178,-148.04431606,-148.61254034,-149.18076462,-149.7489889,-150.31721318,-150.88543746,-151.45366174,-152.02188602,-152.5901103,-153.15833458,-153.72655886,-154.29478314,-154.86300742,-155.4312317,-155.99945598,-156.56768026,-157.13590454,-157.70412882,-158.2723531,-158.84057738,-159.40880166,-159.97702594,-160.54525022,-161.1134745,-161.68169878,-162.24992306000001,-162.81814734,-163.38637162,-163.95459590000002,-164.52282018,-165.09104446,-165.65926874000002,-166.22749302,-166.7957173,-167.36394158000002,-167.93216586)
rate_NAfEu=c(-0.2522112068939965, -0.24776573323883969,-0.24530306941322622,-0.24364728419852807,-0.24189988265329107,-0.2403639820313517,-0.23955236745699404,-0.23883198693213079,-0.2381048438379526,-0.2369864063399937,-0.23526718873919095,-0.23235348875379228,-0.22899268876487056,-0.2262172413415431,-0.2239464844380838,-0.222114936080241,-0.2206762869799622,-0.2171091702855102,-0.19274101511471595,-0.11652262583335263,-0.04667110608797754,0.005586892200663669,0.02137370502663398,0.027572994803025375,0.02953236888110217,0.031584939288009505,0.045219198034826734,0.05687920660523705,0.06444034151487775,0.0713531999575141,0.07575692674287583,0.07848174915458164,0.08017225273855494,0.08142117220526997,0.07990514697628558,0.07079000058904564,0.037789706723140665,-0.04979228743189875,-0.1087305366990741,-0.13374482201488666,-0.14806332621208354,-0.1268896101843977,-0.08839157435577143,-0.06841533463943582,-0.06541554024731107,-0.06943335650397646,-0.07921148852654863,-0.08673932816463055,-0.09117864567521983,-0.09229861170395776,-0.09008159062528137,-0.08522550540013632,-0.04904473412547284,0.21904432136383867,0.2700322063482009,0.27084553947663526,0.2861258768577763,0.2925983082695184,0.2955047255313413,0.2965917182883675,0.2954582883920394,0.29344744914463866,0.29308119842418723,0.29296079579025924,0.2709877545830749,0.24702300651402548,0.22361395565918585,0.20184960340948632,0.18563044266675244,0.17451320892620456,0.1669031657137227,0.16199352347581678,0.15870346535384333,0.15670563401371812,0.15574269484273223,0.15528938585432303,0.15517964451486455,0.15515481810957185,0.15550128535483881,0.1553912691859528,0.15600195574431963,0.15722022801658916,0.15886665729961993,0.16213728594772808,0.16840280771854899,0.17809024550542793,0.193529655421226,0.21534765356666127,0.24012454112246379,0.25223653970783294,0.2549779526374979,0.25183688322406417,0.24718538532088494,0.2427365735130577,0.23688867385718404,0.23088609601942467,0.22197655728801222,0.21623271147631368,0.2091755449788558,0.20219833878594323)
minHPD_NAfEu=c(-0.5977914295312671, -0.5796533146667031,-0.573250420311845,-0.5636240898516343,-0.5550448442711546,-0.5523343940873151,-0.5447118658674598,-0.5403048912295922,-0.5338727200433315,-0.5285956124688329,-0.5259389356202843,-0.5151876770047087,-0.5081781252049319,-0.5045260807691382,-0.5028170909528415,-0.4992415555239258,-0.49922335930695605,-0.5022645084195595,-0.4820046784573829,-0.35578351981485523,-0.27346523745180434,-0.20837090414015635,-0.17450473734100683,-0.15900835053951726,-0.15031738393222246,-0.1484390238272507,-0.1293254029819572,-0.11345940789054282,-0.10700765145436156,-0.10005663072535215,-0.09849920444146654,-0.09995976110233734,-0.1000468163935031,-0.10750003879960388,-0.11545315263248412,-0.15491678557073,-0.21534807257166322,-0.2907063371506848,-0.41750287846981643,-0.5197490030415408,-0.5574119902275634,-0.35299647379320115,-0.2730263179615814,-0.2645048973448851,-0.2599148525157369,-0.2672802476781636,-0.2734553638269037,-0.2766468894543297,-0.2866968871176516,-0.2866032914274308,-0.2908637357814179,-0.2895454263172371,-0.29086157506924715,-0.17698460218665527,-0.03762366788163718,-0.03706190171410301,-0.01721195191520608,-0.017072943476406255,-0.010781222032713034,-0.013053126461512077,-0.019124073284571497,-0.026063015912959175,-0.03375726213090208,-0.037685054675540675,-0.1078859108695698,-0.21283018583249416,-0.24062265814504882,-0.2698266425671636,-0.2632868824233201,-0.27729319609435993,-0.2774096174308204,-0.27762286763802596,-0.27762286763802596,-0.27743323771343537,-0.27741036646088535,-0.27762286763802596,-0.27762286763802596,-0.2777435899244903,-0.27771940314136634,-0.27771940314136634,-0.27775296752382367,-0.2847203375201949,-0.2927335279847775,-0.28912487453655017,-0.31140231709436816,-0.3155930823970996,-0.3444197643480846,-0.3993253025581814,-0.4304931819707757,-0.5603070133307998,-0.8193627199809512,-0.9504179160088115,-1.2123041932663718,-1.4331436738920313,-1.4665903982492001,-1.6240055148349248,-1.7310579085085895,-1.7431155871784911,-1.969061310710119,-1.9823090545147866)
maxHPD_NAfEu=c(0.034225754638995104, 0.029926529925914436,0.02270102792944917,0.02270102792944917,0.02270102792944917,0.01723156743733026,0.017027034114840134,0.015796095624740325,0.016325580028750758,0.015824048366560567,0.013798630367534342,0.017040596782251977,0.017307895083689906,0.01691123020090385,0.017307895083689906,0.022922292992836324,0.028155547520977764,0.035089495134758786,0.07646688022029122,0.13941749919411417,0.1678855628025065,0.18284313862205093,0.18697098516147612,0.18732988951793852,0.18808376002823377,0.18733046216412558,0.19682732332771546,0.20513875820852748,0.20835718616225246,0.2159332454772523,0.22069672919479658,0.22387098401156147,0.22976492425353778,0.23310666625372925,0.24385661534037958,0.2501031967565875,0.24749702589501013,0.22990624822635744,0.21221986082249084,0.17010387103240432,0.15143479251506942,0.20741696304074836,0.1608215172176772,0.1991134723071114,0.20871690165016954,0.19671635508146135,0.1783306160475677,0.16867028682877994,0.16114225632782664,0.17010863045227836,0.17988373470028818,0.1990694702468064,0.3057614782704679,0.5507432765561151,0.5764444185154679,0.5722649318277939,0.5971545449888745,0.6036496499928274,0.6149856569401518,0.6169917018840383,0.6170108536881334,0.6185332202698868,0.6185332202698868,0.6355404713717145,0.6581488736956667,0.6057121783315905,0.5866826777990294,0.5526450323223561,0.5497186637867377,0.5263896453530018,0.5191143410544898,0.5148804385610759,0.5128830774594142,0.5127275569880232,0.5127275569880232,0.513129835158084,0.5144830094387074,0.5171509563235461,0.5195658133547512,0.5227104113555042,0.5265517234223345,0.5275943764597675,0.5304937105664509,0.549746569627314,0.5555318201013801,0.6002705085645231,0.7030285835288744,1.0727962914911815,1.5892638129148227,1.9091684810602347,1.9903621475133348,2.165151878346392,2.165151878346392,2.1650264461108826,2.3068846656688877,2.3068846656688877,2.364486163553127,2.48928844981455,2.391180331778849,2.4665802298736628)
#WAfSAm
time_WAfSAm=c(-96.885121185, -97.36197555499999,-97.838829925,-98.31568429500001,-98.792538665,-99.26939303500001,-99.74624740499999,-100.223101775,-100.69995614499999,-101.176810515,-101.65366488500001,-102.130519255,-102.60737362500001,-103.08422799499999,-103.561082365,-104.03793673499999,-104.514791105,-104.99164547499998,-105.468499845,-105.94535421500001,-106.42220858499999,-106.899062955,-107.37591732499999,-107.852771695,-108.32962606499999,-108.806480435,-109.28333480500001,-109.760189175,-110.237043545,-110.71389791499999,-111.190752285,-111.66760665499999,-112.144461025,-112.62131539500001,-113.098169765,-113.575024135,-114.05187850499999,-114.528732875,-115.00558724499999,-115.482441615,-115.95929598500001,-116.436150355,-116.91300472500001,-117.38985909499999,-117.866713465,-118.34356783499999,-118.820422205,-119.29727657500001,-119.774130945,-120.25098531500001,-120.72783968499999,-121.204694055,-121.68154842499999,-122.158402795,-122.63525716500001,-123.112111535,-123.58896590500001,-124.065820275,-124.542674645,-125.01952901499999,-125.496383385,-125.97323775500001,-126.450092125,-126.92694649500001,-127.403800865,-127.880655235,-128.357509605,-128.834363975,-129.311218345,-129.788072715,-130.26492708499998,-130.741781455,-131.218635825,-131.695490195,-132.172344565,-132.649198935,-133.126053305,-133.602907675,-134.079762045,-134.55661641499998,-135.033470785,-135.510325155,-135.987179525,-136.464033895,-136.94088826499998,-137.417742635,-137.894597005,-138.371451375,-138.848305745,-139.325160115,-139.802014485,-140.278868855,-140.755723225,-141.23257759499998,-141.709431965,-142.186286335,-142.663140705,-143.139995075,-143.61684944499999)
rate_WAfSAm=c(-0.01668224339394541, -0.013182507142704806,-0.01619976357019419,-0.01981261810624561,-0.02355837421059627,-0.027708876675198824,-0.03206575494534598,-0.03609493487728172,-0.040302922681937234,-0.04434023418660885,-0.04843018152647014,-0.05245989188658486,-0.05659782957039668,-0.06090840523676087,-0.06539025994502098,-0.06995867502235148,-0.07402254384937548,-0.07807185401530234,-0.08186442593241701,-0.08585007778323728,-0.08943792241889945,-0.09334850032460233,-0.09723933875638559,-0.1011688105470199,-0.10470327414859087,-0.1082678137377526,-0.11235850616142606,-0.11578922415456394,-0.11905297354700271,-0.1219120314619835,-0.12454344955693677,-0.126871239155429,-0.12895697734470374,-0.13083381547360376,-0.13251136962957874,-0.13416330727751669,-0.1353750661711564,-0.13708124317319967,-0.13825641005445952,-0.13978643732840812,-0.14134255577189267,-0.1430886266919664,-0.14394805239728156,-0.14422285423618775,-0.14426938587970398,-0.143195910177964,-0.14151395804021913,-0.1402179997064344,-0.1393955052210618,-0.138986733589104,-0.13996932431123468,-0.14043576920102396,-0.13644339641830333,-0.13331531399803936,-0.12459212277467477,-0.11743568882107067,-0.10177542362148534,-0.1007398635642604,-0.09723331067179791,-0.07906017167837594,-0.05527213235064861,-0.03967511475752156,-0.02993993656786869,-0.024603232517391462,-0.02183622681328325,-0.020762627218605483,-0.019552197296630942,-0.018065451049099793,-0.015572819859176065,-0.01340378896668306,-0.012383182768979005,-0.011905898208913746,-0.011546934280205779,-0.011205103479151523,-0.010988108184744461,-0.010844615665567565,-0.010784785856281362,-0.010672655150156779,-0.0106081795193272,-0.01058039128056849,-0.010525579094138534,-0.010461522125042162,-0.010361678557570034,-0.01008104874365878,-0.009309798949902652,-0.008186513598308928,-0.007152726523473751,-0.006144688640021101,-0.005311974616822264,-0.004607523312028314,-0.004027954382238891,-0.003431590250892506,-0.0026791832276691287,-0.0015448417676853566,1.0601020389863233e-05,0.0020030924086252354,0.003880210417882795,0.007535428326202593,0.008557467041507102)
minHPD_WAfSAm=c(-0.7203256661319372, -0.7084460439682692,-0.7052025701153422,-0.7233396946898383,-0.7228882832905954,-0.7235840238068278,-0.7237179636875442,-0.743316711375618,-0.7345133205139818,-0.7477599166434115,-0.7567605582689487,-0.7477025641770381,-0.7454383083087519,-0.7455473689370196,-0.7483543180863259,-0.7465835105597584,-0.7438219033479806,-0.7701002262109884,-0.7698681876263613,-0.7555790431220328,-0.7471034312031801,-0.7556027100222868,-0.7455317697341659,-0.7452702868109295,-0.7401745229400571,-0.7554250698170735,-0.745499726319621,-0.734508809229004,-0.7237044360753392,-0.7235945925845912,-0.7233396946898383,-0.723200411154716,-0.7167219588149075,-0.7242318807280579,-0.7158151124099451,-0.720859821769783,-0.7167275484168262,-0.7126047277420287,-0.7083203282888518,-0.7257371763474463,-0.7324463935215497,-0.745499726319621,-0.7419811651660959,-0.7424996631163453,-0.7457366946769177,-0.7608502387736346,-0.745499726319621,-0.759963066893192,-0.7764004966367303,-0.7764004966367303,-0.8107439078394014,-0.8432952386786892,-0.8354366878516426,-0.8358320037579506,-0.8169237169152708,-0.8055771269630856,-0.7590809780264893,-0.7322978758768449,-0.6701424681444447,-0.6182555403971732,-0.5424398667244579,-0.476430847589647,-0.38431061157332624,-0.3077090559286586,-0.27944879164715364,-0.24966065327480086,-0.23943188034882945,-0.22327457785469917,-0.21060565752542346,-0.20678843051353646,-0.1986536845655275,-0.19285310319756938,-0.1903597871266688,-0.19030110979512788,-0.18886028110798658,-0.18896085293707432,-0.1887225265204467,-0.1887225265204467,-0.1886727800552345,-0.18456577155279055,-0.18484813530269806,-0.1822434227933546,-0.1822434227933546,-0.1813249903519304,-0.18118411395807726,-0.18081254570135297,-0.1804830928511993,-0.1804984595384973,-0.17897137563633575,-0.1780237586531513,-0.17927069799027134,-0.18048239008497158,-0.18069130973541409,-0.18199848088173026,-0.18081254570135297,-0.18956524753238352,-0.19051316600615287,-0.19032710880583387,-0.19335071203634793)
maxHPD_WAfSAm=c(0.6607095413221251, 0.6305611667548112,0.6367982976846887,0.6170369234301167,0.6169866617745404,0.6151304249355429,0.6136150479166851,0.5962375280056983,0.6008470982378615,0.5842675250043834,0.5703033222539426,0.5703033222539426,0.5673668137878971,0.560373174993737,0.5484744114171787,0.5444372019575328,0.5415975749882256,0.5097677058159967,0.49977807025999077,0.5033963097021881,0.49977807025999077,0.4789503263742012,0.4779962408884892,0.4684867232669086,0.46200349086822623,0.43639295775825715,0.43243615921393935,0.4329583540017938,0.4282766197943594,0.41596557065317374,0.4027531557281263,0.3897650432796112,0.38525906563337986,0.36504853731253806,0.36504853731253806,0.3523916703357597,0.3463476720156695,0.3449398392410574,0.3449398392410574,0.3259137424355244,0.31628727921506633,0.3048625476766036,0.310947263183612,0.31465746310632986,0.3190273097638873,0.31890202872316187,0.35067700583338723,0.35310442505008255,0.36166045101515787,0.39924592129820824,0.41071128136175755,0.43472395034109235,0.47217594444839905,0.46863121013436226,0.46920573495203033,0.4364682293629485,0.42979454540924916,0.35705457160871423,0.2975771110630839,0.2677129810995544,0.26821744901327393,0.26255283222708486,0.24962880783678731,0.23539269201393745,0.21189815968106207,0.2049889668883303,0.19192375193257094,0.18703402387981477,0.1806970464396321,0.17160862075656247,0.17160862075656247,0.17101492871398838,0.16930902332080378,0.16644343813002854,0.165655059459473,0.16373354779817983,0.16262064019389716,0.16149989914374063,0.1605789130789635,0.16457758814574408,0.16390344582089506,0.16607462358132952,0.16550268393474055,0.16584471240772225,0.16565561062820247,0.1657021138835692,0.16636193972637076,0.1666065346636641,0.16921177359609746,0.17141400422014083,0.17141400422014083,0.171512273447408,0.17353158359820478,0.17605053483019747,0.18303275832687077,0.18151293576218724,0.18877755214321318,0.20305937649196482,0.20315380381539597)


df_rate_Global <- data.frame(Time = time_Global,Rate = rate_Global,MinHPD = minHPD_Global,MaxHPD = maxHPD_Global)
df_rate_NAfEu <- data.frame(Time = time_NAfEu,Rate = rate_NAfEu,MinHPD = minHPD_NAfEu,MaxHPD = maxHPD_NAfEu)
df_rate_WAfSAm <- data.frame(Time = time_WAfSAm,Rate = rate_WAfSAm,MinHPD = minHPD_WAfSAm,MaxHPD = maxHPD_WAfSAm)

intervals <- data.frame(
  xmin = c(-Inf, -168.2, -165.3, -161.5, -154.8, -149.2, -145, -139.8, -132.6, -125.77, -121.4, -113, -100.5),
  xmax = c(-168.2, -165.3, -161.5, -154.8, -149.2, -145, -139.8, -132.6, -125.77, -121.4, -113, -100.5, Inf),
  fill = rep(c("grey97", "white"), length.out = 13)
)


p <- ggplot() +
  geom_rect(data = intervals, aes(xmin = xmin, xmax = xmax, ymin = -Inf, ymax = Inf, fill = fill),
            inherit.aes = FALSE, alpha = 1) +
  scale_fill_identity() +
  geom_ribbon(data = df_rate_NAfEu, aes(x = Time, ymin = MinHPD, ymax = MaxHPD),
              fill = alpha('red', 0.3), inherit.aes = FALSE) +
  geom_ribbon(data = df_rate_Global, aes(x = Time, ymin = MinHPD, ymax = MaxHPD),
              fill = alpha('blue', 0.3), inherit.aes = FALSE) +
  geom_ribbon(data = df_rate_WAfSAm, aes(x = Time, ymin = MinHPD, ymax = MaxHPD),
              fill = alpha('#1eb72a', 0.3), inherit.aes = FALSE) +
  geom_line(data = df_rate_NAfEu, aes(x = Time, y = Rate),
            color = 'red', linewidth = 1) +
  geom_line(data = df_rate_Global, aes(x = Time, y = Rate),
            color = 'blue', linewidth = 1) +
  geom_line(data = df_rate_WAfSAm, aes(x = Time, y = Rate),
            color = '#1eb72a', linewidth = 1) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  
  scale_x_continuous(
    name = "Time (Mya)",
    limits = c(-170, -95),
    breaks = seq(-160, -100, by = 10),
    labels = function(x) abs(x),
    expand = expansion(mult = c(0.01, 0.01))
  ) +
  
  scale_y_continuous(
    name = "Rate",
    breaks = seq(-1.5, 1, by = 0.5),
  ) +
  
  coord_cartesian(ylim = c(-1.5, 1)) +
  
  theme_minimal() +
  theme(
    panel.grid = element_blank(),
    axis.ticks = element_line(),
    axis.title.y.right = element_text(margin = margin(l = 10)),
    axis.title.y.left = element_text(margin = margin(r = 10)),
    axis.line = element_line()
  )

print(p)

ggsave(
  filename = "Divrate_unstd.tiff",
  plot = p,
  width = 2048,
  height = 960,
  dpi = 300,
  units = "px",
  device = "tiff",
  compression = "lzw"
)

