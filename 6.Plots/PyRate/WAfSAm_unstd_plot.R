library(scales)
library(ggplot2)
library(ggnewscale)

# WAfSAm_unstd
time_sp=c(-96.885121185, -97.36197555499999,-97.838829925,-98.31568429500001,-98.792538665,-99.26939303500001,-99.74624740499999,-100.223101775,-100.69995614499999,-101.176810515,-101.65366488500001,-102.130519255,-102.60737362500001,-103.08422799499999,-103.561082365,-104.03793673499999,-104.514791105,-104.99164547499998,-105.468499845,-105.94535421500001,-106.42220858499999,-106.899062955,-107.37591732499999,-107.852771695,-108.32962606499999,-108.806480435,-109.28333480500001,-109.760189175,-110.237043545,-110.71389791499999,-111.190752285,-111.66760665499999,-112.144461025,-112.62131539500001,-113.098169765,-113.575024135,-114.05187850499999,-114.528732875,-115.00558724499999,-115.482441615,-115.95929598500001,-116.436150355,-116.91300472500001,-117.38985909499999,-117.866713465,-118.34356783499999,-118.820422205,-119.29727657500001,-119.774130945,-120.25098531500001,-120.72783968499999,-121.204694055,-121.68154842499999,-122.158402795,-122.63525716500001,-123.112111535,-123.58896590500001,-124.065820275,-124.542674645,-125.01952901499999,-125.496383385,-125.97323775500001,-126.450092125,-126.92694649500001,-127.403800865,-127.880655235,-128.357509605,-128.834363975,-129.311218345,-129.788072715,-130.26492708499998,-130.741781455,-131.218635825,-131.695490195,-132.172344565,-132.649198935,-133.126053305,-133.602907675,-134.079762045,-134.55661641499998,-135.033470785,-135.510325155,-135.987179525,-136.464033895,-136.94088826499998,-137.417742635,-137.894597005,-138.371451375,-138.848305745,-139.325160115,-139.802014485,-140.278868855,-140.755723225,-141.23257759499998,-141.709431965,-142.186286335,-142.663140705,-143.139995075,-143.61684944499999)
rate_sp=c(0.3908800950768938, 0.3911121748510523,0.391182485704665,0.3912232253715171,0.39128920786148236,0.39129419122703446,0.39125654637332596,0.39125322192100287,0.3912573152236978,0.3911971840809203,0.3911997513894483,0.3911668525030954,0.3911061048585157,0.3910631723966541,0.3909716115847102,0.39094375089145206,0.3909167181224408,0.3908536430296918,0.3907844789204683,0.39077078066223947,0.3907434807664041,0.3906349373291943,0.3905802170664665,0.39056440629969014,0.39054804551596334,0.3904939905047644,0.39040623320121937,0.3904136123774954,0.3904096594560775,0.3903925995840884,0.3903338191304974,0.39035011426559757,0.3904089622234542,0.39050453735529234,0.3905842772467577,0.3906884882876934,0.3908737896075869,0.39108403489699617,0.3913419803461803,0.3916594900208332,0.3921479381876364,0.39278832344414977,0.39365657327241466,0.3944807054769708,0.39532598614882164,0.39637130951011595,0.39746966549055107,0.3983781946365337,0.3993153381571964,0.4003154058886177,0.4014124929929692,0.4023463205382455,0.4032168384072389,0.4032148535573702,0.40300143101247865,0.401615852973802,0.3997396235323776,0.3944667670247687,0.38886784358069454,0.385928094378624,0.3844526652442286,0.3826304621721005,0.3799388042368396,0.37750204995620806,0.3760048533608418,0.3746726432217178,0.37380326802565556,0.37308200318438856,0.3724882467284097,0.3720270240891613,0.37154105855825126,0.37111811941098494,0.370775829664773,0.37045549177003445,0.3702071366769044,0.36998216906154247,0.36972698506962054,0.36952299312721526,0.3693843792734499,0.36923243618553403,0.369130430897589,0.369050550393326,0.36896842770863336,0.3689090275748418,0.3688609881410056,0.3688363951998858,0.3688334522875282,0.3688444770865801,0.36886314227051437,0.3689241908064899,0.36895517580089987,0.3690162744853602,0.3691066039139738,0.36926366513316367,0.3695855575793796,0.36996089313271724,0.37031392271001395,0.370739155250275,0.370841733605656)
minHPD_sp=c(0.019185515390497586, 0.02266817389238925,0.02368000012957247,0.02266817389238925,0.02387564187592622,0.025243074271647632,0.029530938748802405,0.024044853870660708,0.019213503365190992,0.02387564187592622,0.027783059249665388,0.03172436870920071,0.02266817389238925,0.025210431983968218,0.03247667880331032,0.03773513411855179,0.036467677526788055,0.027783059249665388,0.03253143679993613,0.03797762272894981,0.027783059249665388,0.02782949655395011,0.035671028134777384,0.035671028134777384,0.03896088324213897,0.03830439411310712,0.03744938318147376,0.03908562025639159,0.042362759593038646,0.047311137281404465,0.048829174858614786,0.05113455484117834,0.05730659965573444,0.05894583145137896,0.05751513041964812,0.0641305308025321,0.0641199024128385,0.0641199024128385,0.06932114525066506,0.06872247809593837,0.08634730881034419,0.09191613676243428,0.105951798073283,0.13132599335948597,0.16461782233647404,0.18427740393903103,0.22474214898033568,0.23483413227120323,0.23485799110289865,0.23378281912367604,0.24106129618033745,0.24115800899905412,0.24106129618033745,0.24438439106101825,0.24420434336593372,0.24037204605194284,0.24106129618033745,0.2349547094843897,0.22923324443382376,0.22501849874927715,0.2223192467144689,0.21835610949600026,0.21835610949600026,0.22306394546790811,0.222697151760219,0.22908482131287142,0.22885979271726514,0.22837040389261437,0.22857237426960728,0.22865556690205097,0.2309521377896706,0.23279380713062983,0.23271732313127705,0.23481937308681322,0.2348157486061725,0.23481588785793103,0.232811301187368,0.23278035057987365,0.22866925296711163,0.22868265100153057,0.2286208526033028,0.22866925296711163,0.2294216488499762,0.2294525532049455,0.22866925296711163,0.22868265100153057,0.22875459740730603,0.22885979271726514,0.22868265100153057,0.22868265100153057,0.22863580455770155,0.2291813571614614,0.22868265100153057,0.22863580455770155,0.22604195559650772,0.22306178953154415,0.21668536063617114,0.21466886660030549,0.2125407626615173)
maxHPD_sp=c(0.8753710187326974, 0.864169354478087,0.8625065170018665,0.8576282656744791,0.8556301579283252,0.8528162433119464,0.8526307182739412,0.8437643604359474,0.8346671492312198,0.8346671492312198,0.8346671492312198,0.8346671492312198,0.82042120947897,0.8187045928241301,0.8202674325368852,0.8204315757656833,0.815519347083431,0.80300062936799,0.80300062936799,0.8031778712759202,0.788781445173639,0.7834070152038268,0.7864793613567882,0.7819407355678313,0.7807619945006725,0.7764138697943079,0.7699945012720191,0.7674231339633463,0.7673095846143617,0.7681398760834687,0.7666661457515473,0.7658148545044875,0.7685095927133861,0.7674231339633463,0.7636088994425357,0.7680490560468811,0.7658266085907168,0.7634280803780098,0.7668039976469496,0.7648142430395476,0.782775845606548,0.7877334572411961,0.8000552834076008,0.8187045928241301,0.8474610406727784,0.8580731357737447,0.8903566786739769,0.8903566786739769,0.8854200407843382,0.88224519103302,0.8903566786739769,0.8974934997863373,0.9054874960772478,0.9099750493952012,0.9093570464877401,0.8838795218080857,0.8622204412521337,0.7773831183564978,0.6851292947257884,0.6413118066962726,0.6215295307615606,0.5948970899736878,0.5583494125807764,0.5392990028099257,0.5264250857812124,0.5229422917698872,0.5166151845005283,0.5124459547196688,0.5094853378412348,0.5075456698056726,0.5079374799232332,0.5083452105337071,0.5070088287413771,0.5083452105337071,0.5076330224870303,0.5073499593205941,0.5050776707953,0.5048378791573241,0.5004007097007194,0.5003602172585665,0.5001566675353656,0.5001566675353656,0.5007882064517155,0.5007937450824291,0.5002572087806038,0.5003602172585665,0.5007805789925239,0.5012780389855276,0.5012837458919485,0.5019474170922016,0.5027577269570271,0.5041124591812259,0.504760465664759,0.5064914281305786,0.5076330224870303,0.509343498011121,0.5084431338035893,0.5149786879774008,0.5146546442629668)

mids_sp=c(-96.8858521111111, -97.36416833333332,-97.84248455555556,-98.32080077777778,-98.799117,-99.27743322222221,-99.75574944444445,-100.23406566666667,-100.71238188888888,-101.1906981111111,-101.66901433333334,-102.14733055555556,-102.62564677777777,-103.103963,-103.58227922222223,-104.06059544444444,-104.53891166666666,-105.01722788888888,-105.49554411111112,-105.97386033333333,-106.45217655555555,-106.93049277777777,-107.408809,-107.88712522222222,-108.36544144444444,-108.84375766666666,-109.32207388888888,-109.80039011111111,-110.27870633333333,-110.75702255555555,-111.23533877777778,-111.713655,-112.19197122222222,-112.67028744444444,-113.14860366666666,-113.62691988888889,-114.10523611111111,-114.58355233333333,-115.06186855555556,-115.54018477777778,-116.018501,-116.49681722222222,-116.97513344444444,-117.45344966666667,-117.93176588888889,-118.41008211111111,-118.88839833333334,-119.36671455555556,-119.84503077777778,-120.323347,-120.80166322222222,-121.27997944444444,-121.75829566666667,-122.23661188888889,-122.7149281111111,-123.19324433333334,-123.67156055555556,-124.14987677777778,-124.628193,-125.10650922222221,-125.58482544444445,-126.06314166666667,-126.54145788888889,-127.01977411111112,-127.49809033333334,-127.97640655555556,-128.45472277777776,-128.933039,-129.4113552222222,-129.88967144444445,-130.36798766666664,-130.84630388888888,-131.32462011111113,-131.80293633333332,-132.28125255555557,-132.75956877777776,-133.237885,-133.7162012222222,-134.19451744444444,-134.6728336666667,-135.15114988888888,-135.62946611111113,-136.10778233333332,-136.58609855555557,-137.06441477777776,-137.542731,-138.0210472222222,-138.49936344444444,-138.9776796666667,-139.45599588888888,-139.93431211111113,-140.41262833333332,-140.89094455555556,-141.36926077777775,-141.847577,-142.3258932222222,-142.80420944444444,-143.2825256666667,-143.76084188888888)
counts_sp=c(0.01512, 0.0052,0.00506,0.00484,0.00476,0.00535,0.00503,0.00435,0.00487,0.00436,0.0048,0.00478,0.00475,0.00471,0.00479,0.00469,0.00429,0.00466,0.00452,0.00477,0.0049,0.00477,0.00488,0.00451,0.00445,0.00466,0.00485,0.00455,0.00441,0.00411,0.00444,0.0041,0.00429,0.00428,0.00449,0.00449,0.0047,0.00491,0.00499,0.00558,0.0072,0.00819,0.00779,0.00796,0.00894,0.0088,0.00805,0.00764,0.00875,0.00798,0.00898,0.00655,0.00314,0.00458,0.01007,0.01259,0.03669,0.03263,0.0167,0.01024,0.01417,0.01882,0.01601,0.01113,0.00962,0.0069,0.00611,0.00469,0.00434,0.00439,0.0039,0.00333,0.00298,0.00299,0.00266,0.00249,0.00232,0.00192,0.00223,0.0017,0.00193,0.00184,0.0017,0.00169,0.0019,0.0019,0.00209,0.00208,0.0021,0.00203,0.00202,0.00263,0.00359,0.00447,0.00488,0.00537,0.00646,0.0,0.0)

time_ex=c(-96.885121185, -97.36197555499999,-97.838829925,-98.31568429500001,-98.792538665,-99.26939303500001,-99.74624740499999,-100.223101775,-100.69995614499999,-101.176810515,-101.65366488500001,-102.130519255,-102.60737362500001,-103.08422799499999,-103.561082365,-104.03793673499999,-104.514791105,-104.99164547499998,-105.468499845,-105.94535421500001,-106.42220858499999,-106.899062955,-107.37591732499999,-107.852771695,-108.32962606499999,-108.806480435,-109.28333480500001,-109.760189175,-110.237043545,-110.71389791499999,-111.190752285,-111.66760665499999,-112.144461025,-112.62131539500001,-113.098169765,-113.575024135,-114.05187850499999,-114.528732875,-115.00558724499999,-115.482441615,-115.95929598500001,-116.436150355,-116.91300472500001,-117.38985909499999,-117.866713465,-118.34356783499999,-118.820422205,-119.29727657500001,-119.774130945,-120.25098531500001,-120.72783968499999,-121.204694055,-121.68154842499999,-122.158402795,-122.63525716500001,-123.112111535,-123.58896590500001,-124.065820275,-124.542674645,-125.01952901499999,-125.496383385,-125.97323775500001,-126.450092125,-126.92694649500001,-127.403800865,-127.880655235,-128.357509605,-128.834363975,-129.311218345,-129.788072715,-130.26492708499998,-130.741781455,-131.218635825,-131.695490195,-132.172344565,-132.649198935,-133.126053305,-133.602907675,-134.079762045,-134.55661641499998,-135.033470785,-135.510325155,-135.987179525,-136.464033895,-136.94088826499998,-137.417742635,-137.894597005,-138.371451375,-138.848305745,-139.325160115,-139.802014485,-140.278868855,-140.755723225,-141.23257759499998,-141.709431965,-142.186286335,-142.663140705,-143.139995075,-143.61684944499999)
rate_ex=c(0.424091790150595, 0.4250146469347921,0.42626836167565707,0.42755823574701535,0.42914689251233273,0.43066597776850213,0.4322474330207484,0.4336770297383423,0.43524821874245234,0.4365782063519347,0.4380551688144285,0.4394217828901118,0.44093198101541703,0.4424138903882189,0.44388080330667196,0.4454838711160036,0.4468184202687564,0.44815830818830515,0.449546649977162,0.4511639832475503,0.45256298648231885,0.45375688705765893,0.45511241127473107,0.4564911230617258,0.45785454753648536,0.45925249053067907,0.46065457688066574,0.4620546635010269,0.46342163435887984,0.4647152198955583,0.465956675801812,0.46704060447248974,0.46798568669158036,0.46920650680925324,0.4701887465097152,0.4709658037613271,0.4718787769040569,0.47299827039080455,0.4739589990942764,0.4753155408956063,0.477030943162237,0.4790280167014109,0.48090171822848987,0.4824645015922936,0.4841418034485027,0.4855874055752659,0.4868208030219475,0.4879615450744893,0.4895195426188872,0.49132881382289917,0.4934670412903036,0.49501604643071945,0.49465106792614233,0.4928085108083933,0.4868956496764524,0.4782123575269319,0.4652399546162135,0.4533980977182305,0.4418720175927002,0.42974329043741344,0.41796452827892006,0.40888682175625907,0.4012860463409271,0.39608324579396836,0.3928214675436412,0.3905923490706335,0.3887730308428625,0.3870012220422777,0.38503629299245523,0.38333953307406154,0.38225527584697727,0.3814373862947661,0.3808283899536796,0.3802146889689436,0.37973220938823427,0.37937964759407555,0.3789702051010727,0.378685847166238,0.37847793930803575,0.37830735074202515,0.3781508692331331,0.37797206270739986,0.37776200984887887,0.37745478676316524,0.3767566846695157,0.3758962844776481,0.37513800454676016,0.37446654968216586,0.37382654705116614,0.3734438691241035,0.3731044443591446,0.3728247680648133,0.3725211470011917,0.3721352472044571,0.37184915871437374,0.3716652536197489,0.3715411369616738,0.3714483648083964,0.3714339529775642)
minHPD_ex=c(5.261881954978989e-05, 5.4584822089897795e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,7.897943269357154e-05,0.0002228827333904219,0.0004250588074198745,0.00025783089169040426,5.261881954978989e-05,9.244846903964819e-05,5.261881954978989e-05,0.004632211495716359,0.007651275157369438,0.007368664876268662,0.00747768845667271,0.009119093635089245,0.016818919818507392,0.03794702474340433,0.04821140493667999,0.07044411778800358,0.07549880465443654,0.08557389764124433,0.09718749092180175,0.1275011362524536,0.14682514118827605,0.15637456748891604,0.16089937811868232,0.1782210370617212,0.18959560741206832,0.2401269878194799,0.2554237516186691,0.2708297259452424,0.2728869518065365,0.27174063266312565,0.2732900434213316,0.27702665532365056,0.27942380083996515,0.2787941242837737,0.2816356543939928,0.2805697751002304,0.28984908451079067,0.2889685951507655,0.28876620728209773,0.2905050030715015,0.2855940436052301,0.27632238272697,0.26551784785475124,0.2497680876500239,0.24654123929350544,0.2352295134316032,0.2260345757758753,0.21911275283228476,0.21351507520987095,0.21687618943489298,0.21351507520987095,0.21890966294193773,0.21898739701648007,0.22198976395815675,0.22187862466699884,0.22705613950608028,0.22585436596223252,0.22594214056189593,0.2259716003241277,0.22594214056189593,0.22704898958559805,0.22886103168509087,0.22886103168509087,0.22886103168509087,0.2292091178467516,0.22909009820239037,0.22913180984286727,0.22900905573464034,0.22909009820239037,0.22900905573464034,0.22887768351036192,0.22595839445403018,0.22391971673100208,0.22276187153187604,0.22151552004467806,0.2217011659286832,0.21972918145911627,0.21890966294193773,0.2190365616846607,0.21906701295866501,0.21861890381839805,0.2169424757407039,0.2169696165100358,0.21364792987281056,0.21351507520987095)
maxHPD_ex=c(0.9358258840013385, 0.9198413752238968,0.9243997290185069,0.9287807589137875,0.9326922283104652,0.9380835017767327,0.9426211386263184,0.9472698485095307,0.9518260458194948,0.956242562874126,0.9610163332552004,0.963945834501119,0.9676804865532371,0.9706154630570952,0.9743179960655488,0.9780904966955627,0.9821693620212892,0.9843628214396628,0.987931260628721,0.9901128137563886,0.9921554990511641,0.9984331581436845,1.0028052461989208,1.0042237791726671,1.0046186215360684,1.0073503023096226,1.0155466808024591,1.033082219326179,1.0390676634961584,1.0552920737267215,1.0527524035664606,1.0555712231824,1.0594008065301812,1.079432729287102,1.0903264322333974,1.090412267390885,1.0842844964257525,1.0907022828675175,1.0903264322333974,1.1272017508120817,1.1241164651536706,1.1221189724091347,1.1103386683079628,1.0970332103605045,1.0907022828675175,1.0907022828675175,1.0907022828675175,1.0903264322333974,1.0957732486157437,1.1031021977184574,1.1237341669335157,1.1337477958317423,1.1368683553185963,1.13563307582888,1.1194813414467741,1.093150858043339,1.052067439542628,1.005632832454395,0.9626727890591124,0.8992306043135653,0.8209828137593965,0.7532900363384888,0.6826412974507234,0.6326842245917349,0.5986547625181297,0.5836046753042625,0.5703302998952309,0.5609948593603574,0.548201178027463,0.5440752750400061,0.5369472498236708,0.5333918541728953,0.5303719920907277,0.5279377458623539,0.5274896322832601,0.5280091342000004,0.5267960597722836,0.5257401597444467,0.5253949646102288,0.5248260169920932,0.5244430298526929,0.5239640923360623,0.5238399501266326,0.523422559187433,0.5233729294468314,0.5211782901964175,0.5201185943083095,0.5201815679807782,0.5200757699265838,0.5212845931849347,0.5199852657951965,0.5200310503076474,0.5215545228112558,0.5233438495881646,0.5244325068029759,0.5241523579692001,0.5260427019196173,0.5254751408239628,0.5260336289072255)

mids_ex=c(-96.8858521111111, -97.36416833333332,-97.84248455555556,-98.32080077777778,-98.799117,-99.27743322222221,-99.75574944444445,-100.23406566666667,-100.71238188888888,-101.1906981111111,-101.66901433333334,-102.14733055555556,-102.62564677777777,-103.103963,-103.58227922222223,-104.06059544444444,-104.53891166666666,-105.01722788888888,-105.49554411111112,-105.97386033333333,-106.45217655555555,-106.93049277777777,-107.408809,-107.88712522222222,-108.36544144444444,-108.84375766666666,-109.32207388888888,-109.80039011111111,-110.27870633333333,-110.75702255555555,-111.23533877777778,-111.713655,-112.19197122222222,-112.67028744444444,-113.14860366666666,-113.62691988888889,-114.10523611111111,-114.58355233333333,-115.06186855555556,-115.54018477777778,-116.018501,-116.49681722222222,-116.97513344444444,-117.45344966666667,-117.93176588888889,-118.41008211111111,-118.88839833333334,-119.36671455555556,-119.84503077777778,-120.323347,-120.80166322222222,-121.27997944444444,-121.75829566666667,-122.23661188888889,-122.7149281111111,-123.19324433333334,-123.67156055555556,-124.14987677777778,-124.628193,-125.10650922222221,-125.58482544444445,-126.06314166666667,-126.54145788888889,-127.01977411111112,-127.49809033333334,-127.97640655555556,-128.45472277777776,-128.933039,-129.4113552222222,-129.88967144444445,-130.36798766666664,-130.84630388888888,-131.32462011111113,-131.80293633333332,-132.28125255555557,-132.75956877777776,-133.237885,-133.7162012222222,-134.19451744444444,-134.6728336666667,-135.15114988888888,-135.62946611111113,-136.10778233333332,-136.58609855555557,-137.06441477777776,-137.542731,-138.0210472222222,-138.49936344444444,-138.9776796666667,-139.45599588888888,-139.93431211111113,-140.41262833333332,-140.89094455555556,-141.36926077777775,-141.847577,-142.3258932222222,-142.80420944444444,-143.2825256666667,-143.76084188888888)
counts_ex=c(0.01753, 0.00736,0.00743,0.00804,0.00827,0.00817,0.00767,0.00872,0.00835,0.00857,0.0085,0.00854,0.00852,0.00854,0.0086,0.00824,0.00827,0.00804,0.00885,0.00856,0.00854,0.00849,0.00856,0.00876,0.00834,0.00843,0.00847,0.00857,0.00798,0.00771,0.00728,0.0068,0.00705,0.00656,0.00619,0.00653,0.0066,0.00679,0.00673,0.00754,0.00812,0.00769,0.00697,0.00684,0.00651,0.00586,0.00609,0.00682,0.00727,0.00834,0.00748,0.00554,0.00775,0.01581,0.02456,0.03872,0.03893,0.04473,0.05082,0.05276,0.04263,0.03707,0.02512,0.01681,0.01217,0.01093,0.01034,0.01136,0.00968,0.00669,0.00514,0.00456,0.0041,0.00359,0.00324,0.00335,0.00293,0.00236,0.00227,0.00262,0.00218,0.00243,0.00341,0.00462,0.0052,0.00549,0.00444,0.00409,0.00316,0.00286,0.0029,0.00308,0.00328,0.00264,0.00242,0.00324,0.00306,0.0,0.0)


df_freq_sp <- data.frame(Time = mids_sp, Frequency = counts_sp)
df_rate_sp <- data.frame(Time = time_sp,Rate = rate_sp,MinHPD = minHPD_sp,MaxHPD = maxHPD_sp)

df_freq_ex <- data.frame(Time = mids_ex, Frequency = counts_ex)
df_rate_ex<- data.frame(Time = time_ex,Rate = rate_ex,MinHPD = minHPD_ex,MaxHPD = maxHPD_ex)

rate_max_fixed <- max(max(maxHPD_sp),max(maxHPD_ex))
freq_max <- max(max(df_freq_sp$Frequency),max(df_freq_ex$Frequency))
scaling_factor <- rate_max_fixed / freq_max

df_freq_sp$Frequency_scaled <- df_freq_sp$Frequency * scaling_factor
df_freq_ex$Frequency_scaled <- df_freq_ex$Frequency * scaling_factor

bf2 = 0.03282882199853104 * scaling_factor
bf6 = 0.2005166131962391 * scaling_factor

intervals <- data.frame(
  xmin = c(-Inf, -139.8, -132.6, -125.77, -121.4, -113, -100.5),
  xmax = c(-139.8, -132.6, -125.77, -121.4, -113, -100.5, Inf),
  fill = rep(c("grey97", "white"), length.out = 7)
)


p <- ggplot() +
  geom_rect(data = intervals, aes(xmin = xmin, xmax = xmax, ymin = -Inf, ymax = Inf, fill = fill),
            inherit.aes = FALSE, alpha = 1) +
  scale_fill_identity() +
  geom_linerange(data = df_freq_ex, aes(x = Time, ymin = 0, ymax = Frequency_scaled),
                 color = '#E2968B', linewidth = 1.5) +
  geom_linerange(data = df_freq_sp, aes(x = Time, ymin = 0, ymax = Frequency_scaled),
                 color = '#a6a6e5', linewidth = 1.5) +
  geom_ribbon(data = df_rate_ex, aes(x = Time, ymin = MinHPD, ymax = MaxHPD),
                fill = alpha('red', 0.3), inherit.aes = FALSE) +
  geom_ribbon(data = df_rate_sp, aes(x = Time, ymin = MinHPD, ymax = MaxHPD),
              fill = alpha('blue', 0.3), inherit.aes = FALSE) +
  geom_line(data = df_rate_ex, aes(x = Time, y = Rate),
            color = 'red', linewidth = 1) +
  geom_line(data = df_rate_sp, aes(x = Time, y = Rate),
            color = 'blue', linewidth = 1) +
  geom_hline(yintercept = bf2, linetype = "dashed") +
  geom_hline(yintercept = bf6, linetype = "dashed") +
  
  scale_x_continuous(
    name = "Time (Mya)",
    limits = c(-145, -95),
    breaks = seq(-140, -100, by = 10),
    labels = function(x) abs(x),
    expand = expansion(mult = c(0.01, 0.01))
  ) +
  
  scale_y_continuous(
    name = "Rate",
    limits = c(0, rate_max_fixed),
    breaks = seq(0, rate_max_fixed, by = 0.5),
    sec.axis = sec_axis(
      trans = ~ . / scaling_factor,
      name = "Frequency",
      breaks = seq(0, 0.5, by = 0.1)
    )
  ) +
  
  theme_minimal() +
  theme(
    panel.grid = element_blank(),
    axis.ticks = element_line(),
    axis.title.y.right = element_text(margin = margin(l = 10)),
    axis.title.y.left = element_text(margin = margin(r = 10)),
    axis.line = element_line()
  )

print(p)

ggsave(
  filename = "WAfSAm_unstd.tiff",
  plot = p,
  width = 2048,
  height = 720,
  dpi = 300,
  units = "px",
  device = "tiff",
  compression = "lzw"
)

