

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-96.56873419499999, -97.28877058499998,-98.008806975,-98.72884336499999,-99.44887975500001,-100.168916145,-100.88895253499999,-101.608988925,-102.329025315,-103.04906170499999,-103.769098095,-104.489134485,-105.20917087499998,-105.929207265,-106.64924365499999,-107.36928004499998,-108.089316435,-108.80935282499999,-109.52938921499998,-110.249425605,-110.96946199499999,-111.68949838500001,-112.409534775,-113.12957116499999,-113.849607555,-114.569643945,-115.28968033499999,-116.009716725,-116.729753115,-117.44978950499998,-118.169825895,-118.88986228499999,-119.60989867499998,-120.329935065,-121.04997145499999,-121.77000784499998,-122.490044235,-123.21008062499999,-123.93011701500001,-124.650153405,-125.37018979499999,-126.090226185,-126.810262575,-127.53029896499999,-128.250335355,-128.970371745,-129.69040813499998,-130.410444525,-131.130480915,-131.85051730499998,-132.570553695,-133.290590085,-134.01062647499998,-134.730662865,-135.450699255,-136.17073564499998,-136.890772035,-137.610808425,-138.33084481499998,-139.050881205,-139.770917595,-140.49095398499998,-141.210990375,-141.93102676499998,-142.65106315499997,-143.371099545,-144.09113593499998,-144.811172325,-145.531208715,-146.251245105,-146.971281495,-147.691317885,-148.411354275,-149.131390665,-149.851427055,-150.571463445,-151.291499835,-152.011536225,-152.731572615,-153.451609005,-154.17164539499998,-154.891681785,-155.611718175,-156.33175456499998,-157.051790955,-157.771827345,-158.49186373499998,-159.211900125,-159.931936515,-160.65197290499998,-161.372009295,-162.092045685,-162.81208207499998,-163.532118465,-164.25215485500001,-164.97219124499998,-165.692227635,-166.412264025,-167.13230041499997,-167.852336805)
rate=c(0.05310572558180865, 0.05283233155959251,0.05251668138325584,0.05226591444133638,0.0520144359936366,0.05188449255445246,0.05180885007191144,0.05176869168617691,0.05175399888084205,0.051743185952859976,0.05173630350060856,0.051733836766990615,0.05174760536575504,0.05176254946251454,0.05178572896985516,0.05183993949765928,0.051961275675473435,0.05230427806061892,0.05304683826156664,0.054495723198443674,0.05588369936301049,0.05675068049063377,0.05757521773343238,0.05880048763007549,0.061315018942838466,0.06574431369090236,0.07423337410831976,0.0930288962864132,0.23149001271231445,0.24680670293655696,0.2536340444723535,0.25724528176529754,0.2594546761696356,0.2609464733443515,0.262147281973156,0.26300032066738055,0.2630761715615935,0.26313087611563146,0.26314570686236505,0.2631035922275887,0.26305657605733984,0.2630229342678107,0.26297338296717476,0.26294280819089705,0.2629328716810019,0.26292759523090914,0.26292312821017116,0.2629328716810019,0.26293333581812145,0.2629374862625589,0.2629370944259928,0.26293087571069385,0.2629216812083906,0.2629198582083197,0.26293797710725325,0.2630137126521119,0.2630432364562026,0.26302937306730356,0.2630240046634583,0.2630229342678107,0.26305219634140076,0.26306485756135567,0.263702303981356,0.6404697791330497,0.7474895716494969,0.7480417856230372,0.7495974882686429,0.7497831764401484,0.7487401705708427,0.7439125126262911,0.7414534583005292,0.7347630528781982,0.7105890188012844,0.683208898083172,0.6548264862109413,0.6272793767148224,0.6037537793374071,0.5846325456474979,0.5702748519418959,0.5605404188109577,0.5543400114206061,0.5511536755326112,0.5494600243482649,0.5485944147455676,0.5486706921824571,0.5498352855356918,0.5536873859467153,0.5605435782005714,0.5697768604035602,0.5799086550155406,0.5885256891403654,0.5963664411962539,0.6010979451242058,0.6053149747187243,0.6083463175772342,0.6112681687250967,0.6136875030393734,0.6160640553239556,0.6187005216065199,0.6210199140503447)
minHPD=c(0.0035587483360083006, 0.005150420542867332,0.005255079369126749,0.005943282039883662,0.006553663374138845,0.007987234488267537,0.008532816629570956,0.009109917255677953,0.009090535892099237,0.009345271792392902,0.009333790270405148,0.008222699639249225,0.008222699639249225,0.00933703952214322,0.009316410101920454,0.009062655447493215,0.009077731283617791,0.007109435991127877,0.006395901859314203,0.0023146191002413508,0.008998840709803318,0.010864237568978407,0.012173955726269246,0.012977790397795017,0.015486688242814123,0.018255569437219166,0.021436452743910258,0.022879483831103095,0.027220596125512964,0.03397850842001153,0.04412624479031144,0.05626406975143375,0.07261532534355286,0.18803730382126552,0.20998298954503963,0.21599181395017,0.21591809894317857,0.21600253166389952,0.215963686363448,0.21594902370899366,0.21599181395017,0.21615286537158865,0.21594902370899366,0.21600475816410217,0.21592701278740375,0.21592701278740375,0.21592797579846199,0.21592701278740375,0.2159690790780746,0.21592701278740375,0.21587949665473988,0.21598149800460525,0.21509411883418608,0.21594902370899366,0.21600475816410217,0.21594902370899366,0.21592701278740375,0.21594902370899366,0.21592701278740375,0.21509411883418608,0.21599181395017,0.2147680186790176,0.20621806053269998,0.21636065592427087,0.5223754531042417,0.5231480763660141,0.5271372011183942,0.5270637016227044,0.5200424677118666,0.4967495087659173,0.4819641905842687,0.3168859661552156,0.12778811039949836,0.09844712578508588,0.08138860306559688,0.07188165053657855,0.06869770551238737,0.06817175458737092,0.06779977373379464,0.06122146619054229,0.061049733636496815,0.061167820974894344,0.061167820974894344,0.06123824440246255,0.060561296253043254,0.06725728227036988,0.061167820974894344,0.05641982243405768,0.05033875042820421,0.04519683346159027,0.03717801661553431,0.01973553582134817,0.024533284638726508,0.03992913572709962,0.041044045144150706,0.04520933404516673,0.03554493970872831,0.04563337808152194,0.045344416021299225,0.04563337808152194)
maxHPD=c(0.12295711642864143, 0.11724546962630329,0.11169705263455285,0.10838260526139457,0.10619976868639665,0.10608174017406058,0.10581959907707172,0.10597997361792993,0.10565704327641455,0.10581457675842906,0.1056778679394101,0.10450312371609,0.10449056708605789,0.10563937954038002,0.10569996456032901,0.10569996456032901,0.1064044183898549,0.10681101087769854,0.11402135141513638,0.14620371535806131,0.23957123937693456,0.24831969847611796,0.2540340637358116,0.2595627202028135,0.2685874409188614,0.2780122816969887,0.2864851562541122,0.2917951010527233,0.2982630274699209,0.3038784284887287,0.3093525770249504,0.3143153275668575,0.3186347743137231,0.3495628025970031,0.32076048342401947,0.3168579141393196,0.315773248793124,0.31522277342796784,0.31490434272013756,0.3145653188319346,0.31426934476042523,0.3143153275668575,0.313964543002864,0.3139065905752867,0.3137363910234911,0.3137072451663336,0.31367268804014087,0.31367268804014087,0.31370888637188016,0.31367766710704204,0.31370888637188016,0.31386672828728923,0.31301077092171725,0.313964543002864,0.3141239913681125,0.31457854091952414,0.3149199092077193,0.3151102348446508,0.3153302240385895,0.31490434272013756,0.3166013531824763,0.31737934379784666,0.32541729484510656,0.9153928199591145,1.0277499803446721,1.023214856687244,1.025331848128682,1.0277499803446721,1.029388015457817,1.0527121771044718,1.0824224553456512,1.0839590325513158,1.0033903769812458,0.9738675326364243,0.9399223681733396,0.9104883024655241,0.8886663008440804,0.8781944068698636,0.8729645503174759,0.8637288467443606,0.8623658417683454,0.8619062789464706,0.8617673478607679,0.8629000629804318,0.8636932909585666,0.8732740261800185,0.8722491868958766,0.8789376467385261,0.8947249968226255,0.9279679983186335,0.9837034172343424,1.1030589793465544,1.247688914809683,1.389655411533947,1.4698234921795328,1.5482479865595233,1.603494453155953,1.6669126036518807,1.7251854490098024,1.7814270662113891)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.9595697728325283), xlim = c(-168.212355,-96.208716), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (combined_100_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-96.57237074242424, -97.29968022727272,-98.0269897121212,-98.7542991969697,-99.48160868181817,-100.20891816666666,-100.93622765151514,-101.66353713636363,-102.39084662121212,-103.1181561060606,-103.84546559090909,-104.57277507575756,-105.30008456060605,-106.02739404545454,-106.75470353030302,-107.48201301515151,-108.2093225,-108.93663198484847,-109.66394146969697,-110.39125095454546,-111.11856043939393,-111.84586992424242,-112.5731794090909,-113.30048889393939,-114.02779837878788,-114.75510786363635,-115.48241734848484,-116.20972683333332,-116.93703631818181,-117.6643458030303,-118.39165528787879,-119.11896477272727,-119.84627425757574,-120.57358374242423,-121.30089322727272,-122.02820271212121,-122.75551219696969,-123.48282168181818,-124.21013116666666,-124.93744065151515,-125.66475013636364,-126.39205962121211,-127.1193691060606,-127.84667859090908,-128.57398807575757,-129.30129756060606,-130.02860704545455,-130.75591653030304,-131.4832260151515,-132.2105355,-132.93784498484848,-133.66515446969697,-134.39246395454543,-135.11977343939392,-135.84708292424241,-136.5743924090909,-137.3017018939394,-138.02901137878789,-138.75632086363638,-139.48363034848484,-140.21093983333333,-140.93824931818182,-141.6655588030303,-142.39286828787877,-143.12017777272726,-143.84748725757575,-144.57479674242424,-145.30210622727273,-146.02941571212122,-146.7567251969697,-147.48403468181817,-148.21134416666666,-148.93865365151515,-149.66596313636362,-150.3932726212121,-151.1205821060606,-151.8478915909091,-152.57520107575758,-153.30251056060607,-154.02982004545456,-154.75712953030302,-155.4844390151515,-156.2117485,-156.9390579848485,-157.66636746969695,-158.39367695454544,-159.12098643939393,-159.84829592424242,-160.5756054090909,-161.3029148939394,-162.0302243787879,-162.75753386363638,-163.48484334848484,-164.21215283333333,-164.9394623181818,-165.6667718030303,-166.39408128787878,-167.12139077272727,-167.84870025757576)
counts=c(0.00826, 0.00869,0.00747,0.0064,0.00389,0.00243,0.00157,0.00116,0.00076,0.00071,0.00077,0.00096,0.00082,0.00101,0.00175,0.00323,0.00785,0.0173,0.02794,0.02291,0.01623,0.01791,0.02698,0.04982,0.07596,0.10118,0.1132,0.14273,0.1284,0.0988,0.06158,0.0428,0.02978,0.02651,0.01079,0.00278,0.00177,0.00123,0.00155,0.00127,0.00119,0.00144,0.0009,0.00073,0.00052,0.00056,0.00079,0.00074,0.00056,0.0007,0.00066,0.00068,0.00059,0.00146,0.00201,0.00101,0.00104,0.00142,0.00181,0.00392,0.00703,0.3345,0.6304,0.02259,0.00639,0.00388,0.00378,0.01722,0.0172,0.01461,0.08078,0.08888,0.08319,0.06718,0.04833,0.03251,0.02191,0.01426,0.00952,0.00651,0.00611,0.00525,0.00515,0.00562,0.00767,0.01089,0.01481,0.01685,0.01784,0.01674,0.01232,0.01172,0.01004,0.00965,0.00902,0.00871,0.00942,0.00915,0.00581)
plot(mids,counts,type = 'h', xlim = c(-168.212355,-96.208716), ylim=c(0,0.6304), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03299118156891654
bf6 = 0.20133565640968581
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-96.56873419499999, -97.28877058499998,-98.008806975,-98.72884336499999,-99.44887975500001,-100.168916145,-100.88895253499999,-101.608988925,-102.329025315,-103.04906170499999,-103.769098095,-104.489134485,-105.20917087499998,-105.929207265,-106.64924365499999,-107.36928004499998,-108.089316435,-108.80935282499999,-109.52938921499998,-110.249425605,-110.96946199499999,-111.68949838500001,-112.409534775,-113.12957116499999,-113.849607555,-114.569643945,-115.28968033499999,-116.009716725,-116.729753115,-117.44978950499998,-118.169825895,-118.88986228499999,-119.60989867499998,-120.329935065,-121.04997145499999,-121.77000784499998,-122.490044235,-123.21008062499999,-123.93011701500001,-124.650153405,-125.37018979499999,-126.090226185,-126.810262575,-127.53029896499999,-128.250335355,-128.970371745,-129.69040813499998,-130.410444525,-131.130480915,-131.85051730499998,-132.570553695,-133.290590085,-134.01062647499998,-134.730662865,-135.450699255,-136.17073564499998,-136.890772035,-137.610808425,-138.33084481499998,-139.050881205,-139.770917595,-140.49095398499998,-141.210990375,-141.93102676499998,-142.65106315499997,-143.371099545,-144.09113593499998,-144.811172325,-145.531208715,-146.251245105,-146.971281495,-147.691317885,-148.411354275,-149.131390665,-149.851427055,-150.571463445,-151.291499835,-152.011536225,-152.731572615,-153.451609005,-154.17164539499998,-154.891681785,-155.611718175,-156.33175456499998,-157.051790955,-157.771827345,-158.49186373499998,-159.211900125,-159.931936515,-160.65197290499998,-161.372009295,-162.092045685,-162.81208207499998,-163.532118465,-164.25215485500001,-164.97219124499998,-165.692227635,-166.412264025,-167.13230041499997,-167.852336805)
rate=c(0.2508904063242735, 0.24962944994380876,0.24762895175134728,0.24275023969010834,0.23239862652236964,0.21311210038696676,0.18865169461093545,0.16272440563178137,0.1468849952350157,0.13667350530782388,0.1307695388090422,0.1266781710493724,0.12396846625303184,0.12190434327800509,0.12076799725101617,0.12015238109202678,0.1198719111123087,0.11969961202637262,0.11968859814093813,0.11978394155529785,0.12015847747388628,0.12079889087604279,0.12214582191327172,0.12553136933975045,0.1303429890616506,0.13688808675520353,0.14916367403180827,0.1897151836601873,0.2656164493888581,0.29021043461060586,0.30050861270049767,0.30365762447993694,0.3050540118766451,0.3068809610000841,0.31169402162636467,0.3117703501911224,0.2963817988525716,0.28226943807380145,0.26725912240297633,0.26206502574227064,0.26066386194330765,0.25969328127814095,0.25735893996204506,0.25661541581217884,0.25627952239443197,0.2559525079327519,0.25618015248591386,0.2574740170170101,0.2611792547881917,0.268489720286184,0.2819292412302641,0.2937057477724557,0.299899793442931,0.3033326374466926,0.3035095208463322,0.3037844113070983,0.30465748308102136,0.30607662316086237,0.3078304000402986,0.30926054431752387,0.3103057984692983,0.31090835960347296,0.31103032777386064,0.31111938698283426,0.31120060771916525,0.31119029673690424,0.31113039141365756,0.31101943370701457,0.3107003509080568,0.3104746164203328,0.31037792229193273,0.3103233284957499,0.3102960708269715,0.3102942307661032,0.31017768318370453,0.3097497662714408,0.3091187000992063,0.3083622914072125,0.3074740534447542,0.3068643125750214,0.3063444180591274,0.30597673260591884,0.3057449203572018,0.3056095088529138,0.3055721771776714,0.3055451305737551,0.3056171101102378,0.30580031236443234,0.306117002654422,0.30653850086620316,0.30714186745579275,0.30787860773888537,0.308691468849412,0.3096483973992024,0.3105096866653152,0.3114958691161076,0.3125146064106775,0.3135632001776083,0.31471704484667196,0.3157909939243395)
minHPD=c(0.0532521765599863, 0.05148625996546884,0.05305580368261346,0.04507284995924852,0.04426273476869099,0.03200159313889351,0.022051732383450994,0.02205144541821492,0.02031820411217581,0.01987967725215996,0.019975657599747176,0.02925410707826484,0.0298221692699604,0.032801961232187274,0.030745082342098315,0.02903476089399591,0.029013407544189067,0.02899015250787739,0.02871691990839746,0.02993630732190813,0.03214183581677692,0.033039030057801365,0.0330756443728365,0.034510766822172884,0.035857690051648856,0.03710921042946581,0.03513512263222353,0.02811622938720637,0.04585756409910381,0.07634220937305031,0.11145570440229695,0.12468452215427456,0.13378294281200773,0.1416992031011028,0.16353141375063251,0.17036740976336237,0.13894355773870096,0.12122013653202293,0.10145572797046992,0.11258940682735342,0.11386921505713488,0.11460877000796524,0.11182500597498654,0.1098261700026993,0.10839657316571537,0.1082195324627593,0.10818218608061572,0.10562689400337809,0.1079510154344523,0.10667281907909532,0.12133803728523666,0.1584941011246849,0.19256887496882785,0.21184453502696574,0.21578465019966223,0.21653302230324536,0.2187888945922258,0.22478521702958373,0.22940733794811885,0.233292150941465,0.2353238128105481,0.23548405828845628,0.23548405828845628,0.23548405828845628,0.23548405828845628,0.23548405828845628,0.2350152161741633,0.23542519325586955,0.23341807586099386,0.23318345842555624,0.233292150941465,0.2333765873734897,0.233292150941465,0.2333765873734897,0.23201170546984712,0.23159179879102704,0.22757405210747464,0.22132576930529135,0.214747822848836,0.18266270715376567,0.15819924715072833,0.1364675143516737,0.13306113160042154,0.11856046764092613,0.1169823211598143,0.10857029441413518,0.10198147343448218,0.09130538523480447,0.07415979923874733,0.0640754310370487,0.04272227594174689,0.019893539290190315,0.00384025759478535,0.0005010372572528704,0.0005010372572528704,0.0005010372572528704,0.0005010372572528704,0.001174698065339837,0.001174698065339837,0.0043851824474506525)
maxHPD=c(1.374443256277673, 1.3746889092750623,1.374443256277673,1.3416350081722561,1.2811013593048657,1.1567479825011446,0.9973175205955567,0.7597020302068069,0.5661606023123669,0.42028443307308383,0.31972475770184244,0.29129750052387904,0.28076736685418924,0.2786446467622434,0.27458491971326143,0.2721135227638984,0.2720015257766112,0.27201014544252344,0.2719899825610263,0.2735923650771191,0.2766864301170338,0.27921861882837684,0.28271166651850066,0.2907058066727001,0.30070375642394154,0.31210179069199323,0.32650788076006826,0.3965045488852033,0.519112254922625,0.593804346452766,0.6219729763263154,0.6247641807684685,0.6300008783610941,0.6427744392717908,0.6916492008152796,0.7079195989057133,0.5956519283584973,0.5016248559909475,0.36110167300359375,0.3442879594271391,0.3412885965859213,0.3405621754052897,0.3376535880188566,0.33628858160984326,0.33609186037443173,0.33831460981400263,0.3408749770548024,0.34029546055663956,0.3469708156030883,0.35811856381778334,0.3855691536197441,0.4073024548261573,0.4159593192482205,0.41495653644728214,0.4151275899479167,0.4143448167411327,0.41390421638631325,0.4157403010937146,0.41593321535316535,0.4164401472823652,0.4169346314860732,0.4166712005111234,0.4166365405218571,0.41664812489315706,0.41686004542770083,0.41721211015774645,0.41710180564843957,0.41832459888922513,0.418313225533367,0.4195726947126028,0.42081028269655774,0.42246332945101434,0.42372306279404637,0.4257053134976735,0.4266711307745076,0.430726828347516,0.43462836576672903,0.443062617899219,0.45921150929428123,0.4611203545772918,0.45964271447879573,0.4524292078132917,0.45732908783013854,0.4487216142791897,0.4525854268767765,0.45013998353401996,0.45111405763983337,0.44964970485626277,0.4445531195959445,0.44873573158417507,0.4496757977268624,0.4524220750654294,0.48350020934165394,0.6247617705179747,0.8063124320321625,0.9771155949170495,1.1376096939089306,1.2847378985003377,1.4161282924616727,1.525353998072926)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.6778893978802187), xlim = c(-168.212355,-96.208716), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-96.57237074242424, -97.29968022727272,-98.0269897121212,-98.7542991969697,-99.48160868181817,-100.20891816666666,-100.93622765151514,-101.66353713636363,-102.39084662121212,-103.1181561060606,-103.84546559090909,-104.57277507575756,-105.30008456060605,-106.02739404545454,-106.75470353030302,-107.48201301515151,-108.2093225,-108.93663198484847,-109.66394146969697,-110.39125095454546,-111.11856043939393,-111.84586992424242,-112.5731794090909,-113.30048889393939,-114.02779837878788,-114.75510786363635,-115.48241734848484,-116.20972683333332,-116.93703631818181,-117.6643458030303,-118.39165528787879,-119.11896477272727,-119.84627425757574,-120.57358374242423,-121.30089322727272,-122.02820271212121,-122.75551219696969,-123.48282168181818,-124.21013116666666,-124.93744065151515,-125.66475013636364,-126.39205962121211,-127.1193691060606,-127.84667859090908,-128.57398807575757,-129.30129756060606,-130.02860704545455,-130.75591653030304,-131.4832260151515,-132.2105355,-132.93784498484848,-133.66515446969697,-134.39246395454543,-135.11977343939392,-135.84708292424241,-136.5743924090909,-137.3017018939394,-138.02901137878789,-138.75632086363638,-139.48363034848484,-140.21093983333333,-140.93824931818182,-141.6655588030303,-142.39286828787877,-143.12017777272726,-143.84748725757575,-144.57479674242424,-145.30210622727273,-146.02941571212122,-146.7567251969697,-147.48403468181817,-148.21134416666666,-148.93865365151515,-149.66596313636362,-150.3932726212121,-151.1205821060606,-151.8478915909091,-152.57520107575758,-153.30251056060607,-154.02982004545456,-154.75712953030302,-155.4844390151515,-156.2117485,-156.9390579848485,-157.66636746969695,-158.39367695454544,-159.12098643939393,-159.84829592424242,-160.5756054090909,-161.3029148939394,-162.0302243787879,-162.75753386363638,-163.48484334848484,-164.21215283333333,-164.9394623181818,-165.6667718030303,-166.39408128787878,-167.12139077272727,-167.84870025757576)
counts=c(0.00874, 0.0103,0.01534,0.0282,0.04639,0.05865,0.07948,0.07166,0.05636,0.03853,0.02967,0.0199,0.01537,0.00875,0.00484,0.00341,0.00252,0.00247,0.00314,0.0053,0.00837,0.01581,0.03315,0.03857,0.05127,0.0774,0.14123,0.18851,0.14093,0.05935,0.0246,0.01756,0.02154,0.03569,0.03624,0.13649,0.11137,0.09526,0.01998,0.00829,0.01063,0.01113,0.00497,0.00487,0.00682,0.00671,0.01364,0.03145,0.07174,0.13193,0.07432,0.05125,0.01379,0.00457,0.00702,0.01184,0.01682,0.01405,0.0123,0.00747,0.00303,0.00176,0.00159,0.00177,0.00207,0.00186,0.0039,0.0035,0.0027,0.00287,0.0029,0.00283,0.00353,0.00553,0.00834,0.01007,0.0104,0.00928,0.00796,0.00639,0.00481,0.0039,0.00346,0.0039,0.0047,0.00485,0.00706,0.00763,0.00995,0.01126,0.0123,0.01271,0.0123,0.01253,0.01241,0.01377,0.0135,0.01291,0.00846)
plot(mids,counts,type = 'h', xlim = c(-168.212355,-96.208716), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-96.56873419499999, -97.28877058499998,-98.008806975,-98.72884336499999,-99.44887975500001,-100.168916145,-100.88895253499999,-101.608988925,-102.329025315,-103.04906170499999,-103.769098095,-104.489134485,-105.20917087499998,-105.929207265,-106.64924365499999,-107.36928004499998,-108.089316435,-108.80935282499999,-109.52938921499998,-110.249425605,-110.96946199499999,-111.68949838500001,-112.409534775,-113.12957116499999,-113.849607555,-114.569643945,-115.28968033499999,-116.009716725,-116.729753115,-117.44978950499998,-118.169825895,-118.88986228499999,-119.60989867499998,-120.329935065,-121.04997145499999,-121.77000784499998,-122.490044235,-123.21008062499999,-123.93011701500001,-124.650153405,-125.37018979499999,-126.090226185,-126.810262575,-127.53029896499999,-128.250335355,-128.970371745,-129.69040813499998,-130.410444525,-131.130480915,-131.85051730499998,-132.570553695,-133.290590085,-134.01062647499998,-134.730662865,-135.450699255,-136.17073564499998,-136.890772035,-137.610808425,-138.33084481499998,-139.050881205,-139.770917595,-140.49095398499998,-141.210990375,-141.93102676499998,-142.65106315499997,-143.371099545,-144.09113593499998,-144.811172325,-145.531208715,-146.251245105,-146.971281495,-147.691317885,-148.411354275,-149.131390665,-149.851427055,-150.571463445,-151.291499835,-152.011536225,-152.731572615,-153.451609005,-154.17164539499998,-154.891681785,-155.611718175,-156.33175456499998,-157.051790955,-157.771827345,-158.49186373499998,-159.211900125,-159.931936515,-160.65197290499998,-161.372009295,-162.092045685,-162.81208207499998,-163.532118465,-164.25215485500001,-164.97219124499998,-165.692227635,-166.412264025,-167.13230041499997,-167.852336805)
net_rate=c(-0.36018766968191335, -0.3652190704193314,-0.3690540277871497,-0.3646074919592101,-0.34633244865116025,-0.3090009198921117,-0.2596220040654399,-0.19319910658863776,-0.1475813792954156,-0.11737871068203251,-0.10115932144832566,-0.09054603199418249,-0.08426234407077218,-0.08007052157617267,-0.07804790738741818,-0.07705451873033704,-0.07631419968108949,-0.07499689245791252,-0.0720511364807336,-0.06676939624015514,-0.06223371289745849,-0.060030188561501864,-0.05913154732327297,-0.0601657415072758,-0.05907535373692721,-0.05477271525044474,-0.04944723637758376,-0.05627437090389182,-0.0838161666646242,-0.10786700561450989,-0.11327318046591325,-0.10712043218264662,-0.10130376088646101,-0.10141201181721972,-0.11836403098377322,-0.11974781852190294,-0.06922331024299382,-0.026342983897313862,0.009725177089277757,0.018607204492842436,0.020567011817821605,0.021741402388166162,0.024785192627542054,0.025704734296548085,0.026348630253582517,0.027105732329386942,0.027488524689758046,0.026416236098725118,0.022927174969202456,0.014455060145860054,-0.006561411302468753,-0.028486609895095886,-0.03967643550353974,-0.04530232938514572,-0.044205671511717885,-0.0441444060044242,-0.045213674476458535,-0.04738457677826979,-0.05004166136848898,-0.05210605631661249,-0.05341226242118702,-0.05370926394456086,-0.04542256232594195,0.24605559323915516,0.43670284032210105,0.4381869881911607,0.44193462374179976,0.4427183514056066,0.441577500696898,0.43230386355367156,0.42720332624710017,0.413601614821823,0.36177485667233067,0.30847219055020014,0.26156206040155733,0.2280235240110198,0.20640585992139734,0.19320222540372758,0.18635595847834704,0.1827301335078733,0.1816364584596568,0.18164048832706364,0.18190554604590317,0.18273709559576357,0.18423169156421831,0.1864488271818321,0.19072796655221588,0.19842038955062177,0.2102131869036255,0.22530028592956203,0.23690462054354913,0.24573237327000638,0.24544739219699163,0.24404983005110448,0.24016862649262724,0.23578001163777682,0.22979129934371623,0.22297740996927404,0.21725169273144904,0.2117200447716268)
net_minHPD=c(-1.529761036945971, -1.467907276590817,-1.4192907906401,-1.3578035640435109,-1.261978023184612,-1.1217296188833825,-0.9603266407900052,-0.7175659944607082,-0.5232761862196453,-0.37549889367126466,-0.27472030116784096,-0.24177937765884244,-0.2304104788651059,-0.22290659604510674,-0.21967924241781367,-0.21907654766065643,-0.21971278248012266,-0.22045204408805277,-0.22671223170891924,-0.24533964126892838,-0.2464574749156537,-0.24287649794808086,-0.245322064603587,-0.24793731449214462,-0.24967134512829273,-0.25288816660189567,-0.262495603695964,-0.27889231976973616,-0.3410675547845655,-0.38119856445550454,-0.39671266844489267,-0.3935020792531402,-0.3935020792531402,-0.39704821087020614,-0.43903494589869135,-0.44973486304871324,-0.33934404942206203,-0.2445877123702642,-0.11629529915987308,-0.09287563228160714,-0.09221212010348201,-0.08913967495249153,-0.08746857427935589,-0.08722388429054284,-0.0872562625491872,-0.08866968864576136,-0.08896928476017504,-0.08913967495249153,-0.0948690307284413,-0.1034826556075808,-0.13492807771530824,-0.15033206622951917,-0.15710633128587914,-0.15656540519159062,-0.15797110761488864,-0.15727117969446364,-0.1572644566919451,-0.15727117969446364,-0.16238587271932037,-0.16238587271932037,-0.1662466094161226,-0.1673588404845095,-0.18846637207306385,-0.1536672164058091,0.17598268844309317,0.181887867015524,0.18167599719071825,0.1806090170436545,0.1818182183869465,0.15798895189415363,0.12473551921353232,-0.004695668501222605,-0.18513850751687794,-0.22843348968018554,-0.2443256283579811,-0.25756742671908917,-0.2572940185474591,-0.2617278359892203,-0.2577613758694157,-0.26130939693794397,-0.2592110360605733,-0.26147330267402985,-0.2577613758694157,-0.26061182090024304,-0.2617278359892203,-0.26667305811653363,-0.26381886315352976,-0.2776644843532587,-0.2869557169361387,-0.31968129032764747,-0.357274254852166,-0.38862009119907454,-0.5015480551708971,-0.8007283807742842,-1.022189710420686,-1.0681471662375372,-1.2663239619911857,-1.4542106706193332,-1.6084293292462186,-1.7395112719853834)
net_maxHPD=c(0.047314831853863204, 0.04286443959720512,0.03497004538725429,0.02789698451405928,0.02901651786357906,0.04303721518270126,0.045685111391718256,0.05176805956354093,0.05184876043271027,0.05061011598627487,0.05061011598627487,0.03953646668705307,0.03612225877661591,0.03603965241308959,0.03611033987736506,0.03592938724983623,0.036298752166827465,0.03951312553852483,0.04565467333512214,0.06186930976056563,0.11748440591660735,0.141933668495187,0.15437735731454727,0.16855353108924895,0.18479650922343716,0.1989940042604443,0.2076317811091009,0.22098050311762407,0.21979042393643908,0.19971834943429698,0.1524810216218306,0.1326877219583642,0.12488621394060018,0.12077697648860605,0.10535459895707261,0.10530989916908814,0.12933287144514738,0.153278590690493,0.16633268963213754,0.16229376402650958,0.15847745542962297,0.15994425088624079,0.1609112183452614,0.16176451601690223,0.1629602992308125,0.1638609088179308,0.16633641637343025,0.16786543987304364,0.16548247591712473,0.1663431222827287,0.14551997891216287,0.11258789012283363,0.07981810399458958,0.06343098098200511,0.05887657818368469,0.059383079834430585,0.05758771101601365,0.05538567201535516,0.04828209098106517,0.0467169871457323,0.04399339006904987,0.04607914983124484,0.056169937005957876,0.6197226592424296,0.7192616469365085,0.718941976280862,0.7171748913306466,0.7190464648692805,0.7309150875817777,0.7572953287281535,0.7671301016743015,0.7799860100382547,0.7104283814193075,0.6750574132524351,0.6440729364818638,0.6113478063866454,0.5958777042039447,0.5825958937261797,0.582507763196892,0.5777581592260883,0.5797584585367248,0.5777888153996651,0.5824876706218739,0.5824089110007631,0.5848351369938137,0.5854209368669199,0.6003880612390741,0.6096304523632798,0.6464570506265499,0.7114117379561644,0.9831278139661028,1.4186907293652822,1.7307172592742845,1.7782265096230783,1.8245949265876167,2.0129191074127757,2.0238385410951265,2.013598430312669,2.023583666102895,2.050843284470106)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-1.913462399183922, 2.255927612917117), xlim = c(-168.212355,-96.208716), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-96.56873419499999, -97.28877058499998,-98.008806975,-98.72884336499999,-99.44887975500001,-100.168916145,-100.88895253499999,-101.608988925,-102.329025315,-103.04906170499999,-103.769098095,-104.489134485,-105.20917087499998,-105.929207265,-106.64924365499999,-107.36928004499998,-108.089316435,-108.80935282499999,-109.52938921499998,-110.249425605,-110.96946199499999,-111.68949838500001,-112.409534775,-113.12957116499999,-113.849607555,-114.569643945,-115.28968033499999,-116.009716725,-116.729753115,-117.44978950499998,-118.169825895,-118.88986228499999,-119.60989867499998,-120.329935065,-121.04997145499999,-121.77000784499998,-122.490044235,-123.21008062499999,-123.93011701500001,-124.650153405,-125.37018979499999,-126.090226185,-126.810262575,-127.53029896499999,-128.250335355,-128.970371745,-129.69040813499998,-130.410444525,-131.130480915,-131.85051730499998,-132.570553695,-133.290590085,-134.01062647499998,-134.730662865,-135.450699255,-136.17073564499998,-136.890772035,-137.610808425,-138.33084481499998,-139.050881205,-139.770917595,-140.49095398499998,-141.210990375,-141.93102676499998,-142.65106315499997,-143.371099545,-144.09113593499998,-144.811172325,-145.531208715,-146.251245105,-146.971281495,-147.691317885,-148.411354275,-149.131390665,-149.851427055,-150.571463445,-151.291499835,-152.011536225,-152.731572615,-153.451609005,-154.17164539499998,-154.891681785,-155.611718175,-156.33175456499998,-157.051790955,-157.771827345,-158.49186373499998,-159.211900125,-159.931936515,-160.65197290499998,-161.372009295,-162.092045685,-162.81208207499998,-163.532118465,-164.25215485500001,-164.97219124499998,-165.692227635,-166.412264025,-167.13230041499997,-167.852336805)
rate=c(2.2722908782881515, 2.2782877331854317,2.291689566529815,2.3423903910807065,2.472838982903699,2.7385187413298855,3.1756619496101206,4.029478201548112,4.940568588937988,5.809661682501741,6.4164793506112545,6.886252459120784,7.197130275888559,7.419622550347755,7.528971756538393,7.57789146922842,7.598895625049276,7.6073160646292095,7.604655381904877,7.591172185674835,7.551876392451027,7.4847954345517005,7.352422457711476,7.051880678753922,6.679705070431562,6.260222725596261,5.735866432734107,4.906146752690275,3.8498423728471645,3.2084857886212426,2.947232952379289,2.8796340628798704,2.8523685794328424,2.802904861967224,2.640183027585336,2.606231081932927,2.999572283219994,3.440060002829685,3.9266219530567756,4.070715475186193,4.105838917396549,4.127007459470874,4.181138972806572,4.198728940960505,4.210537142033391,4.224087549305493,4.230892189040226,4.211588514283401,4.150487183237288,4.009360976487111,3.6976664973222713,3.42053616787477,3.2947236596115186,3.234869617934963,3.2459045547616543,3.243083426681584,3.2301811930165942,3.2080916172585896,3.181199316010351,3.159868685628777,3.143987794202577,3.1363500431871785,3.134985313190971,3.1342961039265576,3.1331610795291454,3.133773486167917,3.134653481571478,3.1366968341742107,3.1432853043277653,3.147066542123686,3.148433258716598,3.1433636444299093,3.135528085128782,3.1260552186539323,3.124600958040134,3.144682245075456,3.171497641200716,3.200956596997233,3.2314618666621886,3.2525423251209586,3.267185067198633,3.2783866641885453,3.283699395333803,3.285777300263043,3.2841357657400505,3.276798256985367,3.259467151704809,3.2289867356140953,3.1725257568416154,3.1032621019641593,3.004203016183154,2.893974781850455,2.775749933654863,2.666054902595676,2.5705212316423887,2.4805809871020092,2.393248506520278,2.308728597389272,2.2297734007563306,2.1589658863723633)
minHPD=c(2.2722908782881515, 2.2782877331854317,2.291689566529815,2.3423903910807065,2.472838982903699,2.7385187413298855,3.1756619496101206,4.029478201548112,4.940568588937988,5.809661682501741,6.4164793506112545,6.886252459120784,7.197130275888559,7.419622550347755,7.528971756538393,7.57789146922842,7.598895625049276,7.6073160646292095,7.604655381904877,7.591172185674835,7.551876392451027,7.4847954345517005,7.352422457711476,7.051880678753922,6.679705070431562,6.260222725596261,5.735866432734107,4.906146752690275,3.8498423728471645,3.2084857886212426,2.947232952379289,2.8796340628798704,2.8523685794328424,2.802904861967224,2.640183027585336,2.606231081932927,2.999572283219994,3.440060002829685,3.9266219530567756,4.070715475186193,4.105838917396549,4.127007459470874,4.181138972806572,4.198728940960505,4.210537142033391,4.224087549305493,4.230892189040226,4.211588514283401,4.150487183237288,4.009360976487111,3.6976664973222713,3.42053616787477,3.2947236596115186,3.234869617934963,3.2459045547616543,3.243083426681584,3.2301811930165942,3.2080916172585896,3.181199316010351,3.159868685628777,3.143987794202577,3.1363500431871785,3.134985313190971,3.1342961039265576,3.1331610795291454,3.133773486167917,3.134653481571478,3.1366968341742107,3.1432853043277653,3.147066542123686,3.148433258716598,3.1433636444299093,3.135528085128782,3.1260552186539323,3.124600958040134,3.144682245075456,3.171497641200716,3.200956596997233,3.2314618666621886,3.2525423251209586,3.267185067198633,3.2783866641885453,3.283699395333803,3.285777300263043,3.2841357657400505,3.276798256985367,3.259467151704809,3.2289867356140953,3.1725257568416154,3.1032621019641593,3.004203016183154,2.893974781850455,2.775749933654863,2.666054902595676,2.5705212316423887,2.4805809871020092,2.393248506520278,2.308728597389272,2.2297734007563306,2.1589658863723633)
maxHPD=c(2.2722908782881515, 2.2782877331854317,2.291689566529815,2.3423903910807065,2.472838982903699,2.7385187413298855,3.1756619496101206,4.029478201548112,4.940568588937988,5.809661682501741,6.4164793506112545,6.886252459120784,7.197130275888559,7.419622550347755,7.528971756538393,7.57789146922842,7.598895625049276,7.6073160646292095,7.604655381904877,7.591172185674835,7.551876392451027,7.4847954345517005,7.352422457711476,7.051880678753922,6.679705070431562,6.260222725596261,5.735866432734107,4.906146752690275,3.8498423728471645,3.2084857886212426,2.947232952379289,2.8796340628798704,2.8523685794328424,2.802904861967224,2.640183027585336,2.606231081932927,2.999572283219994,3.440060002829685,3.9266219530567756,4.070715475186193,4.105838917396549,4.127007459470874,4.181138972806572,4.198728940960505,4.210537142033391,4.224087549305493,4.230892189040226,4.211588514283401,4.150487183237288,4.009360976487111,3.6976664973222713,3.42053616787477,3.2947236596115186,3.234869617934963,3.2459045547616543,3.243083426681584,3.2301811930165942,3.2080916172585896,3.181199316010351,3.159868685628777,3.143987794202577,3.1363500431871785,3.134985313190971,3.1342961039265576,3.1331610795291454,3.133773486167917,3.134653481571478,3.1366968341742107,3.1432853043277653,3.147066542123686,3.148433258716598,3.1433636444299093,3.135528085128782,3.1260552186539323,3.124600958040134,3.144682245075456,3.171497641200716,3.200956596997233,3.2314618666621886,3.2525423251209586,3.267185067198633,3.2783866641885453,3.283699395333803,3.285777300263043,3.2841357657400505,3.276798256985367,3.259467151704809,3.2289867356140953,3.1725257568416154,3.1032621019641593,3.004203016183154,2.893974781850455,2.775749933654863,2.666054902595676,2.5705212316423887,2.4805809871020092,2.393248506520278,2.308728597389272,2.2297734007563306,2.1589658863723633)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 8.368047671092132), xlim = c(-168.212355,-96.208716), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()