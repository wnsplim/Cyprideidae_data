

pdf(file='./t144RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-96.885121185, -97.36197555499999,-97.838829925,-98.31568429500001,-98.792538665,-99.26939303500001,-99.74624740499999,-100.223101775,-100.69995614499999,-101.176810515,-101.65366488500001,-102.130519255,-102.60737362500001,-103.08422799499999,-103.561082365,-104.03793673499999,-104.514791105,-104.99164547499998,-105.468499845,-105.94535421500001,-106.42220858499999,-106.899062955,-107.37591732499999,-107.852771695,-108.32962606499999,-108.806480435,-109.28333480500001,-109.760189175,-110.237043545,-110.71389791499999,-111.190752285,-111.66760665499999,-112.144461025,-112.62131539500001,-113.098169765,-113.575024135,-114.05187850499999,-114.528732875,-115.00558724499999,-115.482441615,-115.95929598500001,-116.436150355,-116.91300472500001,-117.38985909499999,-117.866713465,-118.34356783499999,-118.820422205,-119.29727657500001,-119.774130945,-120.25098531500001,-120.72783968499999,-121.204694055,-121.68154842499999,-122.158402795,-122.63525716500001,-123.112111535,-123.58896590500001,-124.065820275,-124.542674645,-125.01952901499999,-125.496383385,-125.97323775500001,-126.450092125,-126.92694649500001,-127.403800865,-127.880655235,-128.357509605,-128.834363975,-129.311218345,-129.788072715,-130.26492708499998,-130.741781455,-131.218635825,-131.695490195,-132.172344565,-132.649198935,-133.126053305,-133.602907675,-134.079762045,-134.55661641499998,-135.033470785,-135.510325155,-135.987179525,-136.464033895,-136.94088826499998,-137.417742635,-137.894597005,-138.371451375,-138.848305745,-139.325160115,-139.802014485,-140.278868855,-140.755723225,-141.23257759499998,-141.709431965,-142.186286335,-142.663140705,-143.139995075,-143.61684944499999)
rate=c(0.3908800950768938, 0.3911121748510523,0.391182485704665,0.3912232253715171,0.39128920786148236,0.39129419122703446,0.39125654637332596,0.39125322192100287,0.3912573152236978,0.3911971840809203,0.3911997513894483,0.3911668525030954,0.3911061048585157,0.3910631723966541,0.3909716115847102,0.39094375089145206,0.3909167181224408,0.3908536430296918,0.3907844789204683,0.39077078066223947,0.3907434807664041,0.3906349373291943,0.3905802170664665,0.39056440629969014,0.39054804551596334,0.3904939905047644,0.39040623320121937,0.3904136123774954,0.3904096594560775,0.3903925995840884,0.3903338191304974,0.39035011426559757,0.3904089622234542,0.39050453735529234,0.3905842772467577,0.3906884882876934,0.3908737896075869,0.39108403489699617,0.3913419803461803,0.3916594900208332,0.3921479381876364,0.39278832344414977,0.39365657327241466,0.3944807054769708,0.39532598614882164,0.39637130951011595,0.39746966549055107,0.3983781946365337,0.3993153381571964,0.4003154058886177,0.4014124929929692,0.4023463205382455,0.4032168384072389,0.4032148535573702,0.40300143101247865,0.401615852973802,0.3997396235323776,0.3944667670247687,0.38886784358069454,0.385928094378624,0.3844526652442286,0.3826304621721005,0.3799388042368396,0.37750204995620806,0.3760048533608418,0.3746726432217178,0.37380326802565556,0.37308200318438856,0.3724882467284097,0.3720270240891613,0.37154105855825126,0.37111811941098494,0.370775829664773,0.37045549177003445,0.3702071366769044,0.36998216906154247,0.36972698506962054,0.36952299312721526,0.3693843792734499,0.36923243618553403,0.369130430897589,0.369050550393326,0.36896842770863336,0.3689090275748418,0.3688609881410056,0.3688363951998858,0.3688334522875282,0.3688444770865801,0.36886314227051437,0.3689241908064899,0.36895517580089987,0.3690162744853602,0.3691066039139738,0.36926366513316367,0.3695855575793796,0.36996089313271724,0.37031392271001395,0.370739155250275,0.370841733605656)
minHPD=c(0.019185515390497586, 0.02266817389238925,0.02368000012957247,0.02266817389238925,0.02387564187592622,0.025243074271647632,0.029530938748802405,0.024044853870660708,0.019213503365190992,0.02387564187592622,0.027783059249665388,0.03172436870920071,0.02266817389238925,0.025210431983968218,0.03247667880331032,0.03773513411855179,0.036467677526788055,0.027783059249665388,0.03253143679993613,0.03797762272894981,0.027783059249665388,0.02782949655395011,0.035671028134777384,0.035671028134777384,0.03896088324213897,0.03830439411310712,0.03744938318147376,0.03908562025639159,0.042362759593038646,0.047311137281404465,0.048829174858614786,0.05113455484117834,0.05730659965573444,0.05894583145137896,0.05751513041964812,0.0641305308025321,0.0641199024128385,0.0641199024128385,0.06932114525066506,0.06872247809593837,0.08634730881034419,0.09191613676243428,0.105951798073283,0.13132599335948597,0.16461782233647404,0.18427740393903103,0.22474214898033568,0.23483413227120323,0.23485799110289865,0.23378281912367604,0.24106129618033745,0.24115800899905412,0.24106129618033745,0.24438439106101825,0.24420434336593372,0.24037204605194284,0.24106129618033745,0.2349547094843897,0.22923324443382376,0.22501849874927715,0.2223192467144689,0.21835610949600026,0.21835610949600026,0.22306394546790811,0.222697151760219,0.22908482131287142,0.22885979271726514,0.22837040389261437,0.22857237426960728,0.22865556690205097,0.2309521377896706,0.23279380713062983,0.23271732313127705,0.23481937308681322,0.2348157486061725,0.23481588785793103,0.232811301187368,0.23278035057987365,0.22866925296711163,0.22868265100153057,0.2286208526033028,0.22866925296711163,0.2294216488499762,0.2294525532049455,0.22866925296711163,0.22868265100153057,0.22875459740730603,0.22885979271726514,0.22868265100153057,0.22868265100153057,0.22863580455770155,0.2291813571614614,0.22868265100153057,0.22863580455770155,0.22604195559650772,0.22306178953154415,0.21668536063617114,0.21466886660030549,0.2125407626615173)
maxHPD=c(0.8753710187326974, 0.864169354478087,0.8625065170018665,0.8576282656744791,0.8556301579283252,0.8528162433119464,0.8526307182739412,0.8437643604359474,0.8346671492312198,0.8346671492312198,0.8346671492312198,0.8346671492312198,0.82042120947897,0.8187045928241301,0.8202674325368852,0.8204315757656833,0.815519347083431,0.80300062936799,0.80300062936799,0.8031778712759202,0.788781445173639,0.7834070152038268,0.7864793613567882,0.7819407355678313,0.7807619945006725,0.7764138697943079,0.7699945012720191,0.7674231339633463,0.7673095846143617,0.7681398760834687,0.7666661457515473,0.7658148545044875,0.7685095927133861,0.7674231339633463,0.7636088994425357,0.7680490560468811,0.7658266085907168,0.7634280803780098,0.7668039976469496,0.7648142430395476,0.782775845606548,0.7877334572411961,0.8000552834076008,0.8187045928241301,0.8474610406727784,0.8580731357737447,0.8903566786739769,0.8903566786739769,0.8854200407843382,0.88224519103302,0.8903566786739769,0.8974934997863373,0.9054874960772478,0.9099750493952012,0.9093570464877401,0.8838795218080857,0.8622204412521337,0.7773831183564978,0.6851292947257884,0.6413118066962726,0.6215295307615606,0.5948970899736878,0.5583494125807764,0.5392990028099257,0.5264250857812124,0.5229422917698872,0.5166151845005283,0.5124459547196688,0.5094853378412348,0.5075456698056726,0.5079374799232332,0.5083452105337071,0.5070088287413771,0.5083452105337071,0.5076330224870303,0.5073499593205941,0.5050776707953,0.5048378791573241,0.5004007097007194,0.5003602172585665,0.5001566675353656,0.5001566675353656,0.5007882064517155,0.5007937450824291,0.5002572087806038,0.5003602172585665,0.5007805789925239,0.5012780389855276,0.5012837458919485,0.5019474170922016,0.5027577269570271,0.5041124591812259,0.504760465664759,0.5064914281305786,0.5076330224870303,0.509343498011121,0.5084431338035893,0.5149786879774008,0.5146546442629668)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.0009725543347214), xlim = c(-144.0,-96.646694), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (combined_100_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-96.8858521111111, -97.36416833333332,-97.84248455555556,-98.32080077777778,-98.799117,-99.27743322222221,-99.75574944444445,-100.23406566666667,-100.71238188888888,-101.1906981111111,-101.66901433333334,-102.14733055555556,-102.62564677777777,-103.103963,-103.58227922222223,-104.06059544444444,-104.53891166666666,-105.01722788888888,-105.49554411111112,-105.97386033333333,-106.45217655555555,-106.93049277777777,-107.408809,-107.88712522222222,-108.36544144444444,-108.84375766666666,-109.32207388888888,-109.80039011111111,-110.27870633333333,-110.75702255555555,-111.23533877777778,-111.713655,-112.19197122222222,-112.67028744444444,-113.14860366666666,-113.62691988888889,-114.10523611111111,-114.58355233333333,-115.06186855555556,-115.54018477777778,-116.018501,-116.49681722222222,-116.97513344444444,-117.45344966666667,-117.93176588888889,-118.41008211111111,-118.88839833333334,-119.36671455555556,-119.84503077777778,-120.323347,-120.80166322222222,-121.27997944444444,-121.75829566666667,-122.23661188888889,-122.7149281111111,-123.19324433333334,-123.67156055555556,-124.14987677777778,-124.628193,-125.10650922222221,-125.58482544444445,-126.06314166666667,-126.54145788888889,-127.01977411111112,-127.49809033333334,-127.97640655555556,-128.45472277777776,-128.933039,-129.4113552222222,-129.88967144444445,-130.36798766666664,-130.84630388888888,-131.32462011111113,-131.80293633333332,-132.28125255555557,-132.75956877777776,-133.237885,-133.7162012222222,-134.19451744444444,-134.6728336666667,-135.15114988888888,-135.62946611111113,-136.10778233333332,-136.58609855555557,-137.06441477777776,-137.542731,-138.0210472222222,-138.49936344444444,-138.9776796666667,-139.45599588888888,-139.93431211111113,-140.41262833333332,-140.89094455555556,-141.36926077777775,-141.847577,-142.3258932222222,-142.80420944444444,-143.2825256666667,-143.76084188888888)
counts=c(0.01512, 0.0052,0.00506,0.00484,0.00476,0.00535,0.00503,0.00435,0.00487,0.00436,0.0048,0.00478,0.00475,0.00471,0.00479,0.00469,0.00429,0.00466,0.00452,0.00477,0.0049,0.00477,0.00488,0.00451,0.00445,0.00466,0.00485,0.00455,0.00441,0.00411,0.00444,0.0041,0.00429,0.00428,0.00449,0.00449,0.0047,0.00491,0.00499,0.00558,0.0072,0.00819,0.00779,0.00796,0.00894,0.0088,0.00805,0.00764,0.00875,0.00798,0.00898,0.00655,0.00314,0.00458,0.01007,0.01259,0.03669,0.03263,0.0167,0.01024,0.01417,0.01882,0.01601,0.01113,0.00962,0.0069,0.00611,0.00469,0.00434,0.00439,0.0039,0.00333,0.00298,0.00299,0.00266,0.00249,0.00232,0.00192,0.00223,0.0017,0.00193,0.00184,0.0017,0.00169,0.0019,0.0019,0.00209,0.00208,0.0021,0.00203,0.00202,0.00263,0.00359,0.00447,0.00488,0.00537,0.00646,0.0,0.0)
plot(mids,counts,type = 'h', xlim = c(-144.0,-96.646694), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03117019437132878
bf6 = 0.1920682782184701
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-96.885121185, -97.36197555499999,-97.838829925,-98.31568429500001,-98.792538665,-99.26939303500001,-99.74624740499999,-100.223101775,-100.69995614499999,-101.176810515,-101.65366488500001,-102.130519255,-102.60737362500001,-103.08422799499999,-103.561082365,-104.03793673499999,-104.514791105,-104.99164547499998,-105.468499845,-105.94535421500001,-106.42220858499999,-106.899062955,-107.37591732499999,-107.852771695,-108.32962606499999,-108.806480435,-109.28333480500001,-109.760189175,-110.237043545,-110.71389791499999,-111.190752285,-111.66760665499999,-112.144461025,-112.62131539500001,-113.098169765,-113.575024135,-114.05187850499999,-114.528732875,-115.00558724499999,-115.482441615,-115.95929598500001,-116.436150355,-116.91300472500001,-117.38985909499999,-117.866713465,-118.34356783499999,-118.820422205,-119.29727657500001,-119.774130945,-120.25098531500001,-120.72783968499999,-121.204694055,-121.68154842499999,-122.158402795,-122.63525716500001,-123.112111535,-123.58896590500001,-124.065820275,-124.542674645,-125.01952901499999,-125.496383385,-125.97323775500001,-126.450092125,-126.92694649500001,-127.403800865,-127.880655235,-128.357509605,-128.834363975,-129.311218345,-129.788072715,-130.26492708499998,-130.741781455,-131.218635825,-131.695490195,-132.172344565,-132.649198935,-133.126053305,-133.602907675,-134.079762045,-134.55661641499998,-135.033470785,-135.510325155,-135.987179525,-136.464033895,-136.94088826499998,-137.417742635,-137.894597005,-138.371451375,-138.848305745,-139.325160115,-139.802014485,-140.278868855,-140.755723225,-141.23257759499998,-141.709431965,-142.186286335,-142.663140705,-143.139995075,-143.61684944499999)
rate=c(0.424091790150595, 0.4250146469347921,0.42626836167565707,0.42755823574701535,0.42914689251233273,0.43066597776850213,0.4322474330207484,0.4336770297383423,0.43524821874245234,0.4365782063519347,0.4380551688144285,0.4394217828901118,0.44093198101541703,0.4424138903882189,0.44388080330667196,0.4454838711160036,0.4468184202687564,0.44815830818830515,0.449546649977162,0.4511639832475503,0.45256298648231885,0.45375688705765893,0.45511241127473107,0.4564911230617258,0.45785454753648536,0.45925249053067907,0.46065457688066574,0.4620546635010269,0.46342163435887984,0.4647152198955583,0.465956675801812,0.46704060447248974,0.46798568669158036,0.46920650680925324,0.4701887465097152,0.4709658037613271,0.4718787769040569,0.47299827039080455,0.4739589990942764,0.4753155408956063,0.477030943162237,0.4790280167014109,0.48090171822848987,0.4824645015922936,0.4841418034485027,0.4855874055752659,0.4868208030219475,0.4879615450744893,0.4895195426188872,0.49132881382289917,0.4934670412903036,0.49501604643071945,0.49465106792614233,0.4928085108083933,0.4868956496764524,0.4782123575269319,0.4652399546162135,0.4533980977182305,0.4418720175927002,0.42974329043741344,0.41796452827892006,0.40888682175625907,0.4012860463409271,0.39608324579396836,0.3928214675436412,0.3905923490706335,0.3887730308428625,0.3870012220422777,0.38503629299245523,0.38333953307406154,0.38225527584697727,0.3814373862947661,0.3808283899536796,0.3802146889689436,0.37973220938823427,0.37937964759407555,0.3789702051010727,0.378685847166238,0.37847793930803575,0.37830735074202515,0.3781508692331331,0.37797206270739986,0.37776200984887887,0.37745478676316524,0.3767566846695157,0.3758962844776481,0.37513800454676016,0.37446654968216586,0.37382654705116614,0.3734438691241035,0.3731044443591446,0.3728247680648133,0.3725211470011917,0.3721352472044571,0.37184915871437374,0.3716652536197489,0.3715411369616738,0.3714483648083964,0.3714339529775642)
minHPD=c(5.261881954978989e-05, 5.4584822089897795e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,5.261881954978989e-05,7.897943269357154e-05,0.0002228827333904219,0.0004250588074198745,0.00025783089169040426,5.261881954978989e-05,9.244846903964819e-05,5.261881954978989e-05,0.004632211495716359,0.007651275157369438,0.007368664876268662,0.00747768845667271,0.009119093635089245,0.016818919818507392,0.03794702474340433,0.04821140493667999,0.07044411778800358,0.07549880465443654,0.08557389764124433,0.09718749092180175,0.1275011362524536,0.14682514118827605,0.15637456748891604,0.16089937811868232,0.1782210370617212,0.18959560741206832,0.2401269878194799,0.2554237516186691,0.2708297259452424,0.2728869518065365,0.27174063266312565,0.2732900434213316,0.27702665532365056,0.27942380083996515,0.2787941242837737,0.2816356543939928,0.2805697751002304,0.28984908451079067,0.2889685951507655,0.28876620728209773,0.2905050030715015,0.2855940436052301,0.27632238272697,0.26551784785475124,0.2497680876500239,0.24654123929350544,0.2352295134316032,0.2260345757758753,0.21911275283228476,0.21351507520987095,0.21687618943489298,0.21351507520987095,0.21890966294193773,0.21898739701648007,0.22198976395815675,0.22187862466699884,0.22705613950608028,0.22585436596223252,0.22594214056189593,0.2259716003241277,0.22594214056189593,0.22704898958559805,0.22886103168509087,0.22886103168509087,0.22886103168509087,0.2292091178467516,0.22909009820239037,0.22913180984286727,0.22900905573464034,0.22909009820239037,0.22900905573464034,0.22887768351036192,0.22595839445403018,0.22391971673100208,0.22276187153187604,0.22151552004467806,0.2217011659286832,0.21972918145911627,0.21890966294193773,0.2190365616846607,0.21906701295866501,0.21861890381839805,0.2169424757407039,0.2169696165100358,0.21364792987281056,0.21351507520987095)
maxHPD=c(0.9358258840013385, 0.9198413752238968,0.9243997290185069,0.9287807589137875,0.9326922283104652,0.9380835017767327,0.9426211386263184,0.9472698485095307,0.9518260458194948,0.956242562874126,0.9610163332552004,0.963945834501119,0.9676804865532371,0.9706154630570952,0.9743179960655488,0.9780904966955627,0.9821693620212892,0.9843628214396628,0.987931260628721,0.9901128137563886,0.9921554990511641,0.9984331581436845,1.0028052461989208,1.0042237791726671,1.0046186215360684,1.0073503023096226,1.0155466808024591,1.033082219326179,1.0390676634961584,1.0552920737267215,1.0527524035664606,1.0555712231824,1.0594008065301812,1.079432729287102,1.0903264322333974,1.090412267390885,1.0842844964257525,1.0907022828675175,1.0903264322333974,1.1272017508120817,1.1241164651536706,1.1221189724091347,1.1103386683079628,1.0970332103605045,1.0907022828675175,1.0907022828675175,1.0907022828675175,1.0903264322333974,1.0957732486157437,1.1031021977184574,1.1237341669335157,1.1337477958317423,1.1368683553185963,1.13563307582888,1.1194813414467741,1.093150858043339,1.052067439542628,1.005632832454395,0.9626727890591124,0.8992306043135653,0.8209828137593965,0.7532900363384888,0.6826412974507234,0.6326842245917349,0.5986547625181297,0.5836046753042625,0.5703302998952309,0.5609948593603574,0.548201178027463,0.5440752750400061,0.5369472498236708,0.5333918541728953,0.5303719920907277,0.5279377458623539,0.5274896322832601,0.5280091342000004,0.5267960597722836,0.5257401597444467,0.5253949646102288,0.5248260169920932,0.5244430298526929,0.5239640923360623,0.5238399501266326,0.523422559187433,0.5233729294468314,0.5211782901964175,0.5201185943083095,0.5201815679807782,0.5200757699265838,0.5212845931849347,0.5199852657951965,0.5200310503076474,0.5215545228112558,0.5233438495881646,0.5244325068029759,0.5241523579692001,0.5260427019196173,0.5254751408239628,0.5260336289072255)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.250555190850456), xlim = c(-144.0,-96.646694), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-96.8858521111111, -97.36416833333332,-97.84248455555556,-98.32080077777778,-98.799117,-99.27743322222221,-99.75574944444445,-100.23406566666667,-100.71238188888888,-101.1906981111111,-101.66901433333334,-102.14733055555556,-102.62564677777777,-103.103963,-103.58227922222223,-104.06059544444444,-104.53891166666666,-105.01722788888888,-105.49554411111112,-105.97386033333333,-106.45217655555555,-106.93049277777777,-107.408809,-107.88712522222222,-108.36544144444444,-108.84375766666666,-109.32207388888888,-109.80039011111111,-110.27870633333333,-110.75702255555555,-111.23533877777778,-111.713655,-112.19197122222222,-112.67028744444444,-113.14860366666666,-113.62691988888889,-114.10523611111111,-114.58355233333333,-115.06186855555556,-115.54018477777778,-116.018501,-116.49681722222222,-116.97513344444444,-117.45344966666667,-117.93176588888889,-118.41008211111111,-118.88839833333334,-119.36671455555556,-119.84503077777778,-120.323347,-120.80166322222222,-121.27997944444444,-121.75829566666667,-122.23661188888889,-122.7149281111111,-123.19324433333334,-123.67156055555556,-124.14987677777778,-124.628193,-125.10650922222221,-125.58482544444445,-126.06314166666667,-126.54145788888889,-127.01977411111112,-127.49809033333334,-127.97640655555556,-128.45472277777776,-128.933039,-129.4113552222222,-129.88967144444445,-130.36798766666664,-130.84630388888888,-131.32462011111113,-131.80293633333332,-132.28125255555557,-132.75956877777776,-133.237885,-133.7162012222222,-134.19451744444444,-134.6728336666667,-135.15114988888888,-135.62946611111113,-136.10778233333332,-136.58609855555557,-137.06441477777776,-137.542731,-138.0210472222222,-138.49936344444444,-138.9776796666667,-139.45599588888888,-139.93431211111113,-140.41262833333332,-140.89094455555556,-141.36926077777775,-141.847577,-142.3258932222222,-142.80420944444444,-143.2825256666667,-143.76084188888888)
counts=c(0.01753, 0.00736,0.00743,0.00804,0.00827,0.00817,0.00767,0.00872,0.00835,0.00857,0.0085,0.00854,0.00852,0.00854,0.0086,0.00824,0.00827,0.00804,0.00885,0.00856,0.00854,0.00849,0.00856,0.00876,0.00834,0.00843,0.00847,0.00857,0.00798,0.00771,0.00728,0.0068,0.00705,0.00656,0.00619,0.00653,0.0066,0.00679,0.00673,0.00754,0.00812,0.00769,0.00697,0.00684,0.00651,0.00586,0.00609,0.00682,0.00727,0.00834,0.00748,0.00554,0.00775,0.01581,0.02456,0.03872,0.03893,0.04473,0.05082,0.05276,0.04263,0.03707,0.02512,0.01681,0.01217,0.01093,0.01034,0.01136,0.00968,0.00669,0.00514,0.00456,0.0041,0.00359,0.00324,0.00335,0.00293,0.00236,0.00227,0.00262,0.00218,0.00243,0.00341,0.00462,0.0052,0.00549,0.00444,0.00409,0.00316,0.00286,0.0029,0.00308,0.00328,0.00264,0.00242,0.00324,0.00306,0.0,0.0)
plot(mids,counts,type = 'h', xlim = c(-144.0,-96.646694), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-96.885121185, -97.36197555499999,-97.838829925,-98.31568429500001,-98.792538665,-99.26939303500001,-99.74624740499999,-100.223101775,-100.69995614499999,-101.176810515,-101.65366488500001,-102.130519255,-102.60737362500001,-103.08422799499999,-103.561082365,-104.03793673499999,-104.514791105,-104.99164547499998,-105.468499845,-105.94535421500001,-106.42220858499999,-106.899062955,-107.37591732499999,-107.852771695,-108.32962606499999,-108.806480435,-109.28333480500001,-109.760189175,-110.237043545,-110.71389791499999,-111.190752285,-111.66760665499999,-112.144461025,-112.62131539500001,-113.098169765,-113.575024135,-114.05187850499999,-114.528732875,-115.00558724499999,-115.482441615,-115.95929598500001,-116.436150355,-116.91300472500001,-117.38985909499999,-117.866713465,-118.34356783499999,-118.820422205,-119.29727657500001,-119.774130945,-120.25098531500001,-120.72783968499999,-121.204694055,-121.68154842499999,-122.158402795,-122.63525716500001,-123.112111535,-123.58896590500001,-124.065820275,-124.542674645,-125.01952901499999,-125.496383385,-125.97323775500001,-126.450092125,-126.92694649500001,-127.403800865,-127.880655235,-128.357509605,-128.834363975,-129.311218345,-129.788072715,-130.26492708499998,-130.741781455,-131.218635825,-131.695490195,-132.172344565,-132.649198935,-133.126053305,-133.602907675,-134.079762045,-134.55661641499998,-135.033470785,-135.510325155,-135.987179525,-136.464033895,-136.94088826499998,-137.417742635,-137.894597005,-138.371451375,-138.848305745,-139.325160115,-139.802014485,-140.278868855,-140.755723225,-141.23257759499998,-141.709431965,-142.186286335,-142.663140705,-143.139995075,-143.61684944499999)
net_rate=c(-0.01668224339394541, -0.013182507142704806,-0.01619976357019419,-0.01981261810624561,-0.02355837421059627,-0.027708876675198824,-0.03206575494534598,-0.03609493487728172,-0.040302922681937234,-0.04434023418660885,-0.04843018152647014,-0.05245989188658486,-0.05659782957039668,-0.06090840523676087,-0.06539025994502098,-0.06995867502235148,-0.07402254384937548,-0.07807185401530234,-0.08186442593241701,-0.08585007778323728,-0.08943792241889945,-0.09334850032460233,-0.09723933875638559,-0.1011688105470199,-0.10470327414859087,-0.1082678137377526,-0.11235850616142606,-0.11578922415456394,-0.11905297354700271,-0.1219120314619835,-0.12454344955693677,-0.126871239155429,-0.12895697734470374,-0.13083381547360376,-0.13251136962957874,-0.13416330727751669,-0.1353750661711564,-0.13708124317319967,-0.13825641005445952,-0.13978643732840812,-0.14134255577189267,-0.1430886266919664,-0.14394805239728156,-0.14422285423618775,-0.14426938587970398,-0.143195910177964,-0.14151395804021913,-0.1402179997064344,-0.1393955052210618,-0.138986733589104,-0.13996932431123468,-0.14043576920102396,-0.13644339641830333,-0.13331531399803936,-0.12459212277467477,-0.11743568882107067,-0.10177542362148534,-0.1007398635642604,-0.09723331067179791,-0.07906017167837594,-0.05527213235064861,-0.03967511475752156,-0.02993993656786869,-0.024603232517391462,-0.02183622681328325,-0.020762627218605483,-0.019552197296630942,-0.018065451049099793,-0.015572819859176065,-0.01340378896668306,-0.012383182768979005,-0.011905898208913746,-0.011546934280205779,-0.011205103479151523,-0.010988108184744461,-0.010844615665567565,-0.010784785856281362,-0.010672655150156779,-0.0106081795193272,-0.01058039128056849,-0.010525579094138534,-0.010461522125042162,-0.010361678557570034,-0.01008104874365878,-0.009309798949902652,-0.008186513598308928,-0.007152726523473751,-0.006144688640021101,-0.005311974616822264,-0.004607523312028314,-0.004027954382238891,-0.003431590250892506,-0.0026791832276691287,-0.0015448417676853566,1.0601020389863233e-05,0.0020030924086252354,0.003880210417882795,0.007535428326202593,0.008557467041507102)
net_minHPD=c(-0.7203256661319372, -0.7084460439682692,-0.7052025701153422,-0.7233396946898383,-0.7228882832905954,-0.7235840238068278,-0.7237179636875442,-0.743316711375618,-0.7345133205139818,-0.7477599166434115,-0.7567605582689487,-0.7477025641770381,-0.7454383083087519,-0.7455473689370196,-0.7483543180863259,-0.7465835105597584,-0.7438219033479806,-0.7701002262109884,-0.7698681876263613,-0.7555790431220328,-0.7471034312031801,-0.7556027100222868,-0.7455317697341659,-0.7452702868109295,-0.7401745229400571,-0.7554250698170735,-0.745499726319621,-0.734508809229004,-0.7237044360753392,-0.7235945925845912,-0.7233396946898383,-0.723200411154716,-0.7167219588149075,-0.7242318807280579,-0.7158151124099451,-0.720859821769783,-0.7167275484168262,-0.7126047277420287,-0.7083203282888518,-0.7257371763474463,-0.7324463935215497,-0.745499726319621,-0.7419811651660959,-0.7424996631163453,-0.7457366946769177,-0.7608502387736346,-0.745499726319621,-0.759963066893192,-0.7764004966367303,-0.7764004966367303,-0.8107439078394014,-0.8432952386786892,-0.8354366878516426,-0.8358320037579506,-0.8169237169152708,-0.8055771269630856,-0.7590809780264893,-0.7322978758768449,-0.6701424681444447,-0.6182555403971732,-0.5424398667244579,-0.476430847589647,-0.38431061157332624,-0.3077090559286586,-0.27944879164715364,-0.24966065327480086,-0.23943188034882945,-0.22327457785469917,-0.21060565752542346,-0.20678843051353646,-0.1986536845655275,-0.19285310319756938,-0.1903597871266688,-0.19030110979512788,-0.18886028110798658,-0.18896085293707432,-0.1887225265204467,-0.1887225265204467,-0.1886727800552345,-0.18456577155279055,-0.18484813530269806,-0.1822434227933546,-0.1822434227933546,-0.1813249903519304,-0.18118411395807726,-0.18081254570135297,-0.1804830928511993,-0.1804984595384973,-0.17897137563633575,-0.1780237586531513,-0.17927069799027134,-0.18048239008497158,-0.18069130973541409,-0.18199848088173026,-0.18081254570135297,-0.18956524753238352,-0.19051316600615287,-0.19032710880583387,-0.19335071203634793)
net_maxHPD=c(0.6607095413221251, 0.6305611667548112,0.6367982976846887,0.6170369234301167,0.6169866617745404,0.6151304249355429,0.6136150479166851,0.5962375280056983,0.6008470982378615,0.5842675250043834,0.5703033222539426,0.5703033222539426,0.5673668137878971,0.560373174993737,0.5484744114171787,0.5444372019575328,0.5415975749882256,0.5097677058159967,0.49977807025999077,0.5033963097021881,0.49977807025999077,0.4789503263742012,0.4779962408884892,0.4684867232669086,0.46200349086822623,0.43639295775825715,0.43243615921393935,0.4329583540017938,0.4282766197943594,0.41596557065317374,0.4027531557281263,0.3897650432796112,0.38525906563337986,0.36504853731253806,0.36504853731253806,0.3523916703357597,0.3463476720156695,0.3449398392410574,0.3449398392410574,0.3259137424355244,0.31628727921506633,0.3048625476766036,0.310947263183612,0.31465746310632986,0.3190273097638873,0.31890202872316187,0.35067700583338723,0.35310442505008255,0.36166045101515787,0.39924592129820824,0.41071128136175755,0.43472395034109235,0.47217594444839905,0.46863121013436226,0.46920573495203033,0.4364682293629485,0.42979454540924916,0.35705457160871423,0.2975771110630839,0.2677129810995544,0.26821744901327393,0.26255283222708486,0.24962880783678731,0.23539269201393745,0.21189815968106207,0.2049889668883303,0.19192375193257094,0.18703402387981477,0.1806970464396321,0.17160862075656247,0.17160862075656247,0.17101492871398838,0.16930902332080378,0.16644343813002854,0.165655059459473,0.16373354779817983,0.16262064019389716,0.16149989914374063,0.1605789130789635,0.16457758814574408,0.16390344582089506,0.16607462358132952,0.16550268393474055,0.16584471240772225,0.16565561062820247,0.1657021138835692,0.16636193972637076,0.1666065346636641,0.16921177359609746,0.17141400422014083,0.17141400422014083,0.171512273447408,0.17353158359820478,0.17605053483019747,0.18303275832687077,0.18151293576218724,0.18877755214321318,0.20305937649196482,0.20315380381539597)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-0.9276247625465581, 0.7267804954543376), xlim = c(-144.0,-96.646694), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-96.885121185, -97.36197555499999,-97.838829925,-98.31568429500001,-98.792538665,-99.26939303500001,-99.74624740499999,-100.223101775,-100.69995614499999,-101.176810515,-101.65366488500001,-102.130519255,-102.60737362500001,-103.08422799499999,-103.561082365,-104.03793673499999,-104.514791105,-104.99164547499998,-105.468499845,-105.94535421500001,-106.42220858499999,-106.899062955,-107.37591732499999,-107.852771695,-108.32962606499999,-108.806480435,-109.28333480500001,-109.760189175,-110.237043545,-110.71389791499999,-111.190752285,-111.66760665499999,-112.144461025,-112.62131539500001,-113.098169765,-113.575024135,-114.05187850499999,-114.528732875,-115.00558724499999,-115.482441615,-115.95929598500001,-116.436150355,-116.91300472500001,-117.38985909499999,-117.866713465,-118.34356783499999,-118.820422205,-119.29727657500001,-119.774130945,-120.25098531500001,-120.72783968499999,-121.204694055,-121.68154842499999,-122.158402795,-122.63525716500001,-123.112111535,-123.58896590500001,-124.065820275,-124.542674645,-125.01952901499999,-125.496383385,-125.97323775500001,-126.450092125,-126.92694649500001,-127.403800865,-127.880655235,-128.357509605,-128.834363975,-129.311218345,-129.788072715,-130.26492708499998,-130.741781455,-131.218635825,-131.695490195,-132.172344565,-132.649198935,-133.126053305,-133.602907675,-134.079762045,-134.55661641499998,-135.033470785,-135.510325155,-135.987179525,-136.464033895,-136.94088826499998,-137.417742635,-137.894597005,-138.371451375,-138.848305745,-139.325160115,-139.802014485,-140.278868855,-140.755723225,-141.23257759499998,-141.709431965,-142.186286335,-142.663140705,-143.139995075,-143.61684944499999)
rate=c(2.1807322186062796, 2.2063200877069966,2.1906390310025103,2.1756202817815975,2.1594284557573165,2.1428470419410766,2.1263576627167993,2.110846719388785,2.095861864422446,2.082026001722414,2.0675580543919674,2.0537752673400953,2.0400491810475576,2.0252470956183,2.011039514049897,1.9973098213121079,1.9846047408604346,1.972362858464265,1.961484380543642,1.9497749960203115,1.9393375942436015,1.9294430943632848,1.9191063958199717,1.908652800343648,1.899506612491978,1.8899916178148028,1.880074017900776,1.8712966507211242,1.8632897670805613,1.8561907952741923,1.8498952574784124,1.844050451475895,1.8387106469574979,1.8334726867513127,1.8291648841990034,1.8240568702749707,1.819349486558118,1.812831528626259,1.8068834537750535,1.7989669810811362,1.7896347454425279,1.7778032884446087,1.7660761093052544,1.7562258270029147,1.7464678599107462,1.7368363037973762,1.7282867293411417,1.719840123892694,1.7091828776915592,1.695065875649447,1.6764679222539285,1.659991650017128,1.6568025442196332,1.66446737279728,1.6897732570384132,1.7281707511412747,1.7973629198124585,1.8698311530880234,1.9572425474282509,2.064909510206669,2.1886698972957013,2.2904194355998184,2.382371787171434,2.4472376303881087,2.4848641080116822,2.5105042711707286,2.530499675928649,2.549602859788715,2.5724501807910234,2.5922523221486125,2.6044981384444714,2.6122558981177426,2.618446810981097,2.623914165309194,2.6282577635896915,2.6316002093571496,2.634527029064999,2.637087539219531,2.6387986574561046,2.640227563840877,2.641495122210652,2.642820139625497,2.644161011373365,2.6466357734851904,2.6523119720683987,2.660341918606837,2.667793711251753,2.674587269659432,2.6800116870618145,2.6840567693850605,2.687354685340111,2.690378901407465,2.6938877925673035,2.6979350936910205,2.700524251842094,2.702412892894915,2.7031853766248934,2.70333786775028,2.703468472475625)
minHPD=c(2.1807322186062796, 2.2063200877069966,2.1906390310025103,2.1756202817815975,2.1594284557573165,2.1428470419410766,2.1263576627167993,2.110846719388785,2.095861864422446,2.082026001722414,2.0675580543919674,2.0537752673400953,2.0400491810475576,2.0252470956183,2.011039514049897,1.9973098213121079,1.9846047408604346,1.972362858464265,1.961484380543642,1.9497749960203115,1.9393375942436015,1.9294430943632848,1.9191063958199717,1.908652800343648,1.899506612491978,1.8899916178148028,1.880074017900776,1.8712966507211242,1.8632897670805613,1.8561907952741923,1.8498952574784124,1.844050451475895,1.8387106469574979,1.8334726867513127,1.8291648841990034,1.8240568702749707,1.819349486558118,1.812831528626259,1.8068834537750535,1.7989669810811362,1.7896347454425279,1.7778032884446087,1.7660761093052544,1.7562258270029147,1.7464678599107462,1.7368363037973762,1.7282867293411417,1.719840123892694,1.7091828776915592,1.695065875649447,1.6764679222539285,1.659991650017128,1.6568025442196332,1.66446737279728,1.6897732570384132,1.7281707511412747,1.7973629198124585,1.8698311530880234,1.9572425474282509,2.064909510206669,2.1886698972957013,2.2904194355998184,2.382371787171434,2.4472376303881087,2.4848641080116822,2.5105042711707286,2.530499675928649,2.549602859788715,2.5724501807910234,2.5922523221486125,2.6044981384444714,2.6122558981177426,2.618446810981097,2.623914165309194,2.6282577635896915,2.6316002093571496,2.634527029064999,2.637087539219531,2.6387986574561046,2.640227563840877,2.641495122210652,2.642820139625497,2.644161011373365,2.6466357734851904,2.6523119720683987,2.660341918606837,2.667793711251753,2.674587269659432,2.6800116870618145,2.6840567693850605,2.687354685340111,2.690378901407465,2.6938877925673035,2.6979350936910205,2.700524251842094,2.702412892894915,2.7031853766248934,2.70333786775028,2.703468472475625)
maxHPD=c(2.1807322186062796, 2.2063200877069966,2.1906390310025103,2.1756202817815975,2.1594284557573165,2.1428470419410766,2.1263576627167993,2.110846719388785,2.095861864422446,2.082026001722414,2.0675580543919674,2.0537752673400953,2.0400491810475576,2.0252470956183,2.011039514049897,1.9973098213121079,1.9846047408604346,1.972362858464265,1.961484380543642,1.9497749960203115,1.9393375942436015,1.9294430943632848,1.9191063958199717,1.908652800343648,1.899506612491978,1.8899916178148028,1.880074017900776,1.8712966507211242,1.8632897670805613,1.8561907952741923,1.8498952574784124,1.844050451475895,1.8387106469574979,1.8334726867513127,1.8291648841990034,1.8240568702749707,1.819349486558118,1.812831528626259,1.8068834537750535,1.7989669810811362,1.7896347454425279,1.7778032884446087,1.7660761093052544,1.7562258270029147,1.7464678599107462,1.7368363037973762,1.7282867293411417,1.719840123892694,1.7091828776915592,1.695065875649447,1.6764679222539285,1.659991650017128,1.6568025442196332,1.66446737279728,1.6897732570384132,1.7281707511412747,1.7973629198124585,1.8698311530880234,1.9572425474282509,2.064909510206669,2.1886698972957013,2.2904194355998184,2.382371787171434,2.4472376303881087,2.4848641080116822,2.5105042711707286,2.530499675928649,2.549602859788715,2.5724501807910234,2.5922523221486125,2.6044981384444714,2.6122558981177426,2.618446810981097,2.623914165309194,2.6282577635896915,2.6316002093571496,2.634527029064999,2.637087539219531,2.6387986574561046,2.640227563840877,2.641495122210652,2.642820139625497,2.644161011373365,2.6466357734851904,2.6523119720683987,2.660341918606837,2.667793711251753,2.674587269659432,2.6800116870618145,2.6840567693850605,2.687354685340111,2.690378901407465,2.6938877925673035,2.6979350936910205,2.700524251842094,2.702412892894915,2.7031853766248934,2.70333786775028,2.703468472475625)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 2.9738153197231876), xlim = c(-144.0,-96.646694), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()