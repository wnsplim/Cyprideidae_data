

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-111.67796214, -112.24618642000002,-112.8144107,-113.38263498,-113.95085926000002,-114.51908354,-115.08730782,-115.65553210000002,-116.22375638,-116.79198066000001,-117.36020493999999,-117.92842922,-118.49665350000001,-119.06487777999999,-119.63310206,-120.20132634000001,-120.76955061999999,-121.3377749,-121.90599918000001,-122.47422345999999,-123.04244774,-123.61067202000001,-124.17889629999999,-124.74712058,-125.31534486000001,-125.88356913999999,-126.45179342,-127.02001770000001,-127.58824197999999,-128.15646626,-128.72469054,-129.29291482000002,-129.8611391,-130.42936338,-130.99758766000002,-131.56581194,-132.13403622,-132.70226050000002,-133.27048478,-133.83870906,-134.40693334,-134.97515762,-135.5433819,-136.11160618,-136.67983046,-137.24805474000001,-137.81627902,-138.3845033,-138.95272758000002,-139.52095186,-140.08917614,-140.65740042000002,-141.2256247,-141.79384898,-142.36207326000002,-142.93029754,-143.49852182,-144.0667461,-144.63497038,-145.20319466,-145.77141894,-146.33964322,-146.9078675,-147.47609178,-148.04431606,-148.61254034,-149.18076462,-149.7489889,-150.31721318,-150.88543746,-151.45366174,-152.02188602,-152.5901103,-153.15833458,-153.72655886,-154.29478314,-154.86300742,-155.4312317,-155.99945598,-156.56768026,-157.13590454,-157.70412882,-158.2723531,-158.84057738,-159.40880166,-159.97702594,-160.54525022,-161.1134745,-161.68169878,-162.24992306000001,-162.81814734,-163.38637162,-163.95459590000002,-164.52282018,-165.09104446,-165.65926874000002,-166.22749302,-166.7957173,-167.36394158000002,-167.93216586)
rate=c(0.10790576896463777, 0.10761853791691625,0.10749881774783049,0.10743751544783575,0.10741780279734728,0.10740471155388587,0.10689091500254289,0.10658006617365642,0.10628888818776358,0.10614560708863502,0.10609609510212539,0.10634873890049526,0.10682502400657326,0.10760371392237372,0.10864347619172454,0.11041453642054296,0.11348656954106076,0.1193057541556658,0.13010855079090497,0.15095217022190818,0.1790408611909397,0.19538437815224702,0.1965008843409153,0.19662063798936893,0.19642837777279265,0.1963915137455831,0.1964422354900666,0.19660398492102937,0.19684737640213112,0.19735981521400972,0.1984120440409573,0.19950481676507933,0.20056621562046856,0.20180128637265665,0.20288574501114498,0.20417336580061723,0.2056718901491345,0.20638081555262106,0.2064929706030627,0.20650051446194312,0.2065785438674732,0.2068286117254251,0.2083151257914695,0.21550858621128471,0.21693457666353727,0.2168929798004186,0.21687222898817982,0.2168929798004186,0.21705821502545214,0.21767556537319355,0.21857398289033284,0.21982791236242313,0.22978825640212228,0.5735743714691504,0.6043028435603128,0.6040367913334843,0.6034532291318593,0.6029896180835883,0.6022013681615277,0.6014780260868678,0.6000417046494937,0.5982681738618418,0.5973758813713521,0.5955002826522942,0.5830888090340107,0.5693824547463215,0.5549029633161275,0.5403071195078815,0.5271405469330037,0.5161965757940018,0.5076871261295559,0.5011501432650378,0.4959854970169542,0.4924971225539857,0.49003251859926,0.4879742912780196,0.48650461103924625,0.4854698914918585,0.48475156167212236,0.4843160118878542,0.4842829996245047,0.4848589172559937,0.4856443510951576,0.487602664879106,0.4906919987034071,0.494924864699667,0.5014660366868415,0.5099741438762477,0.5194117506221498,0.5256826929237621,0.5299525149528352,0.533001814559893,0.5359025159599502,0.538751895077513,0.5411149477477788,0.5436779924901384,0.5459950530801791,0.5485601932624212,0.5509104020235185,0.5529455744171103)
minHPD=c(0.00202677755304118, 0.002478630444402553,0.0027471953872828967,0.0028673783940331415,0.0025898753550759324,0.0028742094620197315,0.0026524978266423927,0.0026806878664618655,0.002659722676953059,0.0029227031882361585,0.0024604022956742936,0.0024720906878367586,0.002478630444402553,0.0024720906878367586,0.0029227031882361585,0.0029227031882361585,0.002669921237785025,0.003650153544782677,0.004899341123400035,0.004981370699622016,0.010039515405571806,0.09036578103587721,0.09687752116875974,0.10266181160674336,0.10196914110839515,0.10321979167938172,0.10384870387048306,0.10375099450907158,0.10380310886863349,0.10442573868458803,0.10756495196582953,0.10701093303297325,0.1114565972159261,0.11465918614141718,0.11210359337480003,0.11306816624782391,0.11595306670655713,0.11942201069360979,0.11889536162353889,0.1178147654701844,0.11967373345275878,0.11919416937171141,0.11924133198185143,0.13290111163227622,0.13493889438358755,0.13471777256019116,0.13471130069247447,0.13486288119146184,0.13483746640254646,0.13454019091601405,0.13472929006284476,0.1362963907280021,0.13331594525415533,0.17536034164729825,0.32992340280715576,0.33036111543629526,0.33265096411116707,0.3326432548209081,0.33265096411116707,0.33077941596628896,0.3301811124067344,0.32769251146387746,0.31842473836099755,0.3093658947622056,0.20853352349559628,0.09784506122137324,0.07927571411860146,0.059443559251018824,0.05049755305561356,0.04186730221378318,0.036192133224140145,0.036767827118652716,0.034296048508803446,0.03537764167541803,0.030072693764830453,0.030020939219053116,0.030072693764830453,0.030035003377011447,0.030020939219053116,0.0297783823714786,0.030020939219053116,0.030020939219053116,0.030020939219053116,0.023596001323135586,0.023737478805854993,0.021831152181131262,0.015645799446788802,0.0026503239549575284,0.004494227794253154,0.007025760160828973,0.018634018476215115,0.01601839382324418,0.01613475962582758,0.02567132685212092,0.026715787589433566,0.024645863197756197,0.024976509865540692,0.028249972540017244,0.035511975540363803,0.04075511384985026)
maxHPD=c(0.21826518197226935, 0.2179381429855294,0.21773468915633673,0.21750217495449373,0.216905894842912,0.21689551501553578,0.216070471111047,0.21562462297234197,0.2152417263422987,0.2151669501413961,0.2144971417652698,0.2144034609017743,0.21434195097301212,0.214442306476304,0.2150073235911317,0.21536036314917537,0.21563997280520444,0.21775049401193985,0.2223257998946187,0.23392661590513497,0.26403636666643004,0.29202119172512725,0.28917999737591793,0.2916174935284319,0.2878900515383708,0.2882550826293656,0.28826098408898715,0.2878983515080807,0.2877015175483751,0.28827720254835393,0.2920935143410233,0.29297531629462015,0.2991959276052533,0.30500454095220664,0.3061605886318141,0.31382304814620143,0.3253597108408724,0.33430965349998476,0.33435400317292924,0.33435400317292924,0.33754645779808734,0.33978883635600643,0.3604379660114947,0.4445986441429612,0.4547269527392503,0.4542408052903053,0.45427155862461177,0.4552948238404739,0.45772858028358526,0.4637786512846485,0.4742353752446985,0.4916563639973669,0.5965655392728016,0.8452446927022231,0.87998935057782,0.874254542931748,0.874254542931748,0.8735749997292428,0.8741516566059042,0.8739545848805208,0.8786497188475022,0.8846321323732395,0.8824916346579329,0.8915133430341619,0.9177013025054251,0.8611767664619164,0.8469455503285293,0.8186567392338977,0.8021661864532431,0.7854782891928394,0.7732952670496231,0.7700604042092928,0.764962740613842,0.7645715220833346,0.7584022712318078,0.7580756932294738,0.7583511322051425,0.7585777044342219,0.7594343272853682,0.7604032924943347,0.7623542212492994,0.7655340050614472,0.7700604042092928,0.7709151981347184,0.7835763692078455,0.8021803658161324,0.8396794713616383,0.9740675483104623,1.2772743481487934,1.4820622402971282,1.6113766214904366,1.7005389154314814,1.7790568964659217,1.8579663088785499,1.914623109110924,1.9672027294873564,2.0120622340136176,2.064910778622043,2.1182620022158587,2.1564972229707218)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 2.372146945267794), xlim = c(-168.216278,-111.39385), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (combined_100_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-111.68083195959596, -112.25479587878787,-112.8287597979798,-113.40272371717171,-113.97668763636364,-114.55065155555555,-115.12461547474747,-115.6985793939394,-116.27254331313131,-116.84650723232323,-117.42047115151514,-117.99443507070707,-118.56839898989898,-119.1423629090909,-119.71632682828282,-120.29029074747474,-120.86425466666667,-121.43821858585858,-122.0121825050505,-122.58614642424241,-123.16011034343434,-123.73407426262625,-124.30803818181818,-124.88200210101009,-125.45596602020201,-126.02992993939394,-126.60389385858585,-127.17785777777777,-127.75182169696969,-128.32578561616162,-128.89974953535352,-129.47371345454548,-130.04767737373737,-130.62164129292927,-131.19560521212122,-131.76956913131312,-132.34353305050502,-132.91749696969697,-133.49146088888887,-134.06542480808082,-134.63938872727272,-135.2133526464646,-135.78731656565657,-136.36128048484846,-136.93524440404042,-137.50920832323231,-138.0831722424242,-138.65713616161617,-139.23110008080806,-139.80506400000002,-140.3790279191919,-140.9529918383838,-141.52695575757576,-142.10091967676766,-142.6748835959596,-143.2488475151515,-143.8228114343434,-144.39677535353536,-144.97073927272726,-145.5447031919192,-146.1186671111111,-146.692631030303,-147.26659494949496,-147.84055886868686,-148.41452278787875,-148.9884867070707,-149.5624506262626,-150.13641454545456,-150.71037846464645,-151.28434238383835,-151.8583063030303,-152.4322702222222,-153.00623414141415,-153.58019806060605,-154.15416197979795,-154.7281258989899,-155.3020898181818,-155.87605373737375,-156.45001765656565,-157.02398157575755,-157.5979454949495,-158.1719094141414,-158.7458733333333,-159.31983725252525,-159.89380117171714,-160.4677650909091,-161.041729010101,-161.6156929292929,-162.18965684848484,-162.76362076767674,-163.3375846868687,-163.9115486060606,-164.4855125252525,-165.05947644444444,-165.63344036363634,-166.2074042828283,-166.7813682020202,-167.3553321212121,-167.92929604040404)
counts=c(0.00286, 0.00247,0.00244,0.00214,0.00222,0.00294,0.00279,0.00265,0.00256,0.0022,0.00233,0.00246,0.00265,0.00336,0.00529,0.00807,0.01627,0.03233,0.09334,0.21622,0.10964,0.00924,0.00531,0.00438,0.00233,0.00243,0.00294,0.00346,0.0069,0.01226,0.01101,0.01121,0.01174,0.01137,0.01352,0.013,0.00579,0.00365,0.00277,0.00262,0.00531,0.03891,0.05123,0.00495,0.00319,0.00295,0.00331,0.00598,0.01238,0.01383,0.03332,0.41155,0.35982,0.02536,0.00472,0.00367,0.00404,0.00455,0.00527,0.00844,0.00698,0.00711,0.03281,0.04483,0.04352,0.04299,0.03748,0.02974,0.02282,0.01769,0.01421,0.0107,0.00852,0.00742,0.00666,0.00503,0.00489,0.00469,0.00531,0.00547,0.00587,0.00757,0.01078,0.01392,0.01748,0.02253,0.02479,0.01882,0.01462,0.01213,0.01083,0.01102,0.01002,0.01052,0.00988,0.0103,0.00967,0.00917,0.00569)
plot(mids,counts,type = 'h', xlim = c(-168.216278,-111.39385), ylim=c(0,0.41155), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.031948557862461126
bf6 = 0.19605144428198
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-111.67796214, -112.24618642000002,-112.8144107,-113.38263498,-113.95085926000002,-114.51908354,-115.08730782,-115.65553210000002,-116.22375638,-116.79198066000001,-117.36020493999999,-117.92842922,-118.49665350000001,-119.06487777999999,-119.63310206,-120.20132634000001,-120.76955061999999,-121.3377749,-121.90599918000001,-122.47422345999999,-123.04244774,-123.61067202000001,-124.17889629999999,-124.74712058,-125.31534486000001,-125.88356913999999,-126.45179342,-127.02001770000001,-127.58824197999999,-128.15646626,-128.72469054,-129.29291482000002,-129.8611391,-130.42936338,-130.99758766000002,-131.56581194,-132.13403622,-132.70226050000002,-133.27048478,-133.83870906,-134.40693334,-134.97515762,-135.5433819,-136.11160618,-136.67983046,-137.24805474000001,-137.81627902,-138.3845033,-138.95272758000002,-139.52095186,-140.08917614,-140.65740042000002,-141.2256247,-141.79384898,-142.36207326000002,-142.93029754,-143.49852182,-144.0667461,-144.63497038,-145.20319466,-145.77141894,-146.33964322,-146.9078675,-147.47609178,-148.04431606,-148.61254034,-149.18076462,-149.7489889,-150.31721318,-150.88543746,-151.45366174,-152.02188602,-152.5901103,-153.15833458,-153.72655886,-154.29478314,-154.86300742,-155.4312317,-155.99945598,-156.56768026,-157.13590454,-157.70412882,-158.2723531,-158.84057738,-159.40880166,-159.97702594,-160.54525022,-161.1134745,-161.68169878,-162.24992306000001,-162.81814734,-163.38637162,-163.95459590000002,-164.52282018,-165.09104446,-165.65926874000002,-166.22749302,-166.7957173,-167.36394158000002,-167.93216586)
rate=c(0.3159137060792023, 0.31443934362732184,0.31362281564041633,0.3127619764787042,0.3119345118315268,0.31095954230154493,0.31019401451261974,0.3094043354133007,0.30876200761188644,0.3076954867875854,0.3064745330289717,0.3042837067187996,0.30191594905788754,0.30004354524149063,0.29840342138153253,0.29692202154209263,0.2958739975129073,0.2935456245954954,0.2790730454828506,0.24195874071051904,0.21535137720952946,0.1902847437570767,0.1695769882676446,0.15874651240491136,0.15303836165443463,0.1488914488503783,0.1305063192781174,0.1186210637054943,0.11229457155471544,0.10709264093788731,0.10475022237879053,0.10400775766337078,0.10390052606464437,0.10413860161512256,0.10547482828503497,0.11150138863214748,0.14759275324634014,0.2786524056352955,0.31633449405742275,0.3256015284945398,0.33041638807662066,0.32671522511240275,0.31908307995640156,0.31895513721403435,0.31940472343353427,0.32126662330986056,0.32536539326342817,0.32897036075053576,0.3314758177938466,0.3331046676910261,0.3336390395967972,0.33377516340402413,0.33370717595608246,0.33362373437900855,0.3335220219160651,0.3329489671772793,0.325457698382851,0.32209908209914656,0.3200058817222228,0.3189638078139856,0.3184297808572407,0.31803830833537006,0.3178633585595822,0.31779914500175677,0.31772143436671274,0.31762749764546927,0.317475445834836,0.31721194697549016,0.3165422738998984,0.31556616141842053,0.3145783128852945,0.31356340756498774,0.3126802005644479,0.3118505311185037,0.3110535344596319,0.31033128289458867,0.30980879451495724,0.3094099157460021,0.30911019482985436,0.3089826161032927,0.30888757854400317,0.3088358811374451,0.30887843269220017,0.3090128310009462,0.30923778187380657,0.30964335723301095,0.3101999156753159,0.31105824528934856,0.3121833820592206,0.31335569078859005,0.314643581272284,0.31617500768166557,0.3176391126734741,0.31914545151143636,0.3206944519837005,0.3222432860412845,0.32388112842356287,0.32544895911880783,0.3272589185553457,0.3289035688956022)
minHPD=c(0.13155324189758189, 0.13095305454639963,0.13219284724559183,0.13219284724559183,0.13331769666953458,0.13293248186828102,0.13554910396286027,0.13259636606645522,0.1355269599354927,0.13434612205827787,0.13127428935536106,0.1249740032264934,0.12750926995549444,0.12289810100781216,0.12289810100781216,0.11837935326137354,0.11430068067907215,0.10317368806702533,0.06498494064273132,0.05093849031676519,0.04847797938536758,0.04344022565586247,0.04326549495211392,0.042714354986153474,0.04030764696194028,0.03990761347468375,0.02793855106931032,0.02090867550420933,0.009690392926759854,0.006813259527372723,0.001686872299497139,0.0003554774028815458,0.0003554774028815458,0.00025426420606482994,1.707055335462311e-05,1.707055335462311e-05,0.000534514489145582,0.01418425994233478,0.03713521299293403,0.06525382122271042,0.12813087458861203,0.003309442139650786,0.12143733019795468,0.1172319790292049,0.12739532261425007,0.14715917207730161,0.18140182499092042,0.19804777017849207,0.20724643688008332,0.21119669615513578,0.2118628131663884,0.2141039661266372,0.21512637221605418,0.21531805052428438,0.21347005797263408,0.21121256690254808,0.16255303558409842,0.12026593160513739,0.11121283093217961,0.10710441865129643,0.10708871110573952,0.10423883959831334,0.1037967153842863,0.10312777562371196,0.10203742334588195,0.09857161068036668,0.09842934445090147,0.09871485073439827,0.0948496872778438,0.09211591117804036,0.07940545488481132,0.07925428091108827,0.0750447127028653,0.06962547230608376,0.06840508613747957,0.0621708963969151,0.06263504148248938,0.058320976191994556,0.05621491289090464,0.05430216672991626,0.05421449615147272,0.049891820050970266,0.048424985983748454,0.048392061865753,0.04820859545361468,0.04734732704710294,0.036664595565582964,0.02490343745060805,0.014829267434367618,6.427118030893428e-06,6.427118030893428e-06,6.427118030893428e-06,4.528001693102968e-05,6.427118030893428e-06,6.427118030893428e-06,4.528001693102968e-05,0.000580249781290205,0.001569086700159406,0.005310006824924923,0.002187611708969818)
maxHPD=c(0.6835068388803459, 0.6682168802201561,0.6604007290624603,0.6534867334539026,0.6487320497315434,0.6438923466332167,0.6429331887534119,0.6375448357688012,0.637456948724781,0.634165957787074,0.6287895657089287,0.6191865910523826,0.6192319424534728,0.6145146179960973,0.6166276294734471,0.6162762123984294,0.6191241159706447,0.6191865910523826,0.5781075504091668,0.46650711015121427,0.40174817354599035,0.3569789033207152,0.3316653017081094,0.3211066504488664,0.31455219894790076,0.31268945313331553,0.30054155663058757,0.29089882669997774,0.27973068827483194,0.27710909919072235,0.2716341816616696,0.27028498953004226,0.2710954524608102,0.2734514003781603,0.280809264296215,0.31091026359949514,0.37066749217289097,0.4474028980308841,0.5658115064400832,0.6899359054993922,0.7489662359863303,0.5180044661051831,0.4973881472309115,0.48876149104792155,0.4915544625228149,0.48423031362227353,0.4720488959357983,0.46425716275773343,0.46414172531707104,0.4640672449055627,0.4640906783770033,0.46589852336977133,0.46625684765665193,0.4663698981459138,0.4649436294418899,0.464778459061886,0.48011646225699,0.45475832131305877,0.45027508299046914,0.4485551124033551,0.44950885286286324,0.446921313878702,0.446921313878702,0.446921313878702,0.446921313878702,0.4446429663286265,0.4454272215310378,0.4468201355093497,0.44544494851908334,0.446921313878702,0.43836598914668545,0.4415556346566377,0.44057562304273196,0.4382705485917859,0.4394630503131108,0.43609969277229266,0.4382705485917859,0.4361290619086236,0.4357743770719052,0.43563165565120715,0.4375533354365262,0.4356051215484417,0.43733957264380047,0.4410223084526498,0.445406740980554,0.45176108967281775,0.450674910664248,0.4541139156431057,0.46837711692846995,0.49760010883895395,0.6320699001881069,0.8558669969833829,1.0488603888098262,1.206205150618386,1.3480428102335922,1.4750342043324838,1.603462648563234,1.7073710274853287,1.8000003379856606,1.877127667249268)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 2.064840433974195), xlim = c(-168.216278,-111.39385), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-111.68083195959596, -112.25479587878787,-112.8287597979798,-113.40272371717171,-113.97668763636364,-114.55065155555555,-115.12461547474747,-115.6985793939394,-116.27254331313131,-116.84650723232323,-117.42047115151514,-117.99443507070707,-118.56839898989898,-119.1423629090909,-119.71632682828282,-120.29029074747474,-120.86425466666667,-121.43821858585858,-122.0121825050505,-122.58614642424241,-123.16011034343434,-123.73407426262625,-124.30803818181818,-124.88200210101009,-125.45596602020201,-126.02992993939394,-126.60389385858585,-127.17785777777777,-127.75182169696969,-128.32578561616162,-128.89974953535352,-129.47371345454548,-130.04767737373737,-130.62164129292927,-131.19560521212122,-131.76956913131312,-132.34353305050502,-132.91749696969697,-133.49146088888887,-134.06542480808082,-134.63938872727272,-135.2133526464646,-135.78731656565657,-136.36128048484846,-136.93524440404042,-137.50920832323231,-138.0831722424242,-138.65713616161617,-139.23110008080806,-139.80506400000002,-140.3790279191919,-140.9529918383838,-141.52695575757576,-142.10091967676766,-142.6748835959596,-143.2488475151515,-143.8228114343434,-144.39677535353536,-144.97073927272726,-145.5447031919192,-146.1186671111111,-146.692631030303,-147.26659494949496,-147.84055886868686,-148.41452278787875,-148.9884867070707,-149.5624506262626,-150.13641454545456,-150.71037846464645,-151.28434238383835,-151.8583063030303,-152.4322702222222,-153.00623414141415,-153.58019806060605,-154.15416197979795,-154.7281258989899,-155.3020898181818,-155.87605373737375,-156.45001765656565,-157.02398157575755,-157.5979454949495,-158.1719094141414,-158.7458733333333,-159.31983725252525,-159.89380117171714,-160.4677650909091,-161.041729010101,-161.6156929292929,-162.18965684848484,-162.76362076767674,-163.3375846868687,-163.9115486060606,-164.4855125252525,-165.05947644444444,-165.63344036363634,-166.2074042828283,-166.7813682020202,-167.3553321212121,-167.92929604040404)
counts=c(0.00784, 0.00602,0.00538,0.00541,0.00525,0.00556,0.00548,0.0052,0.00555,0.00723,0.00887,0.0093,0.00829,0.00791,0.00732,0.00896,0.01377,0.07963,0.15982,0.0947,0.07249,0.04846,0.02488,0.01427,0.01512,0.07135,0.04399,0.0344,0.02629,0.0121,0.00521,0.00463,0.00879,0.02468,0.07346,0.19471,0.30025,0.1029,0.06111,0.02277,0.06629,0.01735,0.00412,0.00808,0.0231,0.03505,0.02224,0.01789,0.00955,0.00347,0.00228,0.00184,0.00227,0.00224,0.03801,0.03569,0.01943,0.01164,0.00609,0.00429,0.00345,0.00287,0.0033,0.00339,0.00345,0.00367,0.00565,0.00816,0.00894,0.00874,0.00844,0.00762,0.00728,0.00656,0.00559,0.00536,0.00443,0.0042,0.00417,0.00425,0.00441,0.00489,0.00533,0.00617,0.00734,0.00876,0.0107,0.01216,0.01257,0.01446,0.01379,0.01403,0.01357,0.01392,0.01431,0.01422,0.01445,0.01336,0.00782)
plot(mids,counts,type = 'h', xlim = c(-168.216278,-111.39385), ylim=c(0,0.30025), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-111.67796214, -112.24618642000002,-112.8144107,-113.38263498,-113.95085926000002,-114.51908354,-115.08730782,-115.65553210000002,-116.22375638,-116.79198066000001,-117.36020493999999,-117.92842922,-118.49665350000001,-119.06487777999999,-119.63310206,-120.20132634000001,-120.76955061999999,-121.3377749,-121.90599918000001,-122.47422345999999,-123.04244774,-123.61067202000001,-124.17889629999999,-124.74712058,-125.31534486000001,-125.88356913999999,-126.45179342,-127.02001770000001,-127.58824197999999,-128.15646626,-128.72469054,-129.29291482000002,-129.8611391,-130.42936338,-130.99758766000002,-131.56581194,-132.13403622,-132.70226050000002,-133.27048478,-133.83870906,-134.40693334,-134.97515762,-135.5433819,-136.11160618,-136.67983046,-137.24805474000001,-137.81627902,-138.3845033,-138.95272758000002,-139.52095186,-140.08917614,-140.65740042000002,-141.2256247,-141.79384898,-142.36207326000002,-142.93029754,-143.49852182,-144.0667461,-144.63497038,-145.20319466,-145.77141894,-146.33964322,-146.9078675,-147.47609178,-148.04431606,-148.61254034,-149.18076462,-149.7489889,-150.31721318,-150.88543746,-151.45366174,-152.02188602,-152.5901103,-153.15833458,-153.72655886,-154.29478314,-154.86300742,-155.4312317,-155.99945598,-156.56768026,-157.13590454,-157.70412882,-158.2723531,-158.84057738,-159.40880166,-159.97702594,-160.54525022,-161.1134745,-161.68169878,-162.24992306000001,-162.81814734,-163.38637162,-163.95459590000002,-164.52282018,-165.09104446,-165.65926874000002,-166.22749302,-166.7957173,-167.36394158000002,-167.93216586)
net_rate=c(-0.2522112068939965, -0.24776573323883969,-0.24530306941322622,-0.24364728419852807,-0.24189988265329107,-0.2403639820313517,-0.23955236745699404,-0.23883198693213079,-0.2381048438379526,-0.2369864063399937,-0.23526718873919095,-0.23235348875379228,-0.22899268876487056,-0.2262172413415431,-0.2239464844380838,-0.222114936080241,-0.2206762869799622,-0.2171091702855102,-0.19274101511471595,-0.11652262583335263,-0.04667110608797754,0.005586892200663669,0.02137370502663398,0.027572994803025375,0.02953236888110217,0.031584939288009505,0.045219198034826734,0.05687920660523705,0.06444034151487775,0.0713531999575141,0.07575692674287583,0.07848174915458164,0.08017225273855494,0.08142117220526997,0.07990514697628558,0.07079000058904564,0.037789706723140665,-0.04979228743189875,-0.1087305366990741,-0.13374482201488666,-0.14806332621208354,-0.1268896101843977,-0.08839157435577143,-0.06841533463943582,-0.06541554024731107,-0.06943335650397646,-0.07921148852654863,-0.08673932816463055,-0.09117864567521983,-0.09229861170395776,-0.09008159062528137,-0.08522550540013632,-0.04904473412547284,0.21904432136383867,0.2700322063482009,0.27084553947663526,0.2861258768577763,0.2925983082695184,0.2955047255313413,0.2965917182883675,0.2954582883920394,0.29344744914463866,0.29308119842418723,0.29296079579025924,0.2709877545830749,0.24702300651402548,0.22361395565918585,0.20184960340948632,0.18563044266675244,0.17451320892620456,0.1669031657137227,0.16199352347581678,0.15870346535384333,0.15670563401371812,0.15574269484273223,0.15528938585432303,0.15517964451486455,0.15515481810957185,0.15550128535483881,0.1553912691859528,0.15600195574431963,0.15722022801658916,0.15886665729961993,0.16213728594772808,0.16840280771854899,0.17809024550542793,0.193529655421226,0.21534765356666127,0.24012454112246379,0.25223653970783294,0.2549779526374979,0.25183688322406417,0.24718538532088494,0.2427365735130577,0.23688867385718404,0.23088609601942467,0.22197655728801222,0.21623271147631368,0.2091755449788558,0.20219833878594323)
net_minHPD=c(-0.5977914295312671, -0.5796533146667031,-0.573250420311845,-0.5636240898516343,-0.5550448442711546,-0.5523343940873151,-0.5447118658674598,-0.5403048912295922,-0.5338727200433315,-0.5285956124688329,-0.5259389356202843,-0.5151876770047087,-0.5081781252049319,-0.5045260807691382,-0.5028170909528415,-0.4992415555239258,-0.49922335930695605,-0.5022645084195595,-0.4820046784573829,-0.35578351981485523,-0.27346523745180434,-0.20837090414015635,-0.17450473734100683,-0.15900835053951726,-0.15031738393222246,-0.1484390238272507,-0.1293254029819572,-0.11345940789054282,-0.10700765145436156,-0.10005663072535215,-0.09849920444146654,-0.09995976110233734,-0.1000468163935031,-0.10750003879960388,-0.11545315263248412,-0.15491678557073,-0.21534807257166322,-0.2907063371506848,-0.41750287846981643,-0.5197490030415408,-0.5574119902275634,-0.35299647379320115,-0.2730263179615814,-0.2645048973448851,-0.2599148525157369,-0.2672802476781636,-0.2734553638269037,-0.2766468894543297,-0.2866968871176516,-0.2866032914274308,-0.2908637357814179,-0.2895454263172371,-0.29086157506924715,-0.17698460218665527,-0.03762366788163718,-0.03706190171410301,-0.01721195191520608,-0.017072943476406255,-0.010781222032713034,-0.013053126461512077,-0.019124073284571497,-0.026063015912959175,-0.03375726213090208,-0.037685054675540675,-0.1078859108695698,-0.21283018583249416,-0.24062265814504882,-0.2698266425671636,-0.2632868824233201,-0.27729319609435993,-0.2774096174308204,-0.27762286763802596,-0.27762286763802596,-0.27743323771343537,-0.27741036646088535,-0.27762286763802596,-0.27762286763802596,-0.2777435899244903,-0.27771940314136634,-0.27771940314136634,-0.27775296752382367,-0.2847203375201949,-0.2927335279847775,-0.28912487453655017,-0.31140231709436816,-0.3155930823970996,-0.3444197643480846,-0.3993253025581814,-0.4304931819707757,-0.5603070133307998,-0.8193627199809512,-0.9504179160088115,-1.2123041932663718,-1.4331436738920313,-1.4665903982492001,-1.6240055148349248,-1.7310579085085895,-1.7431155871784911,-1.969061310710119,-1.9823090545147866)
net_maxHPD=c(0.034225754638995104, 0.029926529925914436,0.02270102792944917,0.02270102792944917,0.02270102792944917,0.01723156743733026,0.017027034114840134,0.015796095624740325,0.016325580028750758,0.015824048366560567,0.013798630367534342,0.017040596782251977,0.017307895083689906,0.01691123020090385,0.017307895083689906,0.022922292992836324,0.028155547520977764,0.035089495134758786,0.07646688022029122,0.13941749919411417,0.1678855628025065,0.18284313862205093,0.18697098516147612,0.18732988951793852,0.18808376002823377,0.18733046216412558,0.19682732332771546,0.20513875820852748,0.20835718616225246,0.2159332454772523,0.22069672919479658,0.22387098401156147,0.22976492425353778,0.23310666625372925,0.24385661534037958,0.2501031967565875,0.24749702589501013,0.22990624822635744,0.21221986082249084,0.17010387103240432,0.15143479251506942,0.20741696304074836,0.1608215172176772,0.1991134723071114,0.20871690165016954,0.19671635508146135,0.1783306160475677,0.16867028682877994,0.16114225632782664,0.17010863045227836,0.17988373470028818,0.1990694702468064,0.3057614782704679,0.5507432765561151,0.5764444185154679,0.5722649318277939,0.5971545449888745,0.6036496499928274,0.6149856569401518,0.6169917018840383,0.6170108536881334,0.6185332202698868,0.6185332202698868,0.6355404713717145,0.6581488736956667,0.6057121783315905,0.5866826777990294,0.5526450323223561,0.5497186637867377,0.5263896453530018,0.5191143410544898,0.5148804385610759,0.5128830774594142,0.5127275569880232,0.5127275569880232,0.513129835158084,0.5144830094387074,0.5171509563235461,0.5195658133547512,0.5227104113555042,0.5265517234223345,0.5275943764597675,0.5304937105664509,0.549746569627314,0.5555318201013801,0.6002705085645231,0.7030285835288744,1.0727962914911815,1.5892638129148227,1.9091684810602347,1.9903621475133348,2.165151878346392,2.165151878346392,2.1650264461108826,2.3068846656688877,2.3068846656688877,2.364486163553127,2.48928844981455,2.391180331778849,2.4665802298736628)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-2.1805399599662656, 2.7382172947960055), xlim = c(-168.216278,-111.39385), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-111.67796214, -112.24618642000002,-112.8144107,-113.38263498,-113.95085926000002,-114.51908354,-115.08730782,-115.65553210000002,-116.22375638,-116.79198066000001,-117.36020493999999,-117.92842922,-118.49665350000001,-119.06487777999999,-119.63310206,-120.20132634000001,-120.76955061999999,-121.3377749,-121.90599918000001,-122.47422345999999,-123.04244774,-123.61067202000001,-124.17889629999999,-124.74712058,-125.31534486000001,-125.88356913999999,-126.45179342,-127.02001770000001,-127.58824197999999,-128.15646626,-128.72469054,-129.29291482000002,-129.8611391,-130.42936338,-130.99758766000002,-131.56581194,-132.13403622,-132.70226050000002,-133.27048478,-133.83870906,-134.40693334,-134.97515762,-135.5433819,-136.11160618,-136.67983046,-137.24805474000001,-137.81627902,-138.3845033,-138.95272758000002,-139.52095186,-140.08917614,-140.65740042000002,-141.2256247,-141.79384898,-142.36207326000002,-142.93029754,-143.49852182,-144.0667461,-144.63497038,-145.20319466,-145.77141894,-146.33964322,-146.9078675,-147.47609178,-148.04431606,-148.61254034,-149.18076462,-149.7489889,-150.31721318,-150.88543746,-151.45366174,-152.02188602,-152.5901103,-153.15833458,-153.72655886,-154.29478314,-154.86300742,-155.4312317,-155.99945598,-156.56768026,-157.13590454,-157.70412882,-158.2723531,-158.84057738,-159.40880166,-159.97702594,-160.54525022,-161.1134745,-161.68169878,-162.24992306000001,-162.81814734,-163.38637162,-163.95459590000002,-164.52282018,-165.09104446,-165.65926874000002,-166.22749302,-166.7957173,-167.36394158000002,-167.93216586)
rate=c(2.7499018380220566, 2.7918745847863957,2.8149299772101877,2.831331083043483,2.847057994640447,2.8615858971768557,2.873221423556397,2.882877595949304,2.8918996682958324,2.903984298267137,2.92008341242948,2.9451579006243374,2.973840032785847,2.9966376103246675,3.014160455318296,3.0254361984111995,3.0291120829086995,3.0418150890877538,3.2371248397765515,4.065617556042296,4.691550645946555,5.200843386006085,5.601161500103564,5.821480119014909,5.93210630755784,6.017390154489536,6.55492736187112,7.088433667502864,7.4733703310716555,7.837347863411874,8.00586903231335,8.058379555239695,8.05081605356912,7.991669016691768,7.778599115565766,7.132605194683316,5.658149587645648,3.7590546815642494,3.081035238114562,2.8641260891145723,2.751023553422019,2.9174323162839397,3.247286646470401,3.2541397183896588,3.2449072919563737,3.2067647511787873,3.111874314498282,3.03960677807894,2.9933654859915193,2.9642679658047806,2.954569676094524,2.952990578553682,2.954241150360686,2.9555150839108153,2.9565342190540584,2.966412021008939,3.1145263807615415,3.184006212677563,3.223369246144186,3.2425966558448076,3.2517923014699397,3.2572674149476817,3.2593481500287105,3.2561960120125066,3.2513676172619808,3.2452155583044497,3.239963361018672,3.2441860832478033,3.2607541032394884,3.288509697365955,3.31281072436061,3.3383385677320425,3.360182402182152,3.3788591431840893,3.3951911162306074,3.409223303795887,3.418192287896214,3.4212340296763513,3.424121217137052,3.419096441661516,3.413533967288685,3.398891453143428,3.379634351231618,3.3528147067001806,3.3158793863762606,3.26636899649855,3.203625615138625,3.1144008788620723,3.006007915675037,2.888159415904664,2.7695594717105987,2.6448445685950226,2.531193428727859,2.4308531296942992,2.339071418712658,2.2512739093515703,2.160192935152953,2.0868511142317616,2.01376303970848,1.9532704864649097)
minHPD=c(2.7499018380220566, 2.7918745847863957,2.8149299772101877,2.831331083043483,2.847057994640447,2.8615858971768557,2.873221423556397,2.882877595949304,2.8918996682958324,2.903984298267137,2.92008341242948,2.9451579006243374,2.973840032785847,2.9966376103246675,3.014160455318296,3.0254361984111995,3.0291120829086995,3.0418150890877538,3.2371248397765515,4.065617556042296,4.691550645946555,5.200843386006085,5.601161500103564,5.821480119014909,5.93210630755784,6.017390154489536,6.55492736187112,7.088433667502864,7.4733703310716555,7.837347863411874,8.00586903231335,8.058379555239695,8.05081605356912,7.991669016691768,7.778599115565766,7.132605194683316,5.658149587645648,3.7590546815642494,3.081035238114562,2.8641260891145723,2.751023553422019,2.9174323162839397,3.247286646470401,3.2541397183896588,3.2449072919563737,3.2067647511787873,3.111874314498282,3.03960677807894,2.9933654859915193,2.9642679658047806,2.954569676094524,2.952990578553682,2.954241150360686,2.9555150839108153,2.9565342190540584,2.966412021008939,3.1145263807615415,3.184006212677563,3.223369246144186,3.2425966558448076,3.2517923014699397,3.2572674149476817,3.2593481500287105,3.2561960120125066,3.2513676172619808,3.2452155583044497,3.239963361018672,3.2441860832478033,3.2607541032394884,3.288509697365955,3.31281072436061,3.3383385677320425,3.360182402182152,3.3788591431840893,3.3951911162306074,3.409223303795887,3.418192287896214,3.4212340296763513,3.424121217137052,3.419096441661516,3.413533967288685,3.398891453143428,3.379634351231618,3.3528147067001806,3.3158793863762606,3.26636899649855,3.203625615138625,3.1144008788620723,3.006007915675037,2.888159415904664,2.7695594717105987,2.6448445685950226,2.531193428727859,2.4308531296942992,2.339071418712658,2.2512739093515703,2.160192935152953,2.0868511142317616,2.01376303970848,1.9532704864649097)
maxHPD=c(2.7499018380220566, 2.7918745847863957,2.8149299772101877,2.831331083043483,2.847057994640447,2.8615858971768557,2.873221423556397,2.882877595949304,2.8918996682958324,2.903984298267137,2.92008341242948,2.9451579006243374,2.973840032785847,2.9966376103246675,3.014160455318296,3.0254361984111995,3.0291120829086995,3.0418150890877538,3.2371248397765515,4.065617556042296,4.691550645946555,5.200843386006085,5.601161500103564,5.821480119014909,5.93210630755784,6.017390154489536,6.55492736187112,7.088433667502864,7.4733703310716555,7.837347863411874,8.00586903231335,8.058379555239695,8.05081605356912,7.991669016691768,7.778599115565766,7.132605194683316,5.658149587645648,3.7590546815642494,3.081035238114562,2.8641260891145723,2.751023553422019,2.9174323162839397,3.247286646470401,3.2541397183896588,3.2449072919563737,3.2067647511787873,3.111874314498282,3.03960677807894,2.9933654859915193,2.9642679658047806,2.954569676094524,2.952990578553682,2.954241150360686,2.9555150839108153,2.9565342190540584,2.966412021008939,3.1145263807615415,3.184006212677563,3.223369246144186,3.2425966558448076,3.2517923014699397,3.2572674149476817,3.2593481500287105,3.2561960120125066,3.2513676172619808,3.2452155583044497,3.239963361018672,3.2441860832478033,3.2607541032394884,3.288509697365955,3.31281072436061,3.3383385677320425,3.360182402182152,3.3788591431840893,3.3951911162306074,3.409223303795887,3.418192287896214,3.4212340296763513,3.424121217137052,3.419096441661516,3.413533967288685,3.398891453143428,3.379634351231618,3.3528147067001806,3.3158793863762606,3.26636899649855,3.203625615138625,3.1144008788620723,3.006007915675037,2.888159415904664,2.7695594717105987,2.6448445685950226,2.531193428727859,2.4308531296942992,2.339071418712658,2.2512739093515703,2.160192935152953,2.0868511142317616,2.01376303970848,1.9532704864649097)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 8.864217510763664), xlim = c(-168.216278,-111.39385), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()