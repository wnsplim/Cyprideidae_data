

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-96.824006725, -97.54148217500001,-98.25895762500001,-98.976433075,-99.69390852500001,-100.411383975,-101.128859425,-101.84633487500001,-102.563810325,-103.28128577500001,-103.99876122500001,-104.716236675,-105.43371212500001,-106.15118757500001,-106.868663025,-107.58613847500001,-108.30361392500001,-109.021089375,-109.73856482500001,-110.456040275,-111.17351572500002,-111.89099117500001,-112.608466625,-113.325942075,-114.04341752500001,-114.760892975,-115.47836842500001,-116.19584387500001,-116.913319325,-117.63079477500001,-118.34827022500001,-119.06574567500002,-119.78322112500001,-120.500696575,-121.218172025,-121.93564747500001,-122.653122925,-123.37059837500001,-124.08807382500001,-124.805549275,-125.52302472500001,-126.24050017500001,-126.95797562500002,-127.67545107500001,-128.392926525,-129.110401975,-129.82787742500003,-130.54535287500002,-131.26282832500002,-131.980303775,-132.697779225,-133.415254675,-134.132730125,-134.85020557500002,-135.567681025,-136.285156475,-137.002631925,-137.72010737500003,-138.43758282500002,-139.15505827500002,-139.872533725,-140.590009175,-141.307484625,-142.024960075,-142.74243552500002,-143.459910975,-144.177386425,-144.894861875,-145.61233732500003,-146.32981277500002,-147.04728822500002,-147.764763675,-148.482239125,-149.199714575,-149.917190025,-150.63466547500002,-151.35214092500001,-152.069616375,-152.787091825,-153.50456727500003,-154.22204272500002,-154.93951817500002,-155.656993625,-156.374469075,-157.091944525,-157.809419975,-158.52689542500002,-159.24437087500002,-159.961846325,-160.679321775,-161.39679722500003,-162.11427267500002,-162.83174812500002,-163.549223575,-164.266699025,-164.984174475,-165.701649925,-166.419125375,-167.13660082500002,-167.854076275)
rate=c(0.0522760350413585, 0.05191625637162098,0.051560543549523406,0.05127200611024664,0.05107633228866271,0.05094925876952246,0.05088704384102835,0.05084840839408561,0.05081728316787786,0.05082085566881438,0.05081335680075566,0.05082354275937345,0.05085335107143052,0.05089792467672835,0.051016436329257064,0.05123069103749517,0.051677495696272745,0.05255850283181235,0.05381359266976874,0.05508715468455558,0.05621078262627759,0.05729546379662606,0.05854179763279468,0.06001704823329378,0.062038470797794024,0.06451689149388853,0.0672947100176894,0.0699277811574498,0.07294931261894616,0.07744955978092619,0.08532891486516256,0.10054331193139263,0.12323071822822754,0.14427523135467013,0.1598399698119437,0.17089036188699086,0.1812452050185459,0.19654294096659974,0.20115514770856047,0.20106037616164402,0.199838061654463,0.19934537596068214,0.19916396930652303,0.1991299016513897,0.1991605774025999,0.199271485210615,0.19935057844751547,0.19950177762111276,0.19966868279150832,0.1998886650497871,0.20008905443385402,0.2000840812991694,0.20006496895886156,0.20022808114658952,0.201870723959227,0.2124750026960024,0.21367541864714587,0.21369371964376413,0.21383297812524457,0.21464818547243014,0.21738779569101288,0.22021512236421387,0.2653142825623944,0.5192959569967301,0.5297186740794055,0.5287449706980825,0.5259155063607213,0.5225503296176286,0.5212775815895061,0.519696909641752,0.5188086257523462,0.5156550530385268,0.5077116547773162,0.4984944946239337,0.49021917779901847,0.4833602780911911,0.4787121981135314,0.4754272025204146,0.4730726369930519,0.4717170024888574,0.4706142230086342,0.469825867306372,0.4692892885819846,0.4689759226857152,0.4689021994622752,0.4691969751241625,0.4698499952552999,0.47102524555258035,0.4727700052729684,0.47566382212589375,0.47977030286938993,0.4839966218846904,0.48669135093173665,0.488790086439043,0.49048663670078485,0.49219222217729464,0.4936894843437132,0.49512928014642554,0.4966635478182435,0.49825169858797325)
minHPD=c(0.0009456701154434624, 0.0009494715071979333,0.002001914734999191,0.001957021731288549,0.0009428117809614617,0.0022460537753575312,0.0009428117809614617,0.0009456701154434624,0.0009428117809614617,0.000942933811896807,0.0009428117809614617,0.0009428117809614617,0.0009428117809614617,0.0009428117809614617,0.0009428117809614617,0.0020129786056225004,0.002098194152481589,0.0009428117809614617,0.003012033060044613,0.0035216315507897054,0.0042340150326369945,0.006300150436583441,0.007635973096105377,0.008393812519995,0.010923947442615548,0.012632488791304223,0.014084302835571497,0.014318803603911533,0.016361129392661145,0.016358460733640313,0.017704688134670365,0.02006281536387947,0.021727978725048037,0.023272394981367715,0.027837474212163975,0.029789560145186043,0.033359506185062913,0.053451674869154,0.09251569832500794,0.09398800405564606,0.10185452402394787,0.10155554394907394,0.102432382160438,0.10111395878793533,0.10128337778883426,0.10143888093652038,0.10143888093652038,0.10115632499657973,0.10248850857305049,0.10185452402394787,0.10143888093652038,0.10251286947735054,0.10248850857305049,0.10248850857305049,0.1027680523394665,0.11985050234631191,0.1207718690981578,0.12061223052625228,0.11924330862980018,0.12256927067880317,0.12402380343321161,0.12371727250872486,0.12511292776131075,0.20793356848228456,0.25404332520625084,0.25404332520625084,0.2522728227562439,0.2518147918527809,0.2516556529266321,0.2511798499481613,0.24733455862192702,0.24417709974642263,0.22186345755359935,0.1802065850214296,0.1466969562001489,0.12265926855083287,0.11902214969831042,0.11273419389300834,0.11195149158225196,0.1117067694190441,0.11123992845078945,0.11020775759826723,0.09990206939426544,0.1063506333448912,0.10560735820392614,0.10143524861060166,0.09990206939426544,0.08901307929833094,0.08895929198198448,0.08493665213652665,0.07624047082732781,0.057715213616748876,0.05201542285215464,0.04453787218809381,0.043120524291414754,0.05841396078105425,0.054779761646939554,0.054779761646939554,0.055776153860762984,0.05640695322778561)
maxHPD=c(0.15890928224501316, 0.15354218179410783,0.14947340482909835,0.145808341247614,0.14223960101665226,0.1422326909127273,0.14006472659278674,0.1394720311904352,0.1391786394670853,0.1391509290934198,0.13911211373258406,0.13920068483152043,0.13944705825295184,0.13983522752444616,0.14057902794875482,0.1431596295010123,0.14648311423724,0.15155962953300448,0.161509898310493,0.16935702611034442,0.17552123753655066,0.1816789975710077,0.18718751789388924,0.19272820168851848,0.19974681478604847,0.20525020279664655,0.20986292713075627,0.2127044526960885,0.21736123533334628,0.22036850709064779,0.22541626819846355,0.231793623647132,0.23776385341916248,0.24428450743943655,0.25501585238670493,0.2645312702209393,0.2818004014046583,0.32488774343035953,0.33594490478542155,0.3307298619913459,0.32493482514579647,0.3202251010905255,0.3194489257851357,0.3176868528612281,0.31770626221729426,0.3176583728584672,0.31778378066351926,0.3176868528612281,0.3194489257851357,0.31951290181534087,0.3202474997525771,0.32279172659609906,0.32389046841456626,0.32557218206571753,0.33936267343752036,0.4292592878929433,0.43307526051773604,0.43307526051773604,0.43307526051773604,0.4414692404446119,0.4612281860528798,0.48094665340515297,0.6265886432566512,0.8074433119692367,0.8033311424441726,0.7991074398839633,0.7916159322222829,0.788727101659082,0.788727101659082,0.7898011380861505,0.7887220373943824,0.7986314606036613,0.810265148135961,0.8038492349079184,0.7803181159432857,0.758224714543902,0.7541544123434707,0.7481476225266036,0.7477639507049231,0.7481525011980592,0.7482373647356881,0.748123587827347,0.7391475349674748,0.7464093746090532,0.7481476225266036,0.7467954451569311,0.7506356421019892,0.748320735652417,0.7620635600891973,0.7811995343696772,0.8147661558417743,0.8662491492378387,0.9616592100102521,1.0683557952890776,1.16827667320462,1.285066246059885,1.3505157518353483,1.4113554863184545,1.4842900056017265,1.5518975963843948)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.7070873560228346), xlim = c(-168.212814,-96.465269), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (combined_100_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-96.82763033838384, -97.55235301515151,-98.27707569191921,-99.00179836868688,-99.72652104545455,-100.45124372222222,-101.17596639898991,-101.90068907575758,-102.62541175252525,-103.35013442929292,-104.07485710606062,-104.79957978282829,-105.52430245959596,-106.24902513636363,-106.97374781313133,-107.698470489899,-108.42319316666666,-109.14791584343433,-109.87263852020203,-110.5973611969697,-111.32208387373737,-112.04680655050507,-112.77152922727274,-113.4962519040404,-114.22097458080808,-114.94569725757577,-115.67041993434344,-116.39514261111111,-117.11986528787878,-117.84458796464648,-118.56931064141415,-119.29403331818182,-120.01875599494949,-120.74347867171718,-121.46820134848485,-122.19292402525252,-122.91764670202019,-123.64236937878789,-124.36709205555556,-125.09181473232323,-125.81653740909093,-126.5412600858586,-127.26598276262627,-127.99070543939393,-128.71542811616163,-129.4401507929293,-130.16487346969697,-130.88959614646467,-131.61431882323234,-132.3390415,-133.06376417676768,-133.78848685353535,-134.51320953030304,-135.2379322070707,-135.9626548838384,-136.68737756060608,-137.41210023737375,-138.13682291414142,-138.8615455909091,-139.5862682676768,-140.31099094444446,-141.03571362121212,-141.76043629797982,-142.4851589747475,-143.20988165151516,-143.93460432828283,-144.6593270050505,-145.3840496818182,-146.10877235858587,-146.83349503535354,-147.55821771212123,-148.2829403888889,-149.00766306565657,-149.73238574242424,-150.45710841919194,-151.1818310959596,-151.90655377272728,-152.63127644949498,-153.35599912626265,-154.08072180303031,-154.80544447979798,-155.53016715656565,-156.25488983333335,-156.97961251010102,-157.7043351868687,-158.4290578636364,-159.15378054040406,-159.87850321717173,-160.6032258939394,-161.32794857070706,-162.05267124747476,-162.77739392424243,-163.50211660101013,-164.2268392777778,-164.95156195454547,-165.67628463131314,-166.4010073080808,-167.12572998484848,-167.85045266161617)
counts=c(0.00785, 0.00826,0.00692,0.00517,0.0032,0.00213,0.00167,0.00114,0.0007,0.00078,0.00091,0.00114,0.00134,0.00261,0.00461,0.00923,0.01581,0.02013,0.01891,0.01634,0.01635,0.01864,0.02189,0.0266,0.02881,0.02856,0.02585,0.0284,0.03381,0.04112,0.04814,0.05537,0.06499,0.07228,0.06478,0.09906,0.12656,0.01478,0.01157,0.01187,0.00516,0.00259,0.00166,0.00194,0.00225,0.00229,0.00274,0.00297,0.00308,0.003,0.00265,0.00277,0.00607,0.06405,0.05457,0.00368,0.00356,0.00644,0.02115,0.02917,0.06869,0.51133,0.14361,0.0052,0.00663,0.01417,0.00578,0.00633,0.00521,0.00709,0.02479,0.0277,0.0272,0.02207,0.01604,0.01149,0.00852,0.00676,0.00482,0.00463,0.00434,0.00388,0.00427,0.00452,0.00527,0.00665,0.00838,0.01093,0.01464,0.01587,0.01129,0.00949,0.00901,0.00864,0.00826,0.00761,0.00785,0.00806,0.00523)
plot(mids,counts,type = 'h', xlim = c(-168.212814,-96.465269), ylim=c(0,0.51133), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03282882199853104
bf6 = 0.2005166131962391
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-96.824006725, -97.54148217500001,-98.25895762500001,-98.976433075,-99.69390852500001,-100.411383975,-101.128859425,-101.84633487500001,-102.563810325,-103.28128577500001,-103.99876122500001,-104.716236675,-105.43371212500001,-106.15118757500001,-106.868663025,-107.58613847500001,-108.30361392500001,-109.021089375,-109.73856482500001,-110.456040275,-111.17351572500002,-111.89099117500001,-112.608466625,-113.325942075,-114.04341752500001,-114.760892975,-115.47836842500001,-116.19584387500001,-116.913319325,-117.63079477500001,-118.34827022500001,-119.06574567500002,-119.78322112500001,-120.500696575,-121.218172025,-121.93564747500001,-122.653122925,-123.37059837500001,-124.08807382500001,-124.805549275,-125.52302472500001,-126.24050017500001,-126.95797562500002,-127.67545107500001,-128.392926525,-129.110401975,-129.82787742500003,-130.54535287500002,-131.26282832500002,-131.980303775,-132.697779225,-133.415254675,-134.132730125,-134.85020557500002,-135.567681025,-136.285156475,-137.002631925,-137.72010737500003,-138.43758282500002,-139.15505827500002,-139.872533725,-140.590009175,-141.307484625,-142.024960075,-142.74243552500002,-143.459910975,-144.177386425,-144.894861875,-145.61233732500003,-146.32981277500002,-147.04728822500002,-147.764763675,-148.482239125,-149.199714575,-149.917190025,-150.63466547500002,-151.35214092500001,-152.069616375,-152.787091825,-153.50456727500003,-154.22204272500002,-154.93951817500002,-155.656993625,-156.374469075,-157.091944525,-157.809419975,-158.52689542500002,-159.24437087500002,-159.961846325,-160.679321775,-161.39679722500003,-162.11427267500002,-162.83174812500002,-163.549223575,-164.266699025,-164.984174475,-165.701649925,-166.419125375,-167.13660082500002,-167.854076275)
rate=c(0.1654142641560129, 0.16437241992694146,0.1626773577719129,0.15923530249224516,0.1538802350444574,0.1481214848907747,0.14338942297235532,0.13896500576741905,0.135808582659733,0.13350559537127588,0.1313993705580041,0.12951694316348777,0.12803838709815257,0.12670313375149692,0.12584596922295554,0.1254212952306773,0.12524181318641506,0.12516868804134457,0.12514485826209,0.1251555099382724,0.1252176400751475,0.12530036065716876,0.12546806494910184,0.12582431396558416,0.12649809184457228,0.12797613255736992,0.13068079147315925,0.1346373370324277,0.13981832260654015,0.14446303697812865,0.1463355251438559,0.14756050170107515,0.1488144299297289,0.1501390757942761,0.15110670535059795,0.15135391123289138,0.15119260155053144,0.1511638063128105,0.15115938680727953,0.15118968884962894,0.15133315046793888,0.15159815280461703,0.1517402177205779,0.15199004886879347,0.15232447146755784,0.15290592121276758,0.15444717075088377,0.158298172660979,0.1705062620739349,0.2093763752422187,0.2508589508076209,0.2741744045043817,0.2847018339318952,0.28667296835890266,0.27680559261255716,0.2765626466855612,0.27713908004425525,0.2793928541544982,0.2825409043281633,0.2849032427409857,0.28596665976280333,0.2861378827920089,0.28620278261815135,0.28603633492298275,0.2857618990597229,0.27845777194305216,0.27613438309223437,0.2754291478628281,0.2751416397836074,0.27506466216200853,0.2750364504721544,0.2751189727578577,0.2752332381796281,0.27533699205080875,0.27533699205080875,0.2749708994387518,0.27433178865491903,0.2736271012761837,0.2730962209755552,0.27252349521523367,0.272062254155505,0.27169541756623916,0.27144236922125464,0.27128625823002894,0.2711810427195871,0.27121212320563626,0.2712763595993492,0.2713887942928639,0.2717356185122429,0.2721873630583559,0.27289172702438436,0.27396054130180275,0.2751112446724422,0.27642883878529334,0.27777718065326124,0.27915840414569104,0.2804832033988048,0.28188929094306703,0.2834340046548929,0.28506431290509726)
minHPD=c(0.0381644040079495, 0.036139682063003865,0.021894534522365828,0.013484804916350205,0.0034964263200391757,0.0023016168060241084,2.500929242838823e-05,0.0009349501215537049,2.500929242838823e-05,1.4469974281061222e-05,9.17988078490932e-06,0.0009436720606561712,0.0011734794908958843,0.0017265008949835126,0.0005408716406071602,0.0009786429041696858,0.0009686186515871167,0.0009802556192237699,0.0009786429041696858,0.0010044936474353115,0.0008377148910039873,0.0005408716406071602,0.0005408716406071602,0.0006080802220511995,0.0005408716406071602,0.0019327320410451386,0.0009205304277189242,0.009562205968006152,0.038804123542436994,0.07247441356766576,0.07962733781024622,0.08391294084664203,0.08405580678124464,0.08604227496083586,0.08686174445547094,0.08686520861919848,0.08687272588009008,0.08749854436670328,0.0870483822912881,0.08707010869636152,0.08695233726316882,0.0865221518552988,0.08736289982899878,0.0861376804400502,0.08534178934182904,0.08493974722198226,0.08448010861831518,0.08397452881839955,0.08399159067309793,0.08687772170598768,0.08750549693671163,0.08636552414136821,0.10411132468501012,0.1238107276312335,0.1414762732537163,0.14231938415252163,0.14207317834269168,0.15683363717118717,0.17064086088014488,0.1760407626333135,0.17770842140827334,0.17770842140827334,0.1777678504018109,0.17778690745236705,0.1776259863639046,0.15044901046925674,0.11892681625513936,0.11634343566848607,0.11573413615488405,0.11513869351313664,0.11513869351313664,0.1150945546939184,0.11513869351313664,0.10229530896823347,0.10234661707602885,0.10103487769307494,0.10032512017649789,0.09751285133631384,0.09126481315242689,0.08692958066529025,0.08349324544922535,0.0799101773133365,0.07662792500362052,0.07673657170378138,0.07668090159328256,0.06916442337429235,0.06913664398130588,0.06938663380666722,0.06279034287231353,0.05753479186055329,0.04745737970423708,0.034777953424519024,0.0041175734190209605,0.0007983823936907442,0.0003833832132959463,0.0003833832132959463,0.0003833832132959463,0.00711050724577424,0.0024469257491816893,0.008115405455389645)
maxHPD=c(1.272468868384217, 1.2591625388564278,1.2224964748557385,1.1507474859583813,0.9972391548758606,0.8385709897404728,0.6841863286745012,0.5206258338036873,0.4077353747249323,0.33041741897361177,0.26149914349098907,0.23215561475678761,0.22037091330342407,0.2129594241569541,0.20773044343425623,0.20602186317788698,0.2053465038341835,0.20528534394290565,0.2052339526081002,0.20533748382569533,0.2053465038341835,0.20546051055630302,0.20612726005841336,0.2080136390448735,0.21103269730373497,0.2187139890813902,0.22966665422533739,0.25181579580455515,0.2783342012543729,0.2850550213883703,0.28314361810505073,0.2834979249988772,0.28088874099409183,0.28121636338881245,0.28127759788657447,0.28090796324757905,0.2802742648228568,0.28088874099409183,0.28061740501574917,0.2808551238845167,0.28122102504909574,0.28156740222436366,0.2834096171238759,0.28340654603468435,0.28473114302881125,0.2869510530004194,0.2910906773864255,0.30275960001486174,0.325619538349493,0.3608151765015579,0.4127725273256773,0.574780524951174,0.7371654532802284,0.7208433225458322,0.4314991369766694,0.42722449475744634,0.42184736120207905,0.4173712151051994,0.4127969742471473,0.4101998870515018,0.4101998870515018,0.4100688967444892,0.4101701108900165,0.4101642536509012,0.4101998870515018,0.42883892469134904,0.4135628456819238,0.4127969742471473,0.4128896197607296,0.41261274989512964,0.41261274989512964,0.4130347173702279,0.41432826691098845,0.4023222593592634,0.403142898964506,0.4034435328683839,0.4053967894370087,0.4066406108021771,0.4038482165789903,0.4031344647837147,0.4023143518724859,0.4018055392481398,0.40033235407574336,0.4018290259761707,0.4038818815462062,0.399329668032634,0.4023222593592634,0.4065436599568683,0.40656628638380216,0.41159024705391223,0.41743983129809864,0.4327702007096596,0.45904098487281614,0.61892390614443,0.8493727744633172,1.0356148561580878,1.216575832242692,1.3662469965335595,1.4822685095238355,1.6080566948486927)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.7688623643335621), xlim = c(-168.212814,-96.465269), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-96.82763033838384, -97.55235301515151,-98.27707569191921,-99.00179836868688,-99.72652104545455,-100.45124372222222,-101.17596639898991,-101.90068907575758,-102.62541175252525,-103.35013442929292,-104.07485710606062,-104.79957978282829,-105.52430245959596,-106.24902513636363,-106.97374781313133,-107.698470489899,-108.42319316666666,-109.14791584343433,-109.87263852020203,-110.5973611969697,-111.32208387373737,-112.04680655050507,-112.77152922727274,-113.4962519040404,-114.22097458080808,-114.94569725757577,-115.67041993434344,-116.39514261111111,-117.11986528787878,-117.84458796464648,-118.56931064141415,-119.29403331818182,-120.01875599494949,-120.74347867171718,-121.46820134848485,-122.19292402525252,-122.91764670202019,-123.64236937878789,-124.36709205555556,-125.09181473232323,-125.81653740909093,-126.5412600858586,-127.26598276262627,-127.99070543939393,-128.71542811616163,-129.4401507929293,-130.16487346969697,-130.88959614646467,-131.61431882323234,-132.3390415,-133.06376417676768,-133.78848685353535,-134.51320953030304,-135.2379322070707,-135.9626548838384,-136.68737756060608,-137.41210023737375,-138.13682291414142,-138.8615455909091,-139.5862682676768,-140.31099094444446,-141.03571362121212,-141.76043629797982,-142.4851589747475,-143.20988165151516,-143.93460432828283,-144.6593270050505,-145.3840496818182,-146.10877235858587,-146.83349503535354,-147.55821771212123,-148.2829403888889,-149.00766306565657,-149.73238574242424,-150.45710841919194,-151.1818310959596,-151.90655377272728,-152.63127644949498,-153.35599912626265,-154.08072180303031,-154.80544447979798,-155.53016715656565,-156.25488983333335,-156.97961251010102,-157.7043351868687,-158.4290578636364,-159.15378054040406,-159.87850321717173,-160.6032258939394,-161.32794857070706,-162.05267124747476,-162.77739392424243,-163.50211660101013,-164.2268392777778,-164.95156195454547,-165.67628463131314,-166.4010073080808,-167.12572998484848,-167.85045266161617)
counts=c(0.0091, 0.01198,0.0227,0.03833,0.04543,0.04616,0.04578,0.0357,0.02772,0.02623,0.02196,0.0188,0.01645,0.01014,0.0057,0.00288,0.002,0.00139,0.00161,0.00162,0.00209,0.00329,0.00601,0.0103,0.02041,0.03567,0.04725,0.05481,0.03718,0.01483,0.01262,0.012,0.01082,0.00732,0.004,0.00314,0.00225,0.00232,0.00248,0.00357,0.00426,0.00465,0.00571,0.0079,0.01039,0.02104,0.04213,0.08539,0.15311,0.17759,0.09007,0.04976,0.06509,0.02347,0.00388,0.01133,0.02658,0.01918,0.01315,0.00404,0.00192,0.00233,0.0026,0.03307,0.0343,0.00831,0.00399,0.00242,0.00259,0.00309,0.00358,0.00383,0.00302,0.00439,0.00663,0.00653,0.00628,0.00584,0.00526,0.00494,0.00429,0.00356,0.00358,0.00377,0.0042,0.0045,0.00573,0.00745,0.00955,0.01237,0.01335,0.01366,0.01452,0.01436,0.01448,0.01379,0.0141,0.0145,0.00859)
plot(mids,counts,type = 'h', xlim = c(-168.212814,-96.465269), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-96.824006725, -97.54148217500001,-98.25895762500001,-98.976433075,-99.69390852500001,-100.411383975,-101.128859425,-101.84633487500001,-102.563810325,-103.28128577500001,-103.99876122500001,-104.716236675,-105.43371212500001,-106.15118757500001,-106.868663025,-107.58613847500001,-108.30361392500001,-109.021089375,-109.73856482500001,-110.456040275,-111.17351572500002,-111.89099117500001,-112.608466625,-113.325942075,-114.04341752500001,-114.760892975,-115.47836842500001,-116.19584387500001,-116.913319325,-117.63079477500001,-118.34827022500001,-119.06574567500002,-119.78322112500001,-120.500696575,-121.218172025,-121.93564747500001,-122.653122925,-123.37059837500001,-124.08807382500001,-124.805549275,-125.52302472500001,-126.24050017500001,-126.95797562500002,-127.67545107500001,-128.392926525,-129.110401975,-129.82787742500003,-130.54535287500002,-131.26282832500002,-131.980303775,-132.697779225,-133.415254675,-134.132730125,-134.85020557500002,-135.567681025,-136.285156475,-137.002631925,-137.72010737500003,-138.43758282500002,-139.15505827500002,-139.872533725,-140.590009175,-141.307484625,-142.024960075,-142.74243552500002,-143.459910975,-144.177386425,-144.894861875,-145.61233732500003,-146.32981277500002,-147.04728822500002,-147.764763675,-148.482239125,-149.199714575,-149.917190025,-150.63466547500002,-151.35214092500001,-152.069616375,-152.787091825,-153.50456727500003,-154.22204272500002,-154.93951817500002,-155.656993625,-156.374469075,-157.091944525,-157.809419975,-158.52689542500002,-159.24437087500002,-159.961846325,-160.679321775,-161.39679722500003,-162.11427267500002,-162.83174812500002,-163.549223575,-164.266699025,-164.984174475,-165.701649925,-166.419125375,-167.13660082500002,-167.854076275)
net_rate=c(-0.2811627227273837, -0.2826685922187358,-0.28085767160061,-0.26516034270613525,-0.23066828378375118,-0.19311369481539034,-0.1592881624848988,-0.1266764584386395,-0.10666912939599517,-0.09314619224887699,-0.08221903528963365,-0.07446071247485776,-0.06904798838468876,-0.06459878913197813,-0.06198729729336837,-0.060371108669348444,-0.0589294702489144,-0.056783104425845575,-0.053940142234873395,-0.05113521367858165,-0.04882837587406999,-0.046713392827797955,-0.044358353219586824,-0.041939161583286984,-0.03944920975007744,-0.038254240388432476,-0.03968936988148007,-0.04444312490768681,-0.051422578202763886,-0.055922147043732794,-0.05301964485218381,-0.04767749556578764,-0.0412513682370726,-0.03329062921548576,-0.023288347945440123,-0.011873811032939273,0.0031625182199694238,0.03309251075694117,0.04550184218741977,0.044284661997885506,0.03757549561358342,0.03531932516203321,0.034529227552166517,0.03409701681170493,0.03370427052486041,0.03312347066817565,0.031252666046946556,0.026661667402663784,0.016126268859869432,-0.00722544849219844,-0.053166611890653324,-0.0927196197409668,-0.11936486055078831,-0.11985540917752222,-0.06577948554757654,-0.0384381724327382,-0.03663101797985459,-0.04108112735978608,-0.04702540287929996,-0.049089960528994246,-0.043795740912708776,-0.0365861788400511,0.03148302644845238,0.2274883981631244,0.2432548171207034,0.256458356148946,0.256461352549523,0.2529305563797243,0.251760882764218,0.24998664635779771,0.249236997345077,0.24512602353729934,0.2320667874508624,0.21805705869207662,0.20586985753259526,0.19875748185585718,0.19478631196303584,0.19242802794801667,0.1908967087760345,0.1904317156204957,0.1900696033035158,0.18987298818192652,0.18992498274858807,0.19007323250073685,0.19029068797875562,0.190945257285604,0.19219709155098375,0.1946973730041136,0.19928187252924057,0.20550970633607793,0.2163765249496054,0.22309521699450305,0.2212589636997839,0.21499868953782952,0.20617501866796145,0.19844221263083342,0.18965800260750565,0.18016789681731862,0.17101783203516946,0.1618164628083688)
net_minHPD=c(-1.4279019721008401, -1.3498109554906823,-1.2602486273471631,-1.1487869522672935,-0.9782812826177194,-0.8113103063750763,-0.6544323587939673,-0.4889295928654787,-0.3764887711129459,-0.30348558451018237,-0.2356070486871664,-0.19720253022659717,-0.18595747545055413,-0.17339877632677372,-0.17102200048559166,-0.16780297738052594,-0.16745682045931864,-0.16780297738052594,-0.16776499897444966,-0.17249906349994432,-0.17452015677901972,-0.17447618602413154,-0.1741424591920519,-0.1717252052719388,-0.16703868671953204,-0.17199435496594057,-0.17446416214674,-0.19310660328790302,-0.20775567666699996,-0.2073531741193434,-0.2050785952303272,-0.19714029509121075,-0.19421394223237737,-0.19072863984977018,-0.18582342683730071,-0.17584314229522996,-0.1620747593219552,-0.1351687838620153,-0.13014265298527194,-0.12682926566433167,-0.1265526236886956,-0.12129407797389813,-0.11975536090917532,-0.12352816716574122,-0.124060360427353,-0.12669986090791868,-0.12688598651346225,-0.13566212145782533,-0.15425809372585897,-0.1949198517974523,-0.2471010279763574,-0.3928977405057268,-0.5517106853955605,-0.5313750886154058,-0.24742487218326162,-0.22489630651282894,-0.2200863403194101,-0.2263697686485955,-0.2292799700989654,-0.23371937006548957,-0.23371937006548957,-0.23221233063223579,-0.2276819854119413,-0.10685500497554129,-0.06987334414275986,-0.05348412940330016,-0.04782414079135855,-0.04782414079135855,-0.05261202657242209,-0.04988681712804682,-0.057866188865756896,-0.06726295484722616,-0.08524002054992763,-0.11494194795922821,-0.13481261025042282,-0.14535232825634814,-0.15003617111015036,-0.1609908665622108,-0.16480787702708077,-0.15917226688204567,-0.16622375244276327,-0.15921724528077666,-0.1584824933672862,-0.15934556593496252,-0.16447182620162662,-0.17409472070413418,-0.1731345143300565,-0.17910249133450715,-0.19439625433286156,-0.21700664780786316,-0.2894948061099749,-0.3635946819912038,-0.5710872686632532,-0.7995617944191766,-1.0549185839475546,-1.2793100427327044,-1.3486983521359388,-1.5825010866296607,-1.711232828601677,-1.7475556637381853)
net_maxHPD=c(0.07780939204317494, 0.0778596888828555,0.07752406728559114,0.07013836581343787,0.07071223137817698,0.06749445177630085,0.07030039066294676,0.07014901066521709,0.07270198119611597,0.07034674803984305,0.07201866731814223,0.06975828687339422,0.06044601494757292,0.06035843114296528,0.05719334062620132,0.05803377625085272,0.05884027375537755,0.06258352514360825,0.07062449362902785,0.07649595328559577,0.08591557562709216,0.09802134198848203,0.1116814199444476,0.12634820388948464,0.1435967324629505,0.1494031741450685,0.15580413043857164,0.1399649410219674,0.11525771397116603,0.10412697628827473,0.10447801466420682,0.11483279481336084,0.12169727028472663,0.1279549653889167,0.13747251483358153,0.15215560842767195,0.16658755851900692,0.19763934882761106,0.21029566197035623,0.20794968467600147,0.19047807946646772,0.1903136553953959,0.1902453238290059,0.18690098667408933,0.1874315379319883,0.18690098667408933,0.1903184502216759,0.1906919221884408,0.19093842048386325,0.18076623609311523,0.1848112387057732,0.19350991838804138,0.16009265939480813,0.15176937429967874,0.13214518550401216,0.20122364040818924,0.20810281650019558,0.19526990344081463,0.18663484491569926,0.18644969463343997,0.2082812920024958,0.22974434735266333,0.37439907874270195,0.5505724526329896,0.5578586492151795,0.5631814196757534,0.563290096314236,0.559298292543482,0.5548496289423068,0.5588244117100183,0.5526502965903141,0.5547481240769178,0.5589007167053237,0.5466728749318681,0.5324457092744748,0.5208945014617439,0.5134125722436371,0.5033518806580154,0.5012550619646454,0.50804218602747,0.5013693336813841,0.5100635936129851,0.5134125722436371,0.5140441895613741,0.5135245448765715,0.5100832336015626,0.5209775832414045,0.5324273272461666,0.5469910501133872,0.5798400858437656,0.6768588989845006,1.1087432736302678,1.4086186459725811,1.5847232179616848,1.6594186001244549,1.71045335027407,1.8743006776784288,1.8272269415245839,1.868151886418879,1.9957497525900716)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-1.922311230112004, 2.195324727849079), xlim = c(-168.212814,-96.465269), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-96.824006725, -97.54148217500001,-98.25895762500001,-98.976433075,-99.69390852500001,-100.411383975,-101.128859425,-101.84633487500001,-102.563810325,-103.28128577500001,-103.99876122500001,-104.716236675,-105.43371212500001,-106.15118757500001,-106.868663025,-107.58613847500001,-108.30361392500001,-109.021089375,-109.73856482500001,-110.456040275,-111.17351572500002,-111.89099117500001,-112.608466625,-113.325942075,-114.04341752500001,-114.760892975,-115.47836842500001,-116.19584387500001,-116.913319325,-117.63079477500001,-118.34827022500001,-119.06574567500002,-119.78322112500001,-120.500696575,-121.218172025,-121.93564747500001,-122.653122925,-123.37059837500001,-124.08807382500001,-124.805549275,-125.52302472500001,-126.24050017500001,-126.95797562500002,-127.67545107500001,-128.392926525,-129.110401975,-129.82787742500003,-130.54535287500002,-131.26282832500002,-131.980303775,-132.697779225,-133.415254675,-134.132730125,-134.85020557500002,-135.567681025,-136.285156475,-137.002631925,-137.72010737500003,-138.43758282500002,-139.15505827500002,-139.872533725,-140.590009175,-141.307484625,-142.024960075,-142.74243552500002,-143.459910975,-144.177386425,-144.894861875,-145.61233732500003,-146.32981277500002,-147.04728822500002,-147.764763675,-148.482239125,-149.199714575,-149.917190025,-150.63466547500002,-151.35214092500001,-152.069616375,-152.787091825,-153.50456727500003,-154.22204272500002,-154.93951817500002,-155.656993625,-156.374469075,-157.091944525,-157.809419975,-158.52689542500002,-159.24437087500002,-159.961846325,-160.679321775,-161.39679722500003,-162.11427267500002,-162.83174812500002,-163.549223575,-164.266699025,-164.984174475,-165.701649925,-166.419125375,-167.13660082500002,-167.854076275)
rate=c(2.757659573652282, 2.7936829576457005,2.859760340764913,3.036418217253861,3.4265952860301194,3.9568498622985047,4.584078998291449,5.399830361542829,6.057969899977485,6.599567209416631,7.113218640180632,7.528082721656737,7.8442764411475165,8.121237641202528,8.281021687451439,8.36010354568296,8.389854442118267,8.400443808706422,8.402969527109555,8.40125177486032,8.394608389768608,8.38254694909939,8.362172000473464,8.311722686131702,8.21554972522888,8.013925687058297,7.655472387725496,7.178562266958337,6.656627452884578,6.278398682917038,6.161027349420223,6.0937081886399795,6.026058692336959,5.955129500371728,5.898333347819796,5.895059709660825,5.927023985223498,5.931397100678018,5.932000813173698,5.930043352733829,5.922512994639166,5.911041692068848,5.903794211890233,5.891709115345434,5.876026073850166,5.849313513785862,5.780663017660883,5.6223041060857675,5.298908801035557,4.70686576733335,3.864024243091779,3.3524717932789234,3.0781362748640824,3.0706126070932958,3.631742501462955,3.645867759743927,3.633421603158098,3.5766949975377353,3.4963520655143236,3.4464399330836195,3.4238302624499273,3.4213447945852296,3.420191418322165,3.422457984006169,3.426471963545677,3.6070803352081633,3.660563269814436,3.6740348757553445,3.6790804768698933,3.679816731296828,3.678406135632851,3.664736715410338,3.6445592219607477,3.6270405008071487,3.6245026949269996,3.6462668681484973,3.6741714097014326,3.6963093333953987,3.711392106484563,3.7273505742693938,3.7392990127130563,3.7473792170147533,3.7508291249047496,3.7536407041641953,3.746613834276145,3.7284219768292552,3.705775742452964,3.673794158929573,3.620838487736367,3.539461642797191,3.424204403763249,3.2695085381127216,3.1099140790773965,2.9550918840102187,2.807557057800984,2.6812262179101762,2.5644936077389264,2.458250345866347,2.359399767413392,2.2669463752581165)
minHPD=c(2.757659573652282, 2.7936829576457005,2.859760340764913,3.036418217253861,3.4265952860301194,3.9568498622985047,4.584078998291449,5.399830361542829,6.057969899977485,6.599567209416631,7.113218640180632,7.528082721656737,7.8442764411475165,8.121237641202528,8.281021687451439,8.36010354568296,8.389854442118267,8.400443808706422,8.402969527109555,8.40125177486032,8.394608389768608,8.38254694909939,8.362172000473464,8.311722686131702,8.21554972522888,8.013925687058297,7.655472387725496,7.178562266958337,6.656627452884578,6.278398682917038,6.161027349420223,6.0937081886399795,6.026058692336959,5.955129500371728,5.898333347819796,5.895059709660825,5.927023985223498,5.931397100678018,5.932000813173698,5.930043352733829,5.922512994639166,5.911041692068848,5.903794211890233,5.891709115345434,5.876026073850166,5.849313513785862,5.780663017660883,5.6223041060857675,5.298908801035557,4.70686576733335,3.864024243091779,3.3524717932789234,3.0781362748640824,3.0706126070932958,3.631742501462955,3.645867759743927,3.633421603158098,3.5766949975377353,3.4963520655143236,3.4464399330836195,3.4238302624499273,3.4213447945852296,3.420191418322165,3.422457984006169,3.426471963545677,3.6070803352081633,3.660563269814436,3.6740348757553445,3.6790804768698933,3.679816731296828,3.678406135632851,3.664736715410338,3.6445592219607477,3.6270405008071487,3.6245026949269996,3.6462668681484973,3.6741714097014326,3.6963093333953987,3.711392106484563,3.7273505742693938,3.7392990127130563,3.7473792170147533,3.7508291249047496,3.7536407041641953,3.746613834276145,3.7284219768292552,3.705775742452964,3.673794158929573,3.620838487736367,3.539461642797191,3.424204403763249,3.2695085381127216,3.1099140790773965,2.9550918840102187,2.807557057800984,2.6812262179101762,2.5644936077389264,2.458250345866347,2.359399767413392,2.2669463752581165)
maxHPD=c(2.757659573652282, 2.7936829576457005,2.859760340764913,3.036418217253861,3.4265952860301194,3.9568498622985047,4.584078998291449,5.399830361542829,6.057969899977485,6.599567209416631,7.113218640180632,7.528082721656737,7.8442764411475165,8.121237641202528,8.281021687451439,8.36010354568296,8.389854442118267,8.400443808706422,8.402969527109555,8.40125177486032,8.394608389768608,8.38254694909939,8.362172000473464,8.311722686131702,8.21554972522888,8.013925687058297,7.655472387725496,7.178562266958337,6.656627452884578,6.278398682917038,6.161027349420223,6.0937081886399795,6.026058692336959,5.955129500371728,5.898333347819796,5.895059709660825,5.927023985223498,5.931397100678018,5.932000813173698,5.930043352733829,5.922512994639166,5.911041692068848,5.903794211890233,5.891709115345434,5.876026073850166,5.849313513785862,5.780663017660883,5.6223041060857675,5.298908801035557,4.70686576733335,3.864024243091779,3.3524717932789234,3.0781362748640824,3.0706126070932958,3.631742501462955,3.645867759743927,3.633421603158098,3.5766949975377353,3.4963520655143236,3.4464399330836195,3.4238302624499273,3.4213447945852296,3.420191418322165,3.422457984006169,3.426471963545677,3.6070803352081633,3.660563269814436,3.6740348757553445,3.6790804768698933,3.679816731296828,3.678406135632851,3.664736715410338,3.6445592219607477,3.6270405008071487,3.6245026949269996,3.6462668681484973,3.6741714097014326,3.6963093333953987,3.711392106484563,3.7273505742693938,3.7392990127130563,3.7473792170147533,3.7508291249047496,3.7536407041641953,3.746613834276145,3.7284219768292552,3.705775742452964,3.673794158929573,3.620838487736367,3.539461642797191,3.424204403763249,3.2695085381127216,3.1099140790773965,2.9550918840102187,2.807557057800984,2.6812262179101762,2.5644936077389264,2.458250345866347,2.359399767413392,2.2669463752581165)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 9.24326647982051), xlim = c(-168.212814,-96.465269), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()