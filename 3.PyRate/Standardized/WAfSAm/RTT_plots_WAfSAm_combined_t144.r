

pdf(file='./t144RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-97.23432351000001, -97.70982053,-98.18531755000001,-98.66081457,-99.13631159,-99.61180861,-100.08730563,-100.56280265000001,-101.03829967,-101.51379669,-101.98929371,-102.46479073,-102.94028775,-103.41578477,-103.89128179000001,-104.36677881,-104.84227583,-105.31777285,-105.79326987,-106.26876689000001,-106.74426391,-107.21976093,-107.69525795,-108.17075497,-108.64625199000001,-109.12174901,-109.59724603000001,-110.07274305,-110.54824007,-111.02373709,-111.49923411,-111.97473113,-112.45022815,-112.92572517,-113.40122219,-113.87671921,-114.35221623,-114.82771325,-115.30321027000001,-115.77870729,-116.25420431,-116.72970133,-117.20519835,-117.68069537000001,-118.15619239,-118.63168940999999,-119.10718643,-119.58268345,-120.05818047,-120.53367749,-121.00917451,-121.48467153,-121.96016855,-122.43566557,-122.91116259,-123.38665961,-123.86215663,-124.33765365000001,-124.81315067,-125.28864769,-125.76414471,-126.23964173,-126.71513875000001,-127.19063577,-127.66613278999999,-128.14162980999998,-128.61712683000002,-129.09262385,-129.56812086999997,-130.04361789,-130.51911490999998,-130.99461193000002,-131.47010895,-131.94560596999997,-132.42110299,-132.89660001,-133.37209703000002,-133.84759405,-134.32309106999998,-134.79858809,-135.27408511,-135.74958213000002,-136.22507915,-136.70057616999998,-137.17607319,-137.65157021,-138.12706723000002,-138.60256425,-139.07806126999998,-139.55355829,-140.02905531,-140.50455232999997,-140.98004935,-141.45554636999998,-141.93104339,-142.40654041,-142.88203742999997,-143.35753445,-143.83303146999998)
rate=c(0.3645135926511669, 0.36387971889445436,0.36375865902022353,0.36366998348837787,0.36347319733817446,0.3632984408922485,0.3631015291672115,0.3629828518206474,0.362841955885621,0.36265254436652455,0.36246518901606295,0.3623149594816358,0.3620891237968829,0.3619251711856444,0.36177767086105284,0.36163988535467656,0.361458757417947,0.36128787015112435,0.361084053080739,0.3610089484758949,0.3609044065543947,0.3607574560129999,0.3606416000857293,0.36044726372386615,0.36029583173908697,0.3601966300719438,0.36004590254578794,0.35989552602267766,0.35975530033241376,0.3596552528576379,0.3595687209882435,0.35953824210793683,0.35953237920936393,0.35953126269279,0.35957019796249706,0.35958876468167716,0.3596616466198491,0.3598165421985635,0.3599290446184193,0.36012851046542627,0.3604386724449339,0.36089586823679903,0.3613340987767216,0.36178511380012807,0.36237203688808717,0.3628331126815848,0.36329795978994295,0.3638511817872497,0.36431343485136913,0.36485036036681684,0.36520335548820226,0.36549949165647344,0.3652800664235813,0.3648494751170405,0.3638524375677209,0.3629976538343035,0.3614974010592952,0.35990456510934254,0.3590164799214538,0.35856489526867563,0.3581602004765536,0.3574805225703045,0.35683233135904346,0.3562216486509174,0.3557283282964852,0.3553321488789786,0.3550898843329019,0.3548962447688897,0.3547139910755644,0.35450479367549187,0.35433332240223137,0.3541641494798943,0.3539914185812238,0.35386270259055097,0.35375439866768454,0.35365556051173314,0.3534841320563612,0.3534086063828822,0.353326221885444,0.35324032365363905,0.3531554580663246,0.3531339260520131,0.35313561718292164,0.35310848195973615,0.3531083404492751,0.35314233777684145,0.3531539670138523,0.35319361007770356,0.35327439331042637,0.353376336408617,0.3534876209712874,0.3535716341629686,0.3537153916366388,0.3538812460653963,0.3541043463328934,0.35433332240223137,0.35470503613890414,0.35517510742862846,0.35517510742862846)
minHPD=c(0.010590535630439733, 0.02376890851831194,0.0263088165560681,0.024799177677094823,0.024448051818814626,0.02427203837664356,0.018206615248263933,0.025973880205459963,0.02673868766488428,0.026972354678546716,0.02376890851831194,0.026451631201259113,0.027643642694262047,0.02427203837664356,0.026972354678546716,0.03169683640386076,0.026552091208100096,0.02676405123686422,0.030116411884856736,0.0263895142715963,0.029615256531237102,0.027474338326071362,0.027803583211617237,0.037530931561409464,0.03614085179966315,0.0444409580897138,0.05633634877339305,0.05637820745597912,0.037175574281872396,0.03848679132029371,0.05405057832307536,0.05633634877339305,0.062222777333610126,0.06814115988532586,0.07350690766300226,0.079720447841554,0.08719095134122944,0.08829201653235219,0.0957024639594135,0.10258902404727681,0.15585833566418533,0.18466232100918142,0.19894374917584506,0.2103524130626978,0.2094232596709722,0.21020108347634242,0.2203945624432793,0.2203945624432793,0.220470573412142,0.22233913553884682,0.220470573412142,0.2203945624432793,0.220470573412142,0.220470573412142,0.2223528101231099,0.2262839608813123,0.23008537111670474,0.23388270472392866,0.2367246828384086,0.23748914666603893,0.23647792593009506,0.24164145428088574,0.2412333610048148,0.24243918506757262,0.24463001891217503,0.2427707661433209,0.24138273831231813,0.24243918506757262,0.2427612549846497,0.24373715467033605,0.24366423335533924,0.243857173107403,0.24133207527213477,0.24146659927118938,0.24095350944957966,0.24122269079049585,0.2412892907647194,0.2412892907647194,0.24122269079049585,0.24092240256484082,0.2415070834764267,0.24075459102287358,0.24047169256145343,0.23647792593009506,0.2394290611222852,0.23922310692920343,0.239099495410478,0.2384811247870934,0.23828984294396088,0.2367246828384086,0.23575511849790598,0.23597840261501268,0.23578471059724124,0.23573082766136297,0.2357353315161247,0.23576061937615103,0.23428069836937498,0.22956345434554373,0.22956345434554373)
maxHPD=c(0.9310029316843148, 0.9184519592669262,0.9126243625702242,0.9006798866283433,0.8892135896940249,0.8760058955962806,0.8585950312462493,0.8528045969413308,0.841783431345072,0.8279763635788464,0.8142749572610457,0.8033062829855196,0.7916888232791949,0.7756971072802759,0.7665206912464144,0.7586314625028341,0.7403950362651651,0.7282146527930234,0.7191107785595983,0.7028453947396323,0.6943187187926018,0.6796131304958518,0.6691013431028894,0.6672529152961466,0.655472137337997,0.6534041179755303,0.6549723176486283,0.6452378059900095,0.6149586664699095,0.605187839331928,0.6111959443540269,0.6042769505711145,0.6028050528115322,0.6027812769880735,0.6019190882160761,0.602692269006692,0.6043455747872138,0.6019190882160761,0.605187839331928,0.6067127948742462,0.6533716584941186,0.6694150007268376,0.6661989063983673,0.6653039240396597,0.6529296124905033,0.6425184965581723,0.6459628463133293,0.6401259034799808,0.6368788859709013,0.636888817949265,0.6362215558075928,0.6383248159827636,0.6298432672372141,0.6112911568163125,0.5768134031075923,0.5591013656780768,0.531856084120472,0.5119270208790915,0.504776260031974,0.5008373835593212,0.4959592215388938,0.4959210369052516,0.4909919433384015,0.4889769688007292,0.48871560826148597,0.4851599405424276,0.4825069508690112,0.48277508606344954,0.48250342106347427,0.48295862202036494,0.4825366834503784,0.48251609355338015,0.4797935929204668,0.47969726795970036,0.4790367203748012,0.47924730556441897,0.47924730556441897,0.4791975967182287,0.4793171536962327,0.4790367203748012,0.47969726795970036,0.47902122033018885,0.47903542319326003,0.4752656795115841,0.4783820322122675,0.47846014475012755,0.4786929457404123,0.47854168819186654,0.47902122033018885,0.4784123502693153,0.47849468509385124,0.47969726795970036,0.4806322209346298,0.48251766904378574,0.4852565385987239,0.48880026966040874,0.49318414193721166,0.4969052560256549,0.4969052560256549)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.0241032248527464), xlim = c(-144.0,-96.996575), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (combined_100_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-97.23396603535355, -97.70874810606063,-98.18353017676768,-98.65831224747475,-99.13309431818183,-99.60787638888891,-100.08265845959596,-100.55744053030304,-101.03222260101012,-101.50700467171717,-101.98178674242425,-102.45656881313133,-102.9313508838384,-103.40613295454546,-103.88091502525253,-104.35569709595961,-104.83047916666666,-105.30526123737374,-105.78004330808082,-106.2548253787879,-106.72960744949495,-107.20438952020203,-107.6791715909091,-108.15395366161616,-108.62873573232324,-109.10351780303031,-109.5782998737374,-110.05308194444444,-110.52786401515152,-111.0026460858586,-111.47742815656565,-111.95221022727273,-112.42699229797981,-112.90177436868689,-113.37655643939394,-113.85133851010102,-114.3261205808081,-114.80090265151514,-115.27568472222222,-115.7504667929293,-116.22524886363638,-116.70003093434343,-117.17481300505051,-117.64959507575759,-118.12437714646464,-118.59915921717172,-119.0739412878788,-119.54872335858587,-120.02350542929292,-120.4982875,-120.97306957070708,-121.44785164141413,-121.92263371212121,-122.39741578282829,-122.87219785353537,-123.34697992424242,-123.8217619949495,-124.29654406565658,-124.77132613636363,-125.2461082070707,-125.72089027777778,-126.19567234848486,-126.67045441919191,-127.14523648989899,-127.62001856060607,-128.09480063131312,-128.5695827020202,-129.04436477272728,-129.51914684343433,-129.9939289141414,-130.46871098484849,-130.94349305555556,-131.4182751262626,-131.8930571969697,-132.36783926767677,-132.84262133838382,-133.3174034090909,-133.79218547979798,-134.26696755050506,-134.7417496212121,-135.2165316919192,-135.69131376262627,-136.16609583333332,-136.6408779040404,-137.11565997474747,-137.59044204545455,-138.0652241161616,-138.54000618686868,-139.01478825757576,-139.4895703282828,-139.9643523989899,-140.43913446969697,-140.91391654040405,-141.38869861111112,-141.86348068181817,-142.33826275252525,-142.8130448232323,-143.28782689393938,-143.76260896464646)
counts=c(0.01467, 0.0044,0.00498,0.00491,0.00481,0.00458,0.0049,0.00445,0.00495,0.00443,0.00512,0.00472,0.00455,0.00466,0.00465,0.00451,0.00498,0.00466,0.00464,0.00476,0.00459,0.00458,0.00471,0.00447,0.00471,0.00494,0.00491,0.00464,0.00486,0.00447,0.00399,0.00446,0.00367,0.00411,0.00376,0.00408,0.00401,0.00402,0.0042,0.00437,0.00549,0.0056,0.00544,0.00593,0.00552,0.00532,0.00564,0.00558,0.00559,0.00511,0.00483,0.00378,0.00497,0.00906,0.00711,0.01163,0.014,0.00806,0.00527,0.00429,0.00592,0.00643,0.00544,0.00461,0.00412,0.00299,0.00255,0.00233,0.00219,0.00223,0.00218,0.00223,0.00204,0.00184,0.00177,0.00209,0.00176,0.00176,0.00158,0.00196,0.00135,0.00169,0.00163,0.00147,0.00184,0.00168,0.00189,0.00221,0.00235,0.00255,0.00222,0.00238,0.00268,0.00386,0.0041,0.00539,0.00744,0.0,0.0)
plot(mids,counts,type = 'h', xlim = c(-144.0,-96.996575), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.030943866259075848
bf6 = 0.1909038684940839
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-97.23432351000001, -97.70982053,-98.18531755000001,-98.66081457,-99.13631159,-99.61180861,-100.08730563,-100.56280265000001,-101.03829967,-101.51379669,-101.98929371,-102.46479073,-102.94028775,-103.41578477,-103.89128179000001,-104.36677881,-104.84227583,-105.31777285,-105.79326987,-106.26876689000001,-106.74426391,-107.21976093,-107.69525795,-108.17075497,-108.64625199000001,-109.12174901,-109.59724603000001,-110.07274305,-110.54824007,-111.02373709,-111.49923411,-111.97473113,-112.45022815,-112.92572517,-113.40122219,-113.87671921,-114.35221623,-114.82771325,-115.30321027000001,-115.77870729,-116.25420431,-116.72970133,-117.20519835,-117.68069537000001,-118.15619239,-118.63168940999999,-119.10718643,-119.58268345,-120.05818047,-120.53367749,-121.00917451,-121.48467153,-121.96016855,-122.43566557,-122.91116259,-123.38665961,-123.86215663,-124.33765365000001,-124.81315067,-125.28864769,-125.76414471,-126.23964173,-126.71513875000001,-127.19063577,-127.66613278999999,-128.14162980999998,-128.61712683000002,-129.09262385,-129.56812086999997,-130.04361789,-130.51911490999998,-130.99461193000002,-131.47010895,-131.94560596999997,-132.42110299,-132.89660001,-133.37209703000002,-133.84759405,-134.32309106999998,-134.79858809,-135.27408511,-135.74958213000002,-136.22507915,-136.70057616999998,-137.17607319,-137.65157021,-138.12706723000002,-138.60256425,-139.07806126999998,-139.55355829,-140.02905531,-140.50455232999997,-140.98004935,-141.45554636999998,-141.93104339,-142.40654041,-142.88203742999997,-143.35753445,-143.83303146999998)
rate=c(0.4046552493735962, 0.4041161615919934,0.4047517253279692,0.40529694910583436,0.40593072361895566,0.40654447397371724,0.4070975680433204,0.40761742865500605,0.4082459837185909,0.408857421229502,0.4095060266480889,0.41013595636403877,0.41070050099776717,0.41126867164724806,0.4117516309842424,0.41230627350079246,0.412795067639145,0.4134350619685174,0.41402574823681915,0.41450162152562,0.41499704711283847,0.41550980046242547,0.41595507166997236,0.41636668442569097,0.4169056848609787,0.4173998275986645,0.417782603931077,0.41826956508822327,0.41877330799469936,0.4192830126741527,0.41952415461195913,0.4197627299654092,0.41998188641078826,0.42028048337356294,0.420543923627548,0.4208144561410857,0.4210292372166746,0.421385398538657,0.42178275572808444,0.42224918821415824,0.4226536969688696,0.4231006686997053,0.4234034006399201,0.4235574431664508,0.4237558650351783,0.4240694356878858,0.4244152182107251,0.42481477238042276,0.425300802653359,0.4257110136561407,0.42606363465818564,0.42598506406624165,0.42568297934406196,0.4250985755593263,0.4244360581240132,0.42282280737908207,0.4191537217278575,0.4145201088045466,0.40854770958753495,0.4020466026123617,0.3964763795036351,0.3918118684676701,0.3881176118934844,0.38554066795762804,0.383789465102628,0.38249481443837235,0.38138549093692864,0.3801862403040469,0.3792031133857031,0.37850571486283735,0.37800524128523005,0.37758769637832046,0.3772687328601123,0.3769742746995323,0.3766474961759019,0.37643159642139956,0.37622257261335684,0.3761061269265672,0.3759667463718339,0.3758702323838021,0.3757239707144771,0.375563716904854,0.37541552220292584,0.37504144889271473,0.37460640967748393,0.3740293923181649,0.37346731809496725,0.3728200814593505,0.37238384829346105,0.37206116172649084,0.3717397342508532,0.37147403204991875,0.3711224513989193,0.3708831918670029,0.37066780307093083,0.3705033628911093,0.37043436054801715,0.3703462153570093,0.3703462153570093)
minHPD=c(4.2294078893131095e-05, 4.2294078893131095e-05,4.2294078893131095e-05,4.2294078893131095e-05,4.2294078893131095e-05,4.2294078893131095e-05,5.226680994974507e-05,7.233365763719999e-05,4.2294078893131095e-05,4.2294078893131095e-05,5.226680994974507e-05,5.226680994974507e-05,5.226680994974507e-05,5.226680994974507e-05,7.233365763719999e-05,0.0021290393961712166,0.0005858032393461998,7.233365763719999e-05,0.008132447046375712,0.008785592355508558,0.011825997828880119,0.026538678434884347,0.037821495565276544,0.059293930749079536,0.07445107221775313,0.07604306319651775,0.09963212042361891,0.11666109283567604,0.12473516812585815,0.1383365026065163,0.15303227844153497,0.16799204708861085,0.22706201590369815,0.23280257123711953,0.23045037485523545,0.23860850273296796,0.2388078531487204,0.24367574184511145,0.2503571837108585,0.2500954613515258,0.2566550438574319,0.26046462557211597,0.25996138992257917,0.25967343251770925,0.26046462557211597,0.2608074379396086,0.2640415325656794,0.26309693032379544,0.2617955202903394,0.26046462557211597,0.26263759033722345,0.2607650159491636,0.2602867028957292,0.26309693032379544,0.26084774911908354,0.2602867028957292,0.25804553617300763,0.25497102978796615,0.24282823147978758,0.23913977412713772,0.23141656304581476,0.22920604929628008,0.23132537212132254,0.23330599281859576,0.23146138041033631,0.23715425973718457,0.23649145327409699,0.23740194116759153,0.23702193201277655,0.23983078604733077,0.24265163318011707,0.24265163318011707,0.2377761891645085,0.23839091458482062,0.23907341864246448,0.2387326552510764,0.23922184129724938,0.2393333371399782,0.2404447064233976,0.24059485307186473,0.24053994734630477,0.24059485307186473,0.2370293480005157,0.2371534963928585,0.2370157565912981,0.2371744249669508,0.23713866552485285,0.23163081674402217,0.23146138041033631,0.23141656304581476,0.23131879337431455,0.23121394675598766,0.22929804269022125,0.22793779120828184,0.22709394883158868,0.22372136293794118,0.22656485209781194,0.22377895606626536,0.22377895606626536)
maxHPD=c(0.8871729906128059, 0.8613976094823116,0.8629867022678593,0.8655325551114129,0.8670082635206532,0.8682167629398584,0.8687285734410501,0.8697347804921276,0.8718185452803431,0.8730143615542232,0.8745175971847263,0.8753744731790429,0.8755296204349988,0.8770077700837976,0.877923407707904,0.8801759960213968,0.8793727906111511,0.8797788446772976,0.8876664998913872,0.8878098620955853,0.8897278435561871,0.9027772218647458,0.9110381378076964,0.9285598756899495,0.9375688964371437,0.9317964443226383,0.9464280973636154,0.9525024029925129,0.9485097319873999,0.9513175277774931,0.9543799801499777,0.9558605296800147,1.0000410714691617,0.989515148718804,0.9735083220569217,0.9689348861251437,0.9558062914835388,0.9507327807830592,0.9470703179814409,0.9376021463987021,0.9366055633797883,0.9326365076585418,0.9285598756899495,0.9260147746424866,0.9250169615756609,0.9248447137213074,0.9284312042228466,0.9285598756899495,0.9326456593012379,0.9376021463987021,0.9470703179814409,0.9504765608095265,0.9515500681844601,0.9549636999128975,0.9505429424929396,0.9409212419180777,0.911609023006338,0.8739794338448538,0.8160409744024805,0.7486586409197505,0.6866312260303911,0.6257068102631074,0.5855060142656715,0.5611586355490212,0.5456730412979293,0.5419010694863755,0.5352018536463965,0.5290483387923025,0.5234945499306661,0.5232417940332014,0.5239377898051921,0.5220255334884065,0.5157800856904758,0.5157133957077783,0.5156262290710131,0.5149342979900751,0.5149838071311602,0.5149186555723836,0.5157800856904758,0.5157779683450103,0.5157779683450103,0.5157679474595762,0.5122517961791753,0.5127884549690552,0.5132878094651183,0.5144151380053068,0.5156262290710131,0.5114322745237708,0.5127812319655469,0.513727569379729,0.5149612112906344,0.5159056772467757,0.5157908412774559,0.5163235668096978,0.5172028599905579,0.5157908412774559,0.5206456203912128,0.520425768459527,0.520425768459527)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.1000451786160779), xlim = c(-144.0,-96.996575), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-97.23396603535355, -97.70874810606063,-98.18353017676768,-98.65831224747475,-99.13309431818183,-99.60787638888891,-100.08265845959596,-100.55744053030304,-101.03222260101012,-101.50700467171717,-101.98178674242425,-102.45656881313133,-102.9313508838384,-103.40613295454546,-103.88091502525253,-104.35569709595961,-104.83047916666666,-105.30526123737374,-105.78004330808082,-106.2548253787879,-106.72960744949495,-107.20438952020203,-107.6791715909091,-108.15395366161616,-108.62873573232324,-109.10351780303031,-109.5782998737374,-110.05308194444444,-110.52786401515152,-111.0026460858586,-111.47742815656565,-111.95221022727273,-112.42699229797981,-112.90177436868689,-113.37655643939394,-113.85133851010102,-114.3261205808081,-114.80090265151514,-115.27568472222222,-115.7504667929293,-116.22524886363638,-116.70003093434343,-117.17481300505051,-117.64959507575759,-118.12437714646464,-118.59915921717172,-119.0739412878788,-119.54872335858587,-120.02350542929292,-120.4982875,-120.97306957070708,-121.44785164141413,-121.92263371212121,-122.39741578282829,-122.87219785353537,-123.34697992424242,-123.8217619949495,-124.29654406565658,-124.77132613636363,-125.2461082070707,-125.72089027777778,-126.19567234848486,-126.67045441919191,-127.14523648989899,-127.62001856060607,-128.09480063131312,-128.5695827020202,-129.04436477272728,-129.51914684343433,-129.9939289141414,-130.46871098484849,-130.94349305555556,-131.4182751262626,-131.8930571969697,-132.36783926767677,-132.84262133838382,-133.3174034090909,-133.79218547979798,-134.26696755050506,-134.7417496212121,-135.2165316919192,-135.69131376262627,-136.16609583333332,-136.6408779040404,-137.11565997474747,-137.59044204545455,-138.0652241161616,-138.54000618686868,-139.01478825757576,-139.4895703282828,-139.9643523989899,-140.43913446969697,-140.91391654040405,-141.38869861111112,-141.86348068181817,-142.33826275252525,-142.8130448232323,-143.28782689393938,-143.76260896464646)
counts=c(0.0153, 0.00595,0.00574,0.00639,0.00593,0.00642,0.00604,0.00629,0.00668,0.00647,0.00631,0.00597,0.00613,0.00606,0.00622,0.0061,0.00629,0.00621,0.00618,0.00649,0.00611,0.00591,0.0062,0.0064,0.00645,0.00607,0.00596,0.00618,0.00648,0.00525,0.00533,0.00514,0.00525,0.00498,0.00488,0.00472,0.00493,0.00475,0.00481,0.00538,0.00537,0.00428,0.00402,0.00397,0.00422,0.00446,0.00492,0.00542,0.0049,0.00516,0.00474,0.00375,0.00472,0.00559,0.00818,0.01837,0.02326,0.03062,0.03584,0.03201,0.02867,0.02467,0.01744,0.01181,0.00961,0.00798,0.00863,0.00749,0.00569,0.00455,0.00385,0.00314,0.00281,0.0026,0.00266,0.00245,0.00207,0.00209,0.00207,0.002,0.00198,0.00209,0.00292,0.00381,0.00474,0.00436,0.00446,0.00384,0.00348,0.00285,0.00304,0.00313,0.00302,0.00297,0.00272,0.00284,0.00338,0.0,0.0)
plot(mids,counts,type = 'h', xlim = c(-144.0,-96.996575), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-97.23432351000001, -97.70982053,-98.18531755000001,-98.66081457,-99.13631159,-99.61180861,-100.08730563,-100.56280265000001,-101.03829967,-101.51379669,-101.98929371,-102.46479073,-102.94028775,-103.41578477,-103.89128179000001,-104.36677881,-104.84227583,-105.31777285,-105.79326987,-106.26876689000001,-106.74426391,-107.21976093,-107.69525795,-108.17075497,-108.64625199000001,-109.12174901,-109.59724603000001,-110.07274305,-110.54824007,-111.02373709,-111.49923411,-111.97473113,-112.45022815,-112.92572517,-113.40122219,-113.87671921,-114.35221623,-114.82771325,-115.30321027000001,-115.77870729,-116.25420431,-116.72970133,-117.20519835,-117.68069537000001,-118.15619239,-118.63168940999999,-119.10718643,-119.58268345,-120.05818047,-120.53367749,-121.00917451,-121.48467153,-121.96016855,-122.43566557,-122.91116259,-123.38665961,-123.86215663,-124.33765365000001,-124.81315067,-125.28864769,-125.76414471,-126.23964173,-126.71513875000001,-127.19063577,-127.66613278999999,-128.14162980999998,-128.61712683000002,-129.09262385,-129.56812086999997,-130.04361789,-130.51911490999998,-130.99461193000002,-131.47010895,-131.94560596999997,-132.42110299,-132.89660001,-133.37209703000002,-133.84759405,-134.32309106999998,-134.79858809,-135.27408511,-135.74958213000002,-136.22507915,-136.70057616999998,-137.17607319,-137.65157021,-138.12706723000002,-138.60256425,-139.07806126999998,-139.55355829,-140.02905531,-140.50455232999997,-140.98004935,-141.45554636999998,-141.93104339,-142.40654041,-142.88203742999997,-143.35753445,-143.83303146999998)
net_rate=c(-0.016045774139907917, -0.009239655969765486,-0.011888173981437157,-0.01475155691199918,-0.01820096322136282,-0.021370683653067567,-0.02424765310876266,-0.027518004500631563,-0.031085157383897145,-0.03489578043171295,-0.03808615722656841,-0.04182734250000697,-0.04488401333618197,-0.04831833328667568,-0.05138280149593805,-0.054613558143525844,-0.057729716939694274,-0.061158506008366004,-0.0643413087875527,-0.06711235567364769,-0.0699973201251942,-0.0730706929280284,-0.07595069608407912,-0.07874781250582041,-0.08183543812498176,-0.0850218300546445,-0.08774112966337001,-0.09011476269363898,-0.09292974104985946,-0.09566313164700965,-0.09752098283319098,-0.09909828693812747,-0.10036883721899181,-0.10157133647483113,-0.10243056721463503,-0.10318039781045044,-0.10372938177096894,-0.10429145010537606,-0.1050891964586109,-0.10591434016442747,-0.10643177871189365,-0.10654848801898482,-0.10604740310701517,-0.10533273884610209,-0.10410177237624196,-0.1034363689418909,-0.10307771338673181,-0.10261235026282642,-0.1022856161662217,-0.10175388309993524,-0.10134252145014973,-0.09979009832428877,-0.10112892009999036,-0.10319825909323692,-0.10795400915391219,-0.1074872732219696,-0.10441493384040298,-0.09774375645325165,-0.08423501302905727,-0.0670540708510746,-0.054218093584358376,-0.044289733311049184,-0.03717792101623082,-0.03282192850039454,-0.030607188772633877,-0.02881577615414838,-0.027280427257185453,-0.025379789074613867,-0.023894763275522042,-0.02298871011855646,-0.022355591626760915,-0.02200203693547693,-0.02178175190855236,-0.021611382169466373,-0.021435353579867623,-0.021260093594865317,-0.021205084960958548,-0.02113115846415238,-0.02106639633984238,-0.02103888094319016,-0.021032440667417992,-0.020979570865809084,-0.020807233918446945,-0.02032832620534357,-0.0196037455083665,-0.01854128301862517,-0.017558442427302572,-0.01656055825615151,-0.015729274830562745,-0.015007786817944693,-0.014255894575366801,-0.01371062789239275,-0.012876852696411287,-0.011830183951790463,-0.010567766663755411,-0.009055128496995034,-0.006688647664253164,-0.001987892573972258,-0.001987892573972258)
net_minHPD=c(-0.765128090518732, -0.7648044311193902,-0.7638766187398688,-0.7634904589634981,-0.7440801099144473,-0.7338013309425611,-0.7636820641560192,-0.7638766187398688,-0.7440342436409356,-0.7638766187398688,-0.7638766187398688,-0.7438073461339922,-0.7334919622127795,-0.7334919622127795,-0.7331242839521014,-0.7317237092180084,-0.7236809419100878,-0.7238334759853922,-0.6939395055472679,-0.6878437794727101,-0.6902419987260691,-0.6880516422783813,-0.6704958964580731,-0.6672745579069979,-0.6557858449959585,-0.6396436721167462,-0.6521244537680768,-0.6557858449959585,-0.6395230221798869,-0.6401268745155406,-0.6401268745155406,-0.627860307345647,-0.6087078666045225,-0.6062303430786873,-0.6062303430786873,-0.606421919046331,-0.6062190520139208,-0.6108462129230471,-0.6183314496542709,-0.6090928602695717,-0.6064752180563717,-0.6070828710813692,-0.6086999689305114,-0.6090442971861121,-0.6202434725569244,-0.6336977368482182,-0.6606721977497749,-0.6647908828362303,-0.6802033731215889,-0.7130686734410927,-0.7445610306908411,-0.744853451873894,-0.744853451873894,-0.7429361218191279,-0.7332950694576009,-0.6880377275737695,-0.6436364401587249,-0.5750797405374029,-0.518151522920626,-0.4455208490512056,-0.37835641837409373,-0.3200908059628745,-0.262686158610919,-0.23357000542851625,-0.21857681457252148,-0.20716302591341992,-0.19806681388647196,-0.1952488017216818,-0.19023666579670906,-0.19023666579670906,-0.18697074055805568,-0.18509006991861926,-0.18524408685115684,-0.1842074456143616,-0.18226261885827394,-0.18025413330357393,-0.17971334437693715,-0.17971334437693715,-0.1796939120153736,-0.18025413330357393,-0.17882755696205538,-0.17971334437693715,-0.17970169905926414,-0.17882755696205538,-0.17971334437693715,-0.1788205975190148,-0.17852318709953202,-0.17894288140799142,-0.1768319821298283,-0.17850194376327838,-0.17386560595423656,-0.1737693133967688,-0.17659832318831215,-0.17735747435070065,-0.18265789903704382,-0.18283111363419763,-0.19020696096041803,-0.19176577178509174,-0.19176577178509174)
net_maxHPD=c(0.7248048536427817, 0.6556643022646578,0.6492890351673875,0.6404336336815091,0.6499751841012469,0.6475271597527821,0.5990338534942325,0.587003846232909,0.5907659953644971,0.5496695151201338,0.5364299785557136,0.5372230682995549,0.5296421100656445,0.5116832617581173,0.49428821345017676,0.4759032291856585,0.46452144514267624,0.44896461939365523,0.45840082334721427,0.44595642717100975,0.4251875413005192,0.4124961034803584,0.41322703677582556,0.3999224597226464,0.3926126501760305,0.39364230450457605,0.3660255666168133,0.34556309294390614,0.34364189385579713,0.3264869653207826,0.3069998834245648,0.303658080235625,0.30639589667725425,0.295738179956767,0.28632642704865824,0.2785243361484788,0.27085029227543594,0.2600259607852819,0.24540541272648048,0.2478785209235208,0.24554046154609976,0.24523369605276413,0.24540541272648048,0.25049773569734357,0.24548430719618586,0.24115813588750462,0.22854490506965625,0.2404727062119132,0.25253140789193773,0.253347640632994,0.257206304577658,0.28205947739810683,0.28021926312033674,0.26735125832792883,0.23477551170608835,0.24267531408485343,0.2046532528538349,0.1888662592072265,0.17792270757934203,0.17713036045942043,0.18270951310768563,0.17269133570440415,0.17222649267646895,0.16268802043931851,0.15719677842891466,0.15466078100784864,0.15443245333833533,0.14809375097283434,0.14702412064164921,0.14285341038879773,0.14328235066941614,0.1425393767249184,0.14052659508916177,0.14052659508916177,0.14164567797094008,0.1428975114458863,0.14232275454757068,0.14177441767587873,0.14148353889887239,0.1405617918028252,0.14170728953827572,0.1404657328989341,0.14064046600289992,0.14165394049876368,0.14065599124272732,0.14213849196881478,0.14331139233883539,0.1441510381359401,0.14777034270885953,0.14777034270885953,0.15464552600936687,0.15627823650324973,0.15623546144570727,0.15954640569463685,0.15954640569463685,0.16632317601011756,0.168379834501169,0.1826422272151597,0.1826422272151597)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-0.8416408995706053, 0.7972853390070599), xlim = c(-144.0,-96.996575), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-97.23432351000001, -97.70982053,-98.18531755000001,-98.66081457,-99.13631159,-99.61180861,-100.08730563,-100.56280265000001,-101.03829967,-101.51379669,-101.98929371,-102.46479073,-102.94028775,-103.41578477,-103.89128179000001,-104.36677881,-104.84227583,-105.31777285,-105.79326987,-106.26876689000001,-106.74426391,-107.21976093,-107.69525795,-108.17075497,-108.64625199000001,-109.12174901,-109.59724603000001,-110.07274305,-110.54824007,-111.02373709,-111.49923411,-111.97473113,-112.45022815,-112.92572517,-113.40122219,-113.87671921,-114.35221623,-114.82771325,-115.30321027000001,-115.77870729,-116.25420431,-116.72970133,-117.20519835,-117.68069537000001,-118.15619239,-118.63168940999999,-119.10718643,-119.58268345,-120.05818047,-120.53367749,-121.00917451,-121.48467153,-121.96016855,-122.43566557,-122.91116259,-123.38665961,-123.86215663,-124.33765365000001,-124.81315067,-125.28864769,-125.76414471,-126.23964173,-126.71513875000001,-127.19063577,-127.66613278999999,-128.14162980999998,-128.61712683000002,-129.09262385,-129.56812086999997,-130.04361789,-130.51911490999998,-130.99461193000002,-131.47010895,-131.94560596999997,-132.42110299,-132.89660001,-133.37209703000002,-133.84759405,-134.32309106999998,-134.79858809,-135.27408511,-135.74958213000002,-136.22507915,-136.70057616999998,-137.17607319,-137.65157021,-138.12706723000002,-138.60256425,-139.07806126999998,-139.55355829,-140.02905531,-140.50455232999997,-140.98004935,-141.45554636999998,-141.93104339,-142.40654041,-142.88203742999997,-143.35753445,-143.83303146999998)
rate=c(2.2168784466964957, 2.2678655278894047,2.2597228234274698,2.251137304036297,2.241737087946369,2.2335217694845073,2.2270221647661477,2.2193146940112816,2.21072979213636,2.2027005162509696,2.1948618219294196,2.187320438100815,2.1812411288978724,2.174953034139987,2.1687041753180623,2.1633595976490874,2.1575582545456506,2.1509297636793394,2.1459716389611816,2.141574212774544,2.1365510263977825,2.131175834335386,2.126975677481907,2.1225456386893535,2.118220985094472,2.1137321319626667,2.1106148339381354,2.107861197158878,2.104042618534047,2.1003747739827743,2.0999761227543114,2.098904163030155,2.0979688233362803,2.0968857343614102,2.095600965582637,2.0943464658927424,2.093097604347608,2.090571104495246,2.086819461548655,2.082425447551243,2.07732011856098,2.071335625441765,2.0675319537846413,2.0645734666126363,2.061202501979121,2.056445412438203,2.049163522061412,2.040202802983041,2.0271768375868597,2.0151535914999523,2.0036199716732295,1.9987986736237688,1.998624918732372,2.0007463592076222,2.0065585367452785,2.0232520238260063,2.067779104997227,2.1279730826395573,2.2058660853430077,2.299774177292139,2.3761409257838726,2.4433134947183315,2.4974379438485994,2.5334838650653855,2.555033192710549,2.5721888015872034,2.5856811779535605,2.6008152099339137,2.6129231779910205,2.621236161398187,2.627519471704145,2.6320336222728615,2.6354112343216003,2.6380913167021784,2.6403944575573504,2.6426597904550277,2.6446331195518447,2.6458714162805554,2.6471826251248434,2.648064579116273,2.648855554339109,2.649478827519338,2.650540476753179,2.6540803084496893,2.6589215121582392,2.665826620724733,2.6723762143231395,2.678958545143995,2.6837655044999846,2.6873110862141183,2.6907217875743585,2.693566652354799,2.6972166289186186,2.7002629499665405,2.7024776232206094,2.7041773525855954,2.7047782873176525,2.7054667216443993,2.7054667216443993)
minHPD=c(2.2168784466964957, 2.2678655278894047,2.2597228234274698,2.251137304036297,2.241737087946369,2.2335217694845073,2.2270221647661477,2.2193146940112816,2.21072979213636,2.2027005162509696,2.1948618219294196,2.187320438100815,2.1812411288978724,2.174953034139987,2.1687041753180623,2.1633595976490874,2.1575582545456506,2.1509297636793394,2.1459716389611816,2.141574212774544,2.1365510263977825,2.131175834335386,2.126975677481907,2.1225456386893535,2.118220985094472,2.1137321319626667,2.1106148339381354,2.107861197158878,2.104042618534047,2.1003747739827743,2.0999761227543114,2.098904163030155,2.0979688233362803,2.0968857343614102,2.095600965582637,2.0943464658927424,2.093097604347608,2.090571104495246,2.086819461548655,2.082425447551243,2.07732011856098,2.071335625441765,2.0675319537846413,2.0645734666126363,2.061202501979121,2.056445412438203,2.049163522061412,2.040202802983041,2.0271768375868597,2.0151535914999523,2.0036199716732295,1.9987986736237688,1.998624918732372,2.0007463592076222,2.0065585367452785,2.0232520238260063,2.067779104997227,2.1279730826395573,2.2058660853430077,2.299774177292139,2.3761409257838726,2.4433134947183315,2.4974379438485994,2.5334838650653855,2.555033192710549,2.5721888015872034,2.5856811779535605,2.6008152099339137,2.6129231779910205,2.621236161398187,2.627519471704145,2.6320336222728615,2.6354112343216003,2.6380913167021784,2.6403944575573504,2.6426597904550277,2.6446331195518447,2.6458714162805554,2.6471826251248434,2.648064579116273,2.648855554339109,2.649478827519338,2.650540476753179,2.6540803084496893,2.6589215121582392,2.665826620724733,2.6723762143231395,2.678958545143995,2.6837655044999846,2.6873110862141183,2.6907217875743585,2.693566652354799,2.6972166289186186,2.7002629499665405,2.7024776232206094,2.7041773525855954,2.7047782873176525,2.7054667216443993,2.7054667216443993)
maxHPD=c(2.2168784466964957, 2.2678655278894047,2.2597228234274698,2.251137304036297,2.241737087946369,2.2335217694845073,2.2270221647661477,2.2193146940112816,2.21072979213636,2.2027005162509696,2.1948618219294196,2.187320438100815,2.1812411288978724,2.174953034139987,2.1687041753180623,2.1633595976490874,2.1575582545456506,2.1509297636793394,2.1459716389611816,2.141574212774544,2.1365510263977825,2.131175834335386,2.126975677481907,2.1225456386893535,2.118220985094472,2.1137321319626667,2.1106148339381354,2.107861197158878,2.104042618534047,2.1003747739827743,2.0999761227543114,2.098904163030155,2.0979688233362803,2.0968857343614102,2.095600965582637,2.0943464658927424,2.093097604347608,2.090571104495246,2.086819461548655,2.082425447551243,2.07732011856098,2.071335625441765,2.0675319537846413,2.0645734666126363,2.061202501979121,2.056445412438203,2.049163522061412,2.040202802983041,2.0271768375868597,2.0151535914999523,2.0036199716732295,1.9987986736237688,1.998624918732372,2.0007463592076222,2.0065585367452785,2.0232520238260063,2.067779104997227,2.1279730826395573,2.2058660853430077,2.299774177292139,2.3761409257838726,2.4433134947183315,2.4974379438485994,2.5334838650653855,2.555033192710549,2.5721888015872034,2.5856811779535605,2.6008152099339137,2.6129231779910205,2.621236161398187,2.627519471704145,2.6320336222728615,2.6354112343216003,2.6380913167021784,2.6403944575573504,2.6426597904550277,2.6446331195518447,2.6458714162805554,2.6471826251248434,2.648064579116273,2.648855554339109,2.649478827519338,2.650540476753179,2.6540803084496893,2.6589215121582392,2.665826620724733,2.6723762143231395,2.678958545143995,2.6837655044999846,2.6873110862141183,2.6907217875743585,2.693566652354799,2.6972166289186186,2.7002629499665405,2.7024776232206094,2.7041773525855954,2.7047782873176525,2.7054667216443993,2.7054667216443993)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 2.9760133938088393), xlim = c(-144.0,-96.996575), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()